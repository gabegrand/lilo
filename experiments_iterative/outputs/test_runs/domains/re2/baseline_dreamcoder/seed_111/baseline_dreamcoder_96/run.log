2023-06-09 17:35:31,728 INFO:============LOGGING METADATA============
2023-06-09 17:35:31,728 INFO:	iteration: 0
2023-06-09 17:35:31,728 INFO:	dsl_description_prefix: This is a domain-specific language for regular expressions that specify string transformations.
2023-06-09 17:35:31,729 INFO:	encoder: re2
2023-06-09 17:35:31,729 INFO:	recognition_train_steps: 100
2023-06-09 17:35:31,730 INFO:	task_language_loader: re2_synthetic
2023-06-09 17:35:31,730 INFO:	export_with_timestamp: False
2023-06-09 17:35:31,730 INFO:	resume_checkpoint_directory: None
2023-06-09 17:35:31,731 INFO:	enumeration_timeout: 10
2023-06-09 17:35:31,731 INFO:	random_seed: 111
2023-06-09 17:35:31,731 INFO:	global_batch_size: 96
2023-06-09 17:35:31,732 INFO:	log_directory: experiments_iterative/logs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 17:35:31,732 INFO:	export_directory: experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 17:35:31,732 INFO:	ocaml_special_handler: re2
2023-06-09 17:35:31,733 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-09 17:35:31,733 INFO:	timestamp: 
2023-06-09 17:35:31,734 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-09 17:35:31,734 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-09 17:35:31,734 INFO:	experiment_name: test_runs
2023-06-09 17:35:31,735 INFO:	curr_iteration: 0
2023-06-09 17:35:31,735 INFO:	init_grammar_from_checkpoint: False
2023-06-09 17:35:31,735 INFO:	init_frontiers_every_iteration: False
2023-06-09 17:35:31,736 INFO:	random_generator: Generator(PCG64)
2023-06-09 17:35:31,736 INFO:	tasks_loader: re2
2023-06-09 17:35:31,736 INFO:	init_frontiers_from_checkpoint: False
2023-06-09 17:35:31,737 INFO:====================================
2023-06-09 17:35:31,737 INFO:============LOGGING FRONTIERS============
2023-06-09 17:35:31,738 INFO:	 total_solved_tasks_train @ iteration 0: 0 / 491
2023-06-09 17:35:31,739 INFO:	 total_solved_tasks_test @ iteration 0: 0 / 500
2023-06-09 17:35:31,739 INFO:====================================
2023-06-09 17:35:31,740 INFO:============LOGGING MODEL_FN============
2023-06-09 17:35:31,740 INFO:	iteration: 0
2023-06-09 17:35:31,740 INFO:	run_every_n_iterations: 1000
2023-06-09 17:35:31,741 INFO:	experiment_block_type: model_fn
2023-06-09 17:35:31,741 INFO:	task_split: train
2023-06-09 17:35:31,742 INFO:	params: {'enumeration_timeout': 10, 'compute_likelihoods': True}
2023-06-09 17:35:31,742 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 17:35:31,742 INFO:	task_batch_size: global_batch_size
2023-06-09 17:35:31,743 INFO:	model_type: grammar
2023-06-09 17:35:31,743 INFO:task_ids: 96 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_185_if_the_word_ends_with_consonant_replace_that_with_a_o
2023-06-09 17:35:31,744 INFO:====================================
2023-06-09 17:35:31,745 INFO:Beginning enumeration on a total of 96 tasks with a total of 4 CPUs.
2023-06-09 17:35:42,498 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/0/metrics.json
2023-06-09 17:35:42,498 INFO:====================================
2023-06-09 17:35:42,499 INFO:iteration: 0
2023-06-09 17:35:42,499 INFO:grammar : infer_programs_for_tasks
2023-06-09 17:35:42,499 INFO:Completed in 10.744s
2023-06-09 17:35:42,499 INFO:====================================
2023-06-09 17:35:42,500 INFO:============LOGGING FRONTIERS============
2023-06-09 17:35:42,502 INFO:	 total_solved_tasks_train @ iteration 0: 1 / 491
2023-06-09 17:35:42,503 INFO:	 total_solved_tasks_test @ iteration 0: 0 / 500
2023-06-09 17:35:42,503 INFO:====================================
2023-06-09 17:35:42,504 INFO:============LOGGING MODEL_FN============
2023-06-09 17:35:42,504 INFO:	iteration: 0
2023-06-09 17:35:42,504 INFO:	experiment_block_type: model_fn
2023-06-09 17:35:42,505 INFO:	task_split: train
2023-06-09 17:35:42,505 INFO:	params: {'recognition_train_steps': 100}
2023-06-09 17:35:42,505 INFO:	model_fn: optimize_model_for_frontiers
2023-06-09 17:35:42,506 INFO:	task_batch_size: all
2023-06-09 17:35:42,506 INFO:	model_type: amortized_synthesis
2023-06-09 17:35:42,506 INFO:task_ids: 491 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_432_if_the_word_ends_with_vowel_any_letter_replace_that_with_h_i
2023-06-09 17:35:42,507 INFO:====================================
2023-06-09 17:35:42,595 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-09 17:35:42,650 INFO:Attempted frontier likelihood normalization. Initial frontiers: 1. Now: 1
2023-06-09 17:35:42,987 INFO:Sampling new helmholtz frontiers during training.
2023-06-09 17:35:48,541 INFO:We now have 497 Helmholtz entries.
2023-06-09 17:35:56,087 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/0/metrics.json
2023-06-09 17:35:56,087 INFO:====================================
2023-06-09 17:35:56,087 INFO:iteration: 0
2023-06-09 17:35:56,087 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-09 17:35:56,087 INFO:Completed in 13.579s
2023-06-09 17:35:56,087 INFO:====================================
2023-06-09 17:35:56,087 INFO:============LOGGING MODEL_FN============
2023-06-09 17:35:56,088 INFO:	iteration: 0
2023-06-09 17:35:56,088 INFO:	experiment_block_type: model_fn
2023-06-09 17:35:56,088 INFO:	task_split: train
2023-06-09 17:35:56,088 INFO:	params: {'enumeration_timeout': 10}
2023-06-09 17:35:56,088 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 17:35:56,088 INFO:	task_batch_size: global_batch_size
2023-06-09 17:35:56,088 INFO:	model_type: amortized_synthesis
2023-06-09 17:35:56,088 INFO:task_ids: 96 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_185_if_the_word_ends_with_consonant_replace_that_with_a_o
2023-06-09 17:35:56,088 INFO:====================================
2023-06-09 17:36:02,957 INFO:Beginning enumeration on a total of 96 tasks with a total of 4 CPUs.
2023-06-09 17:40:12,076 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/0/metrics.json
2023-06-09 17:40:12,077 INFO:====================================
2023-06-09 17:40:12,077 INFO:iteration: 0
2023-06-09 17:40:12,078 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-09 17:40:12,078 INFO:Completed in 255.987s
2023-06-09 17:40:12,078 INFO:====================================
2023-06-09 17:40:12,078 INFO:============LOGGING FRONTIERS============
2023-06-09 17:40:12,080 INFO:	 total_solved_tasks_train @ iteration 0: 3 / 491
2023-06-09 17:40:12,082 INFO:	 total_solved_tasks_test @ iteration 0: 0 / 500
2023-06-09 17:40:12,082 INFO:====================================
2023-06-09 17:40:12,083 INFO:reset_task_frontiers for split: test
2023-06-09 17:40:12,083 INFO:============LOGGING MODEL_FN============
2023-06-09 17:40:12,083 INFO:	iteration: 0
2023-06-09 17:40:12,084 INFO:	run_every_n_iterations: 3
2023-06-09 17:40:12,084 INFO:	experiment_block_type: model_fn
2023-06-09 17:40:12,084 INFO:	task_split: test
2023-06-09 17:40:12,085 INFO:	params: {'enumeration_timeout': 10}
2023-06-09 17:40:12,085 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 17:40:12,085 INFO:	task_batch_size: all
2023-06-09 17:40:12,085 INFO:	model_type: amortized_synthesis
2023-06-09 17:40:12,086 INFO:task_ids: 500 tasks: re2_test_0_if_the_word_ends_with_s_replace_that_with_m -- re2_test_499_if_there_is_consonant_replace_that_with_q_f
2023-06-09 17:40:12,086 INFO:====================================
2023-06-09 17:40:27,951 INFO:Beginning enumeration on a total of 500 tasks with a total of 4 CPUs.
2023-06-09 18:02:00,483 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/0/metrics.json
2023-06-09 18:02:00,483 INFO:====================================
2023-06-09 18:02:00,483 INFO:iteration: 0
2023-06-09 18:02:00,484 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-09 18:02:00,485 INFO:Completed in 1308.394s
2023-06-09 18:02:00,485 INFO:====================================
2023-06-09 18:02:00,486 INFO:============LOGGING FRONTIERS============
2023-06-09 18:02:00,488 INFO:	 total_solved_tasks_train @ iteration 0: 3 / 491
2023-06-09 18:02:00,489 INFO:	 total_solved_tasks_test @ iteration 0: 16 / 500
2023-06-09 18:02:00,492 INFO:====================================
2023-06-09 18:02:00,493 INFO:============LOGGING MODEL_FN============
2023-06-09 18:02:00,493 INFO:	iteration: 0
2023-06-09 18:02:00,493 INFO:	run_every_n_iterations: 3
2023-06-09 18:02:00,494 INFO:	experiment_block_type: model_fn
2023-06-09 18:02:00,494 INFO:	model_type: grammar
2023-06-09 18:02:00,494 INFO:	params: {'compute_likelihoods': True, 'compute_description_lengths': True, 'save_filename': 'test_likelihoods.json'}
2023-06-09 18:02:00,495 INFO:	model_fn: evaluate_frontiers
2023-06-09 18:02:00,495 INFO:	task_batch_sizes: ['all']
2023-06-09 18:02:00,495 INFO:	task_splits: ['test']
2023-06-09 18:02:00,496 INFO:task_ids test: 500 tasks: re2_test_0_if_the_word_ends_with_s_replace_that_with_m -- re2_test_499_if_there_is_consonant_replace_that_with_q_f
2023-06-09 18:02:00,496 INFO:====================================
2023-06-09 18:02:00,650 INFO:EVALUATION: evaluate_frontiers : mean log likelihood of 16 programs in splits: ['test'] is: -15.009122126236907
2023-06-09 18:02:00,661 INFO:EVALUATION: evaluate_frontiers : mean description length of 16 programs in splits: ['test'] is: 6.4125
2023-06-09 18:02:00,889 INFO:============Checkpointing frontiers to experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/0/frontiers.json===========
2023-06-09 18:02:00,891 INFO:============LOGGING MODEL_FN============
2023-06-09 18:02:00,891 INFO:	iteration: 0
2023-06-09 18:02:00,891 INFO:	experiment_block_type: model_fn
2023-06-09 18:02:00,891 INFO:	model_type: library_learner
2023-06-09 18:02:00,892 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-09 18:02:00,892 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-09 18:02:00,892 INFO:	task_batch_sizes: ['all']
2023-06-09 18:02:00,892 INFO:	task_splits: ['train']
2023-06-09 18:02:00,892 INFO:task_ids train: 491 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_432_if_the_word_ends_with_vowel_any_letter_replace_that_with_h_i
2023-06-09 18:02:00,892 INFO:====================================
2023-06-09 18:02:00,978 INFO:Updated grammar (productions=42) with 3 new abstractions.
2023-06-09 18:02:01,008 INFO:reset_task_frontiers for split: train
2023-06-09 18:02:01,009 INFO:reset_samples for split: train
2023-06-09 18:02:01,009 INFO:============LOGGING METADATA============
2023-06-09 18:02:01,009 INFO:	iteration: 1
2023-06-09 18:02:01,009 INFO:	dsl_description_prefix: This is a domain-specific language for regular expressions that specify string transformations.
2023-06-09 18:02:01,010 INFO:	encoder: re2
2023-06-09 18:02:01,010 INFO:	recognition_train_steps: 100
2023-06-09 18:02:01,010 INFO:	task_language_loader: re2_synthetic
2023-06-09 18:02:01,010 INFO:	export_with_timestamp: False
2023-06-09 18:02:01,010 INFO:	resume_checkpoint_directory: None
2023-06-09 18:02:01,010 INFO:	enumeration_timeout: 10
2023-06-09 18:02:01,010 INFO:	random_seed: 111
2023-06-09 18:02:01,010 INFO:	global_batch_size: 96
2023-06-09 18:02:01,010 INFO:	log_directory: experiments_iterative/logs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:02:01,010 INFO:	export_directory: experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:02:01,010 INFO:	ocaml_special_handler: re2
2023-06-09 18:02:01,010 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-09 18:02:01,010 INFO:	timestamp: 
2023-06-09 18:02:01,010 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-09 18:02:01,010 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-09 18:02:01,010 INFO:	experiment_name: test_runs
2023-06-09 18:02:01,010 INFO:	curr_iteration: 0
2023-06-09 18:02:01,010 INFO:	init_grammar_from_checkpoint: False
2023-06-09 18:02:01,011 INFO:	init_frontiers_every_iteration: False
2023-06-09 18:02:01,020 INFO:	random_generator: Generator(PCG64)
2023-06-09 18:02:01,021 INFO:	tasks_loader: re2
2023-06-09 18:02:01,021 INFO:	init_frontiers_from_checkpoint: False
2023-06-09 18:02:01,021 INFO:====================================
2023-06-09 18:02:01,021 INFO:============LOGGING FRONTIERS============
2023-06-09 18:02:01,022 INFO:	 total_solved_tasks_train @ iteration 1: 3 / 491
2023-06-09 18:02:01,023 INFO:	 total_solved_tasks_test @ iteration 1: 16 / 500
2023-06-09 18:02:01,023 INFO:====================================
2023-06-09 18:02:01,023 INFO:============LOGGING MODEL_FN============
2023-06-09 18:02:01,023 INFO:	iteration: 1
2023-06-09 18:02:01,023 INFO:	experiment_block_type: model_fn
2023-06-09 18:02:01,023 INFO:	task_split: train
2023-06-09 18:02:01,023 INFO:	params: {'recognition_train_steps': 100}
2023-06-09 18:02:01,024 INFO:	model_fn: optimize_model_for_frontiers
2023-06-09 18:02:01,024 INFO:	task_batch_size: all
2023-06-09 18:02:01,024 INFO:	model_type: amortized_synthesis
2023-06-09 18:02:01,024 INFO:task_ids: 491 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_432_if_the_word_ends_with_vowel_any_letter_replace_that_with_h_i
2023-06-09 18:02:01,024 INFO:====================================
2023-06-09 18:02:01,158 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-09 18:02:01,204 INFO:Attempted frontier likelihood normalization. Initial frontiers: 3. Now: 3
2023-06-09 18:02:01,433 INFO:Sampling new helmholtz frontiers during training.
2023-06-09 18:02:05,558 INFO:We now have 494 Helmholtz entries.
2023-06-09 18:02:11,428 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/1/metrics.json
2023-06-09 18:02:11,429 INFO:====================================
2023-06-09 18:02:11,429 INFO:iteration: 1
2023-06-09 18:02:11,429 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-09 18:02:11,430 INFO:Completed in 10.403s
2023-06-09 18:02:11,430 INFO:====================================
2023-06-09 18:02:11,431 INFO:============LOGGING MODEL_FN============
2023-06-09 18:02:11,431 INFO:	iteration: 1
2023-06-09 18:02:11,432 INFO:	experiment_block_type: model_fn
2023-06-09 18:02:11,432 INFO:	task_split: train
2023-06-09 18:02:11,432 INFO:	params: {'enumeration_timeout': 10}
2023-06-09 18:02:11,433 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 18:02:11,433 INFO:	task_batch_size: global_batch_size
2023-06-09 18:02:11,433 INFO:	model_type: amortized_synthesis
2023-06-09 18:02:11,434 INFO:task_ids: 96 tasks: re2_train_28_if_the_word_starts_with_any_letter_consonant_replace_that_with_w_t -- re2_train_39_if_there_is_c_add_d_before_that
2023-06-09 18:02:11,434 INFO:====================================
2023-06-09 18:02:19,951 INFO:Beginning enumeration on a total of 96 tasks with a total of 4 CPUs.
2023-06-09 18:06:29,278 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/1/metrics.json
2023-06-09 18:06:29,278 INFO:====================================
2023-06-09 18:06:29,279 INFO:iteration: 1
2023-06-09 18:06:29,279 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-09 18:06:29,279 INFO:Completed in 257.842s
2023-06-09 18:06:29,280 INFO:====================================
2023-06-09 18:06:29,280 INFO:============LOGGING FRONTIERS============
2023-06-09 18:06:29,282 INFO:	 total_solved_tasks_train @ iteration 1: 16 / 491
2023-06-09 18:06:29,283 INFO:	 total_solved_tasks_test @ iteration 1: 16 / 500
2023-06-09 18:06:29,296 INFO:====================================
2023-06-09 18:06:29,528 INFO:============Checkpointing frontiers to experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/1/frontiers.json===========
2023-06-09 18:06:29,537 INFO:============LOGGING MODEL_FN============
2023-06-09 18:06:29,537 INFO:	iteration: 1
2023-06-09 18:06:29,537 INFO:	experiment_block_type: model_fn
2023-06-09 18:06:29,537 INFO:	model_type: library_learner
2023-06-09 18:06:29,537 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-09 18:06:29,537 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-09 18:06:29,537 INFO:	task_batch_sizes: ['all']
2023-06-09 18:06:29,537 INFO:	task_splits: ['train']
2023-06-09 18:06:29,537 INFO:task_ids train: 491 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_432_if_the_word_ends_with_vowel_any_letter_replace_that_with_h_i
2023-06-09 18:06:29,537 INFO:====================================
2023-06-09 18:06:29,875 INFO:Updated grammar (productions=42) with 8 new abstractions.
2023-06-09 18:06:30,027 INFO:reset_task_frontiers for split: train
2023-06-09 18:06:30,030 INFO:reset_samples for split: train
2023-06-09 18:06:30,030 INFO:============LOGGING METADATA============
2023-06-09 18:06:30,031 INFO:	iteration: 2
2023-06-09 18:06:30,031 INFO:	dsl_description_prefix: This is a domain-specific language for regular expressions that specify string transformations.
2023-06-09 18:06:30,032 INFO:	encoder: re2
2023-06-09 18:06:30,032 INFO:	recognition_train_steps: 100
2023-06-09 18:06:30,032 INFO:	task_language_loader: re2_synthetic
2023-06-09 18:06:30,033 INFO:	export_with_timestamp: False
2023-06-09 18:06:30,033 INFO:	resume_checkpoint_directory: None
2023-06-09 18:06:30,033 INFO:	enumeration_timeout: 10
2023-06-09 18:06:30,034 INFO:	random_seed: 111
2023-06-09 18:06:30,034 INFO:	global_batch_size: 96
2023-06-09 18:06:30,034 INFO:	log_directory: experiments_iterative/logs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:06:30,035 INFO:	export_directory: experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:06:30,035 INFO:	ocaml_special_handler: re2
2023-06-09 18:06:30,035 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-09 18:06:30,036 INFO:	timestamp: 
2023-06-09 18:06:30,036 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-09 18:06:30,037 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-09 18:06:30,037 INFO:	experiment_name: test_runs
2023-06-09 18:06:30,037 INFO:	curr_iteration: 0
2023-06-09 18:06:30,038 INFO:	init_grammar_from_checkpoint: False
2023-06-09 18:06:30,038 INFO:	init_frontiers_every_iteration: False
2023-06-09 18:06:30,038 INFO:	random_generator: Generator(PCG64)
2023-06-09 18:06:30,039 INFO:	tasks_loader: re2
2023-06-09 18:06:30,039 INFO:	init_frontiers_from_checkpoint: False
2023-06-09 18:06:30,039 INFO:====================================
2023-06-09 18:06:30,040 INFO:============LOGGING FRONTIERS============
2023-06-09 18:06:30,041 INFO:	 total_solved_tasks_train @ iteration 2: 16 / 491
2023-06-09 18:06:30,042 INFO:	 total_solved_tasks_test @ iteration 2: 16 / 500
2023-06-09 18:06:30,042 INFO:====================================
2023-06-09 18:06:30,043 INFO:============LOGGING MODEL_FN============
2023-06-09 18:06:30,043 INFO:	iteration: 2
2023-06-09 18:06:30,043 INFO:	experiment_block_type: model_fn
2023-06-09 18:06:30,044 INFO:	task_split: train
2023-06-09 18:06:30,044 INFO:	params: {'recognition_train_steps': 100}
2023-06-09 18:06:30,044 INFO:	model_fn: optimize_model_for_frontiers
2023-06-09 18:06:30,045 INFO:	task_batch_size: all
2023-06-09 18:06:30,045 INFO:	model_type: amortized_synthesis
2023-06-09 18:06:30,045 INFO:task_ids: 491 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_432_if_the_word_ends_with_vowel_any_letter_replace_that_with_h_i
2023-06-09 18:06:30,046 INFO:====================================
2023-06-09 18:06:30,106 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-09 18:06:30,657 INFO:Attempted frontier likelihood normalization. Initial frontiers: 16. Now: 16
2023-06-09 18:06:30,725 INFO:Sampling new helmholtz frontiers during training.
2023-06-09 18:06:35,720 INFO:We now have 492 Helmholtz entries.
2023-06-09 18:06:43,453 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/2/metrics.json
2023-06-09 18:06:43,453 INFO:====================================
2023-06-09 18:06:43,454 INFO:iteration: 2
2023-06-09 18:06:43,454 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-09 18:06:43,454 INFO:Completed in 13.393s
2023-06-09 18:06:43,454 INFO:====================================
2023-06-09 18:06:43,454 INFO:============LOGGING MODEL_FN============
2023-06-09 18:06:43,454 INFO:	iteration: 2
2023-06-09 18:06:43,454 INFO:	experiment_block_type: model_fn
2023-06-09 18:06:43,454 INFO:	task_split: train
2023-06-09 18:06:43,454 INFO:	params: {'enumeration_timeout': 10}
2023-06-09 18:06:43,454 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 18:06:43,455 INFO:	task_batch_size: global_batch_size
2023-06-09 18:06:43,455 INFO:	model_type: amortized_synthesis
2023-06-09 18:06:43,455 INFO:task_ids: 96 tasks: re2_train_66_if_the_word_starts_with_any_letter_any_letter_add_j_before_that -- re2_train_368_if_the_word_starts_with_consonant_any_letter_add_s_before_that
2023-06-09 18:06:43,455 INFO:====================================
2023-06-09 18:07:03,749 INFO:Beginning enumeration on a total of 96 tasks with a total of 4 CPUs.
2023-06-09 18:11:10,267 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/2/metrics.json
2023-06-09 18:11:10,267 INFO:====================================
2023-06-09 18:11:10,267 INFO:iteration: 2
2023-06-09 18:11:10,268 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-09 18:11:10,268 INFO:Completed in 266.810s
2023-06-09 18:11:10,269 INFO:====================================
2023-06-09 18:11:10,269 INFO:============LOGGING FRONTIERS============
2023-06-09 18:11:10,271 INFO:	 total_solved_tasks_train @ iteration 2: 31 / 491
2023-06-09 18:11:10,273 INFO:	 total_solved_tasks_test @ iteration 2: 16 / 500
2023-06-09 18:11:10,273 INFO:====================================
2023-06-09 18:11:10,435 INFO:============Checkpointing frontiers to experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/2/frontiers.json===========
2023-06-09 18:11:10,438 INFO:============LOGGING MODEL_FN============
2023-06-09 18:11:10,438 INFO:	iteration: 2
2023-06-09 18:11:10,439 INFO:	experiment_block_type: model_fn
2023-06-09 18:11:10,439 INFO:	model_type: library_learner
2023-06-09 18:11:10,439 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-09 18:11:10,440 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-09 18:11:10,440 INFO:	task_batch_sizes: ['all']
2023-06-09 18:11:10,440 INFO:	task_splits: ['train']
2023-06-09 18:11:10,441 INFO:task_ids train: 491 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_432_if_the_word_ends_with_vowel_any_letter_replace_that_with_h_i
2023-06-09 18:11:10,441 INFO:====================================
2023-06-09 18:11:11,400 INFO:Updated grammar (productions=42) with 10 new abstractions.
2023-06-09 18:11:11,597 INFO:reset_task_frontiers for split: train
2023-06-09 18:11:11,603 INFO:reset_samples for split: train
2023-06-09 18:11:11,603 INFO:============LOGGING METADATA============
2023-06-09 18:11:11,604 INFO:	iteration: 3
2023-06-09 18:11:11,604 INFO:	dsl_description_prefix: This is a domain-specific language for regular expressions that specify string transformations.
2023-06-09 18:11:11,605 INFO:	encoder: re2
2023-06-09 18:11:11,605 INFO:	recognition_train_steps: 100
2023-06-09 18:11:11,605 INFO:	task_language_loader: re2_synthetic
2023-06-09 18:11:11,606 INFO:	export_with_timestamp: False
2023-06-09 18:11:11,606 INFO:	resume_checkpoint_directory: None
2023-06-09 18:11:11,607 INFO:	enumeration_timeout: 10
2023-06-09 18:11:11,607 INFO:	random_seed: 111
2023-06-09 18:11:11,607 INFO:	global_batch_size: 96
2023-06-09 18:11:11,608 INFO:	log_directory: experiments_iterative/logs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:11:11,608 INFO:	export_directory: experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:11:11,608 INFO:	ocaml_special_handler: re2
2023-06-09 18:11:11,609 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-09 18:11:11,609 INFO:	timestamp: 
2023-06-09 18:11:11,609 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-09 18:11:11,610 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-09 18:11:11,610 INFO:	experiment_name: test_runs
2023-06-09 18:11:11,611 INFO:	curr_iteration: 0
2023-06-09 18:11:11,611 INFO:	init_grammar_from_checkpoint: False
2023-06-09 18:11:11,611 INFO:	init_frontiers_every_iteration: False
2023-06-09 18:11:11,612 INFO:	random_generator: Generator(PCG64)
2023-06-09 18:11:11,612 INFO:	tasks_loader: re2
2023-06-09 18:11:11,612 INFO:	init_frontiers_from_checkpoint: False
2023-06-09 18:11:11,613 INFO:====================================
2023-06-09 18:11:11,613 INFO:============LOGGING FRONTIERS============
2023-06-09 18:11:11,614 INFO:	 total_solved_tasks_train @ iteration 3: 31 / 491
2023-06-09 18:11:11,615 INFO:	 total_solved_tasks_test @ iteration 3: 16 / 500
2023-06-09 18:11:11,615 INFO:====================================
2023-06-09 18:11:11,616 INFO:============LOGGING MODEL_FN============
2023-06-09 18:11:11,616 INFO:	iteration: 3
2023-06-09 18:11:11,616 INFO:	experiment_block_type: model_fn
2023-06-09 18:11:11,617 INFO:	task_split: train
2023-06-09 18:11:11,617 INFO:	params: {'recognition_train_steps': 100}
2023-06-09 18:11:11,617 INFO:	model_fn: optimize_model_for_frontiers
2023-06-09 18:11:11,618 INFO:	task_batch_size: all
2023-06-09 18:11:11,618 INFO:	model_type: amortized_synthesis
2023-06-09 18:11:11,618 INFO:task_ids: 491 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_432_if_the_word_ends_with_vowel_any_letter_replace_that_with_h_i
2023-06-09 18:11:11,619 INFO:====================================
2023-06-09 18:11:11,679 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-09 18:11:12,470 INFO:Attempted frontier likelihood normalization. Initial frontiers: 31. Now: 31
2023-06-09 18:11:12,724 INFO:Sampling new helmholtz frontiers during training.
2023-06-09 18:11:17,689 INFO:We now have 495 Helmholtz entries.
2023-06-09 18:11:25,175 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/3/metrics.json
2023-06-09 18:11:25,175 INFO:====================================
2023-06-09 18:11:25,175 INFO:iteration: 3
2023-06-09 18:11:25,175 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-09 18:11:25,175 INFO:Completed in 13.555s
2023-06-09 18:11:25,175 INFO:====================================
2023-06-09 18:11:25,175 INFO:============LOGGING MODEL_FN============
2023-06-09 18:11:25,175 INFO:	iteration: 3
2023-06-09 18:11:25,175 INFO:	experiment_block_type: model_fn
2023-06-09 18:11:25,175 INFO:	task_split: train
2023-06-09 18:11:25,175 INFO:	params: {'enumeration_timeout': 10}
2023-06-09 18:11:25,175 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 18:11:25,175 INFO:	task_batch_size: global_batch_size
2023-06-09 18:11:25,175 INFO:	model_type: amortized_synthesis
2023-06-09 18:11:25,176 INFO:task_ids: 96 tasks: re2_train_3_if_there_is_d_replace_that_with_y -- re2_train_314_if_the_word_starts_with_vowel_add_l_after_that
2023-06-09 18:11:25,176 INFO:====================================
2023-06-09 18:11:55,207 INFO:Beginning enumeration on a total of 96 tasks with a total of 4 CPUs.
2023-06-09 18:16:07,228 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/3/metrics.json
2023-06-09 18:16:07,228 INFO:====================================
2023-06-09 18:16:07,229 INFO:iteration: 3
2023-06-09 18:16:07,229 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-09 18:16:07,229 INFO:Completed in 282.051s
2023-06-09 18:16:07,230 INFO:====================================
2023-06-09 18:16:07,230 INFO:============LOGGING FRONTIERS============
2023-06-09 18:16:07,232 INFO:	 total_solved_tasks_train @ iteration 3: 42 / 491
2023-06-09 18:16:07,233 INFO:	 total_solved_tasks_test @ iteration 3: 16 / 500
2023-06-09 18:16:07,234 INFO:====================================
2023-06-09 18:16:07,236 INFO:reset_task_frontiers for split: test
2023-06-09 18:16:07,236 INFO:============LOGGING MODEL_FN============
2023-06-09 18:16:07,237 INFO:	iteration: 3
2023-06-09 18:16:07,237 INFO:	run_every_n_iterations: 3
2023-06-09 18:16:07,237 INFO:	experiment_block_type: model_fn
2023-06-09 18:16:07,238 INFO:	task_split: test
2023-06-09 18:16:07,238 INFO:	params: {'enumeration_timeout': 10}
2023-06-09 18:16:07,238 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 18:16:07,239 INFO:	task_batch_size: all
2023-06-09 18:16:07,239 INFO:	model_type: amortized_synthesis
2023-06-09 18:16:07,239 INFO:task_ids: 500 tasks: re2_test_0_if_the_word_ends_with_s_replace_that_with_m -- re2_test_499_if_there_is_consonant_replace_that_with_q_f
2023-06-09 18:16:07,239 INFO:====================================
2023-06-09 18:16:43,663 ERROR:Exception encountered while running experiment. See logs at: experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/run.log
Traceback (most recent call last):
  File "run_iterative_experiment.py", line 321, in main
    run_experiment(args, experiment_state, experiment_iterator)
  File "/home/ubuntu/lilo/run_experiment.py", line 81, in run_experiment
    experiment_iterator.next(experiment_state)
  File "/home/ubuntu/lilo/src/experiment_iterator.py", line 734, in next
    self.execute_model_fn(experiment_state, curr_loop_block)
  File "/home/ubuntu/lilo/src/experiment_iterator.py", line 791, in execute_model_fn
    self.execute_model_fn_single_split(experiment_state, curr_loop_block)
  File "/home/ubuntu/lilo/src/experiment_iterator.py", line 851, in execute_model_fn_single_split
    **curr_loop_block[PARAMS],
  File "/home/ubuntu/lilo/src/models/laps_dreamcoder_recognition.py", line 86, in infer_programs_for_tasks
    testing=task_split == TEST,
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 1738, in enumerateFrontiers
    grammars = {task: self.grammarOfTask(task) for task in tasks}
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 1738, in <dictcomp>
    grammars = {task: self.grammarOfTask(task) for task in tasks}
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 1009, in grammarOfTask
    return self(features)
  File "/opt/conda/envs/lilo/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 994, in forward
    return self.grammarBuilder(features)
  File "/opt/conda/envs/lilo/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 197, in forward
    for prim, js in self.library.items()
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 197, in <dictcomp>
    for prim, js in self.library.items()
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 196, in <listcomp>
    prim: [self.grammarFromVector(transitionMatrix[j]) for j in js]
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 182, in grammarFromVector
    continuationType=self.grammar.continuationType,
  File "/home/ubuntu/lilo/dreamcoder/grammar.py", line 53, in __init__
    ) = self.build_escaped_vocab(self.vocab)
  File "/home/ubuntu/lilo/dreamcoder/grammar.py", line 68, in build_escaped_vocab
    reduced = p.betaNormalForm().left_order_tokens()
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 44, in betaNormalForm
    np = n.betaReduce()
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 634, in betaReduce
    b = self.body.betaReduce()
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 634, in betaReduce
    b = self.body.betaReduce()
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 301, in betaReduce
    f = self.f.betaReduce()
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 301, in betaReduce
    f = self.f.betaReduce()
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 301, in betaReduce
    f = self.f.betaReduce()
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 634, in betaReduce
    b = self.body.betaReduce()
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 634, in betaReduce
    b = self.body.betaReduce()
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 634, in betaReduce
    b = self.body.betaReduce()
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 301, in betaReduce
    f = self.f.betaReduce()
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 315, in betaReduce
    return b.substitute(Index(0), v.shift(1)).shift(-1)
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 647, in shift
    return Abstraction(self.body.shift(offset, depth + 1))
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 432, in shift
    return Application(self.f.shift(offset, depth), self.x.shift(offset, depth))
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 432, in shift
    return Application(self.f.shift(offset, depth), self.x.shift(offset, depth))
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 432, in shift
    return Application(self.f.shift(offset, depth), self.x.shift(offset, depth))
  [Previous line repeated 2 more times]
  File "/home/ubuntu/lilo/dreamcoder/program.py", line 285, in __init__
    and f.isApplication
KeyboardInterrupt
frontiers_from_checkpoint: False
2023-06-09 18:03:05,246 INFO:	experiment_name: test_runs
2023-06-09 18:03:05,247 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-09 18:03:05,247 INFO:	export_directory: experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:03:05,247 INFO:	encoder: re2
2023-06-09 18:03:05,248 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-09 18:03:05,248 INFO:	recognition_train_steps: 100
2023-06-09 18:03:05,248 INFO:	export_with_timestamp: False
2023-06-09 18:03:05,249 INFO:====================================
2023-06-09 18:03:05,249 INFO:============LOGGING FRONTIERS============
2023-06-09 18:03:05,250 INFO:	 total_solved_tasks_train @ iteration 4: 45 / 491
2023-06-09 18:03:05,251 INFO:	 total_solved_tasks_test @ iteration 4: 91 / 500
2023-06-09 18:03:05,252 INFO:====================================
2023-06-09 18:03:05,252 INFO:============LOGGING MODEL_FN============
2023-06-09 18:03:05,252 INFO:	iteration: 4
2023-06-09 18:03:05,253 INFO:	model_fn: optimize_model_for_frontiers
2023-06-09 18:03:05,253 INFO:	task_batch_size: all
2023-06-09 18:03:05,254 INFO:	model_type: amortized_synthesis
2023-06-09 18:03:05,254 INFO:	experiment_block_type: model_fn
2023-06-09 18:03:05,254 INFO:	task_split: train
2023-06-09 18:03:05,255 INFO:	params: {'recognition_train_steps': 100}
2023-06-09 18:03:05,255 INFO:task_ids: 491 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_432_if_the_word_ends_with_vowel_any_letter_replace_that_with_h_i
2023-06-09 18:03:05,255 INFO:====================================
2023-06-09 18:03:05,316 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-09 18:03:06,472 INFO:Attempted frontier likelihood normalization. Initial frontiers: 45. Now: 45
2023-06-09 18:03:06,474 INFO:Sampling new helmholtz frontiers during training.
2023-06-09 18:03:10,111 INFO:We now have 496 Helmholtz entries.
2023-06-09 18:03:17,060 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/4/metrics.json
2023-06-09 18:03:17,061 INFO:====================================
2023-06-09 18:03:17,061 INFO:iteration: 4
2023-06-09 18:03:17,061 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-09 18:03:17,062 INFO:Completed in 11.791s
2023-06-09 18:03:17,062 INFO:====================================
2023-06-09 18:03:17,062 INFO:============LOGGING MODEL_FN============
2023-06-09 18:03:17,062 INFO:	iteration: 4
2023-06-09 18:03:17,063 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 18:03:17,063 INFO:	task_batch_size: global_batch_size
2023-06-09 18:03:17,063 INFO:	model_type: amortized_synthesis
2023-06-09 18:03:17,064 INFO:	experiment_block_type: model_fn
2023-06-09 18:03:17,064 INFO:	task_split: train
2023-06-09 18:03:17,064 INFO:	params: {'enumeration_timeout': 10}
2023-06-09 18:03:17,065 INFO:task_ids: 96 tasks: re2_train_300_if_there_is_n_replace_that_with_g -- re2_train_423_if_there_is_consonant_l_replace_that_with_m_x
2023-06-09 18:03:17,065 INFO:====================================
2023-06-09 18:03:48,419 INFO:Beginning enumeration on a total of 96 tasks with a total of 4 CPUs.
2023-06-09 18:07:59,379 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/4/metrics.json
2023-06-09 18:07:59,379 INFO:====================================
2023-06-09 18:07:59,380 INFO:iteration: 4
2023-06-09 18:07:59,380 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-09 18:07:59,380 INFO:Completed in 282.312s
2023-06-09 18:07:59,381 INFO:====================================
2023-06-09 18:07:59,381 INFO:============LOGGING FRONTIERS============
2023-06-09 18:07:59,383 INFO:	 total_solved_tasks_train @ iteration 4: 58 / 491
2023-06-09 18:07:59,385 INFO:	 total_solved_tasks_test @ iteration 4: 91 / 500
2023-06-09 18:07:59,386 INFO:====================================
2023-06-09 18:07:59,558 INFO:============Checkpointing frontiers to experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/4/frontiers.json===========
2023-06-09 18:07:59,567 INFO:============LOGGING MODEL_FN============
2023-06-09 18:07:59,567 INFO:	iteration: 4
2023-06-09 18:07:59,567 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-09 18:07:59,567 INFO:	model_type: library_learner
2023-06-09 18:07:59,567 INFO:	task_splits: ['train']
2023-06-09 18:07:59,567 INFO:	experiment_block_type: model_fn
2023-06-09 18:07:59,567 INFO:	task_batch_sizes: ['all']
2023-06-09 18:07:59,567 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-09 18:07:59,567 INFO:task_ids train: 491 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_432_if_the_word_ends_with_vowel_any_letter_replace_that_with_h_i
2023-06-09 18:07:59,567 INFO:====================================
2023-06-09 18:08:02,058 INFO:Updated grammar (productions=42) with 10 new abstractions.
2023-06-09 18:08:02,425 INFO:reset_task_frontiers for split: train
2023-06-09 18:08:02,437 INFO:reset_samples for split: train
2023-06-09 18:08:02,438 INFO:============LOGGING METADATA============
2023-06-09 18:08:02,438 INFO:	iteration: 5
2023-06-09 18:08:02,439 INFO:	task_language_loader: re2_synthetic
2023-06-09 18:08:02,439 INFO:	tasks_loader: re2
2023-06-09 18:08:02,439 INFO:	random_seed: 111
2023-06-09 18:08:02,440 INFO:	timestamp: 
2023-06-09 18:08:02,440 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-09 18:08:02,440 INFO:	dsl_description_prefix: This is a domain-specific language for regular expressions that specify string transformations.
2023-06-09 18:08:02,440 INFO:	global_batch_size: 96
2023-06-09 18:08:02,441 INFO:	ocaml_special_handler: re2
2023-06-09 18:08:02,441 INFO:	init_grammar_from_checkpoint: False
2023-06-09 18:08:02,441 INFO:	curr_iteration: 0
2023-06-09 18:08:02,442 INFO:	init_frontiers_every_iteration: False
2023-06-09 18:08:02,442 INFO:	log_directory: experiments_iterative/logs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:08:02,442 INFO:	enumeration_timeout: 10
2023-06-09 18:08:02,442 INFO:	random_generator: Generator(PCG64)
2023-06-09 18:08:02,443 INFO:	resume_checkpoint_directory: None
2023-06-09 18:08:02,443 INFO:	init_frontiers_from_checkpoint: False
2023-06-09 18:08:02,443 INFO:	experiment_name: test_runs
2023-06-09 18:08:02,443 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-09 18:08:02,443 INFO:	export_directory: experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:08:02,444 INFO:	encoder: re2
2023-06-09 18:08:02,444 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-09 18:08:02,444 INFO:	recognition_train_steps: 100
2023-06-09 18:08:02,444 INFO:	export_with_timestamp: False
2023-06-09 18:08:02,445 INFO:====================================
2023-06-09 18:08:02,445 INFO:============LOGGING FRONTIERS============
2023-06-09 18:08:02,446 INFO:	 total_solved_tasks_train @ iteration 5: 58 / 491
2023-06-09 18:08:02,447 INFO:	 total_solved_tasks_test @ iteration 5: 91 / 500
2023-06-09 18:08:02,447 INFO:====================================
2023-06-09 18:08:02,447 INFO:============LOGGING MODEL_FN============
2023-06-09 18:08:02,447 INFO:	iteration: 5
2023-06-09 18:08:02,448 INFO:	model_fn: optimize_model_for_frontiers
2023-06-09 18:08:02,448 INFO:	task_batch_size: all
2023-06-09 18:08:02,448 INFO:	model_type: amortized_synthesis
2023-06-09 18:08:02,448 INFO:	experiment_block_type: model_fn
2023-06-09 18:08:02,449 INFO:	task_split: train
2023-06-09 18:08:02,449 INFO:	params: {'recognition_train_steps': 100}
2023-06-09 18:08:02,449 INFO:task_ids: 491 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_432_if_the_word_ends_with_vowel_any_letter_replace_that_with_h_i
2023-06-09 18:08:02,449 INFO:====================================
2023-06-09 18:08:02,514 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-09 18:08:03,684 INFO:Attempted frontier likelihood normalization. Initial frontiers: 58. Now: 58
2023-06-09 18:08:03,734 INFO:Sampling new helmholtz frontiers during training.
2023-06-09 18:08:07,267 INFO:We now have 498 Helmholtz entries.
2023-06-09 18:08:14,219 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/5/metrics.json
2023-06-09 18:08:14,219 INFO:====================================
2023-06-09 18:08:14,220 INFO:iteration: 5
2023-06-09 18:08:14,220 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-09 18:08:14,220 INFO:Completed in 11.768s
2023-06-09 18:08:14,221 INFO:====================================
2023-06-09 18:08:14,221 INFO:============LOGGING MODEL_FN============
2023-06-09 18:08:14,221 INFO:	iteration: 5
2023-06-09 18:08:14,222 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 18:08:14,222 INFO:	task_batch_size: global_batch_size
2023-06-09 18:08:14,222 INFO:	model_type: amortized_synthesis
2023-06-09 18:08:14,222 INFO:	experiment_block_type: model_fn
2023-06-09 18:08:14,223 INFO:	task_split: train
2023-06-09 18:08:14,223 INFO:	params: {'enumeration_timeout': 10}
2023-06-09 18:08:14,223 INFO:task_ids: 96 tasks: re2_train_322_if_the_word_starts_with_any_letter_replace_that_with_g_b -- re2_train_275_if_the_word_ends_with_consonant_replace_that_with_r
2023-06-09 18:08:14,224 INFO:====================================
2023-06-09 18:08:50,486 INFO:Beginning enumeration on a total of 96 tasks with a total of 4 CPUs.
2023-06-09 18:12:59,337 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/5/metrics.json
2023-06-09 18:12:59,338 INFO:====================================
2023-06-09 18:12:59,338 INFO:iteration: 5
2023-06-09 18:12:59,338 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-09 18:12:59,338 INFO:Completed in 285.113s
2023-06-09 18:12:59,338 INFO:====================================
2023-06-09 18:12:59,338 INFO:============LOGGING FRONTIERS============
2023-06-09 18:12:59,340 INFO:	 total_solved_tasks_train @ iteration 5: 62 / 491
2023-06-09 18:12:59,342 INFO:	 total_solved_tasks_test @ iteration 5: 91 / 500
2023-06-09 18:12:59,342 INFO:====================================
2023-06-09 18:12:59,498 INFO:============Checkpointing frontiers to experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/5/frontiers.json===========
2023-06-09 18:12:59,505 INFO:============LOGGING MODEL_FN============
2023-06-09 18:12:59,506 INFO:	iteration: 5
2023-06-09 18:12:59,506 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-09 18:12:59,507 INFO:	model_type: library_learner
2023-06-09 18:12:59,507 INFO:	task_splits: ['train']
2023-06-09 18:12:59,507 INFO:	experiment_block_type: model_fn
2023-06-09 18:12:59,508 INFO:	task_batch_sizes: ['all']
2023-06-09 18:12:59,508 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-09 18:12:59,508 INFO:task_ids train: 491 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_432_if_the_word_ends_with_vowel_any_letter_replace_that_with_h_i
2023-06-09 18:12:59,509 INFO:====================================
2023-06-09 18:13:02,289 INFO:Updated grammar (productions=42) with 10 new abstractions.
2023-06-09 18:13:02,673 INFO:reset_task_frontiers for split: train
2023-06-09 18:13:02,686 INFO:reset_samples for split: train
2023-06-09 18:13:02,687 INFO:============LOGGING METADATA============
2023-06-09 18:13:02,687 INFO:	iteration: 6
2023-06-09 18:13:02,688 INFO:	task_language_loader: re2_synthetic
2023-06-09 18:13:02,688 INFO:	tasks_loader: re2
2023-06-09 18:13:02,688 INFO:	random_seed: 111
2023-06-09 18:13:02,689 INFO:	timestamp: 
2023-06-09 18:13:02,689 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-09 18:13:02,689 INFO:	dsl_description_prefix: This is a domain-specific language for regular expressions that specify string transformations.
2023-06-09 18:13:02,689 INFO:	global_batch_size: 96
2023-06-09 18:13:02,690 INFO:	ocaml_special_handler: re2
2023-06-09 18:13:02,690 INFO:	init_grammar_from_checkpoint: False
2023-06-09 18:13:02,690 INFO:	curr_iteration: 0
2023-06-09 18:13:02,690 INFO:	init_frontiers_every_iteration: False
2023-06-09 18:13:02,691 INFO:	log_directory: experiments_iterative/logs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:13:02,691 INFO:	enumeration_timeout: 10
2023-06-09 18:13:02,691 INFO:	random_generator: Generator(PCG64)
2023-06-09 18:13:02,691 INFO:	resume_checkpoint_directory: None
2023-06-09 18:13:02,692 INFO:	init_frontiers_from_checkpoint: False
2023-06-09 18:13:02,692 INFO:	experiment_name: test_runs
2023-06-09 18:13:02,692 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-09 18:13:02,692 INFO:	export_directory: experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:13:02,693 INFO:	encoder: re2
2023-06-09 18:13:02,693 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-09 18:13:02,693 INFO:	recognition_train_steps: 100
2023-06-09 18:13:02,694 INFO:	export_with_timestamp: False
2023-06-09 18:13:02,694 INFO:====================================
2023-06-09 18:13:02,694 INFO:============LOGGING FRONTIERS============
2023-06-09 18:13:02,695 INFO:	 total_solved_tasks_train @ iteration 6: 62 / 491
2023-06-09 18:13:02,696 INFO:	 total_solved_tasks_test @ iteration 6: 91 / 500
2023-06-09 18:13:02,697 INFO:====================================
2023-06-09 18:13:02,697 INFO:============LOGGING MODEL_FN============
2023-06-09 18:13:02,697 INFO:	iteration: 6
2023-06-09 18:13:02,698 INFO:	model_fn: optimize_model_for_frontiers
2023-06-09 18:13:02,698 INFO:	task_batch_size: all
2023-06-09 18:13:02,698 INFO:	model_type: amortized_synthesis
2023-06-09 18:13:02,699 INFO:	experiment_block_type: model_fn
2023-06-09 18:13:02,699 INFO:	task_split: train
2023-06-09 18:13:02,699 INFO:	params: {'recognition_train_steps': 100}
2023-06-09 18:13:02,699 INFO:task_ids: 491 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_432_if_the_word_ends_with_vowel_any_letter_replace_that_with_h_i
2023-06-09 18:13:02,700 INFO:====================================
2023-06-09 18:13:02,763 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-09 18:13:03,957 INFO:Attempted frontier likelihood normalization. Initial frontiers: 62. Now: 62
2023-06-09 18:13:04,037 INFO:Sampling new helmholtz frontiers during training.
2023-06-09 18:13:07,656 INFO:We now have 495 Helmholtz entries.
2023-06-09 18:13:14,147 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/6/metrics.json
2023-06-09 18:13:14,147 INFO:====================================
2023-06-09 18:13:14,147 INFO:iteration: 6
2023-06-09 18:13:14,147 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-09 18:13:14,147 INFO:Completed in 11.446s
2023-06-09 18:13:14,147 INFO:====================================
2023-06-09 18:13:14,147 INFO:============LOGGING MODEL_FN============
2023-06-09 18:13:14,147 INFO:	iteration: 6
2023-06-09 18:13:14,147 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 18:13:14,148 INFO:	task_batch_size: global_batch_size
2023-06-09 18:13:14,148 INFO:	model_type: amortized_synthesis
2023-06-09 18:13:14,148 INFO:	experiment_block_type: model_fn
2023-06-09 18:13:14,148 INFO:	task_split: train
2023-06-09 18:13:14,148 INFO:	params: {'enumeration_timeout': 10}
2023-06-09 18:13:14,148 INFO:task_ids: 96 tasks: re2_train_91_if_the_word_starts_with_consonant_vowel_add_t_before_that -- re2_train_390_if_the_word_ends_with_any_letter_any_letter_replace_that_with_j
2023-06-09 18:13:14,148 INFO:====================================
2023-06-09 18:13:45,582 INFO:Beginning enumeration on a total of 96 tasks with a total of 4 CPUs.
2023-06-09 18:17:53,304 INFO:Wrote experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/6/metrics.json
2023-06-09 18:17:53,305 INFO:====================================
2023-06-09 18:17:53,305 INFO:iteration: 6
2023-06-09 18:17:53,305 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-09 18:17:53,306 INFO:Completed in 279.155s
2023-06-09 18:17:53,306 INFO:====================================
2023-06-09 18:17:53,306 INFO:============LOGGING FRONTIERS============
2023-06-09 18:17:53,309 INFO:	 total_solved_tasks_train @ iteration 6: 63 / 491
2023-06-09 18:17:53,311 INFO:	 total_solved_tasks_test @ iteration 6: 91 / 500
2023-06-09 18:17:53,311 INFO:====================================
2023-06-09 18:17:53,318 INFO:reset_task_frontiers for split: test
2023-06-09 18:17:53,319 INFO:============LOGGING MODEL_FN============
2023-06-09 18:17:53,319 INFO:	iteration: 6
2023-06-09 18:17:53,320 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 18:17:53,320 INFO:	run_every_n_iterations: 3
2023-06-09 18:17:53,320 INFO:	task_batch_size: all
2023-06-09 18:17:53,320 INFO:	model_type: amortized_synthesis
2023-06-09 18:17:53,321 INFO:	experiment_block_type: model_fn
2023-06-09 18:17:53,321 INFO:	task_split: test
2023-06-09 18:17:53,321 INFO:	params: {'enumeration_timeout': 10}
2023-06-09 18:17:53,322 INFO:task_ids: 500 tasks: re2_test_0_if_the_word_ends_with_s_replace_that_with_m -- re2_test_499_if_there_is_consonant_replace_that_with_q_f
2023-06-09 18:17:53,322 INFO:====================================
2023-06-09 18:20:37,657 INFO:Beginning enumeration on a total of 500 tasks with a total of 4 CPUs.
2023-06-09 18:21:11,155 ERROR:Exception encountered while running experiment. See logs at: experiments_iterative/outputs/test_runs/domains/re2/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/run.log
Traceback (most recent call last):
  File "run_iterative_experiment.py", line 321, in main
    run_experiment(args, experiment_state, experiment_iterator)
  File "/home/ubuntu/lilo/run_experiment.py", line 81, in run_experiment
    experiment_iterator.next(experiment_state)
  File "/home/ubuntu/lilo/src/experiment_iterator.py", line 734, in next
    self.execute_model_fn(experiment_state, curr_loop_block)
  File "/home/ubuntu/lilo/src/experiment_iterator.py", line 791, in execute_model_fn
    self.execute_model_fn_single_split(experiment_state, curr_loop_block)
  File "/home/ubuntu/lilo/src/experiment_iterator.py", line 851, in execute_model_fn_single_split
    **curr_loop_block[PARAMS],
  File "/home/ubuntu/lilo/src/models/laps_dreamcoder_recognition.py", line 86, in infer_programs_for_tasks
    testing=task_split == TEST,
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 1758, in enumerateFrontiers
    likelihood_model_string=likelihood_model,
  File "/home/ubuntu/lilo/dreamcoder/enumeration.py", line 234, in multicoreEnumeration
    assert False
AssertionError
