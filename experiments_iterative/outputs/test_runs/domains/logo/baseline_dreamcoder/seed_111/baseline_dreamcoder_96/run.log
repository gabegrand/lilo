2023-06-09 18:28:58,974 INFO:============LOGGING METADATA============
2023-06-09 18:28:58,974 INFO:	iteration: 0
2023-06-09 18:28:58,975 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-09 18:28:58,975 INFO:	init_frontiers_every_iteration: False
2023-06-09 18:28:58,975 INFO:	ocaml_special_handler: LOGO
2023-06-09 18:28:58,976 INFO:	export_with_timestamp: False
2023-06-09 18:28:58,976 INFO:	global_batch_size: 96
2023-06-09 18:28:58,976 INFO:	experiment_name: test_runs
2023-06-09 18:28:58,977 INFO:	export_directory: experiments_iterative/outputs/test_runs/domains/logo/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:28:58,977 INFO:	random_seed: 111
2023-06-09 18:28:58,978 INFO:	task_language_loader: compositional_graphics_200_synthetic
2023-06-09 18:28:58,978 INFO:	timestamp: 
2023-06-09 18:28:58,978 INFO:	init_grammar_from_checkpoint: False
2023-06-09 18:28:58,979 INFO:	log_directory: experiments_iterative/logs/test_runs/domains/logo/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-09 18:28:58,979 INFO:	recognition_train_steps: 100
2023-06-09 18:28:58,979 INFO:	init_frontiers_from_checkpoint: False
2023-06-09 18:28:58,980 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-09 18:28:58,980 INFO:	curr_iteration: 0
2023-06-09 18:28:58,981 INFO:	random_generator: Generator(PCG64)
2023-06-09 18:28:58,981 INFO:	tasks_loader: compositional_graphics_200
2023-06-09 18:28:58,981 INFO:	enumeration_timeout: 10
2023-06-09 18:28:58,982 INFO:	resume_checkpoint_directory: None
2023-06-09 18:28:58,982 INFO:	encoder: LOGO
2023-06-09 18:28:58,982 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-09 18:28:58,983 INFO:	dsl_description_prefix: This is a domain-specific language for Logo turtle graphics.
2023-06-09 18:28:58,983 INFO:====================================
2023-06-09 18:28:58,983 INFO:============LOGGING FRONTIERS============
2023-06-09 18:28:58,984 INFO:	 total_solved_tasks_train @ iteration 0: 0 / 199
2023-06-09 18:28:58,985 INFO:	 total_solved_tasks_test @ iteration 0: 0 / 111
2023-06-09 18:28:58,985 INFO:====================================
2023-06-09 18:28:58,985 INFO:============LOGGING MODEL_FN============
2023-06-09 18:28:58,986 INFO:	iteration: 0
2023-06-09 18:28:58,986 INFO:	task_split: train
2023-06-09 18:28:58,987 INFO:	run_every_n_iterations: 1000
2023-06-09 18:28:58,987 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 18:28:58,987 INFO:	params: {'enumeration_timeout': 10, 'compute_likelihoods': True}
2023-06-09 18:28:58,988 INFO:	model_type: grammar
2023-06-09 18:28:58,988 INFO:	task_batch_size: global_batch_size
2023-06-09 18:28:58,988 INFO:	experiment_block_type: model_fn
2023-06-09 18:28:58,989 INFO:task_ids: 96 tasks: 5 sided snowflake with a medium semicircle and a small semicircle as arms -- a 9 pointed star
2023-06-09 18:28:58,989 INFO:====================================
2023-06-09 18:28:58,990 INFO:Beginning enumeration on a total of 96 tasks with a total of 4 CPUs.
2023-06-09 18:29:13,109 INFO:Wrote experiments_iterative/outputs/test_runs/domains/logo/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/0/metrics.json
2023-06-09 18:29:13,109 INFO:====================================
2023-06-09 18:29:13,110 INFO:iteration: 0
2023-06-09 18:29:13,110 INFO:grammar : infer_programs_for_tasks
2023-06-09 18:29:13,110 INFO:Completed in 14.118s
2023-06-09 18:29:13,111 INFO:====================================
2023-06-09 18:29:13,111 INFO:============LOGGING FRONTIERS============
2023-06-09 18:29:13,112 INFO:	 total_solved_tasks_train @ iteration 0: 0 / 199
2023-06-09 18:29:13,112 INFO:	 total_solved_tasks_test @ iteration 0: 0 / 111
2023-06-09 18:29:13,113 INFO:====================================
2023-06-09 18:29:13,113 INFO:============LOGGING MODEL_FN============
2023-06-09 18:29:13,114 INFO:	iteration: 0
2023-06-09 18:29:13,114 INFO:	task_split: train
2023-06-09 18:29:13,114 INFO:	model_fn: optimize_model_for_frontiers
2023-06-09 18:29:13,115 INFO:	params: {'recognition_train_steps': 100}
2023-06-09 18:29:13,115 INFO:	model_type: amortized_synthesis
2023-06-09 18:29:13,115 INFO:	task_batch_size: all
2023-06-09 18:29:13,116 INFO:	experiment_block_type: model_fn
2023-06-09 18:29:13,116 INFO:task_ids: 200 tasks: 5 sided snowflake with a medium semicircle and a small semicircle as arms -- 6 sided snowflake with a short space and a short line and a short space and a medium semicircle as arms
2023-06-09 18:29:13,116 INFO:====================================
2023-06-09 18:29:13,145 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-09 18:29:13,145 INFO:Attempted frontier likelihood normalization. Initial frontiers: 0. Now: 0
2023-06-09 18:29:13,146 INFO:Sampling new helmholtz frontiers during training.
2023-06-09 18:29:57,691 INFO:We now have 224 Helmholtz entries.
2023-06-09 18:30:12,467 INFO:Wrote experiments_iterative/outputs/test_runs/domains/logo/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/0/metrics.json
2023-06-09 18:30:12,467 INFO:====================================
2023-06-09 18:30:12,467 INFO:iteration: 0
2023-06-09 18:30:12,467 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-09 18:30:12,467 INFO:Completed in 59.349s
2023-06-09 18:30:12,467 INFO:====================================
2023-06-09 18:30:12,467 INFO:============LOGGING MODEL_FN============
2023-06-09 18:30:12,467 INFO:	iteration: 0
2023-06-09 18:30:12,468 INFO:	task_split: train
2023-06-09 18:30:12,468 INFO:	model_fn: infer_programs_for_tasks
2023-06-09 18:30:12,468 INFO:	params: {'enumeration_timeout': 10}
2023-06-09 18:30:12,468 INFO:	model_type: amortized_synthesis
2023-06-09 18:30:12,468 INFO:	task_batch_size: global_batch_size
2023-06-09 18:30:12,468 INFO:	experiment_block_type: model_fn
2023-06-09 18:30:12,468 INFO:task_ids: 96 tasks: 5 sided snowflake with a medium semicircle and a small semicircle as arms -- a 9 pointed star
2023-06-09 18:30:12,468 INFO:====================================
2023-06-09 18:30:14,080 ERROR:Exception encountered while running experiment. See logs at: experiments_iterative/outputs/test_runs/domains/logo/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/run.log
Traceback (most recent call last):
  File "run_iterative_experiment.py", line 321, in main
    run_experiment(args, experiment_state, experiment_iterator)
  File "/home/ubuntu/lilo/run_experiment.py", line 81, in run_experiment
    experiment_iterator.next(experiment_state)
  File "/home/ubuntu/lilo/src/experiment_iterator.py", line 734, in next
    self.execute_model_fn(experiment_state, curr_loop_block)
  File "/home/ubuntu/lilo/src/experiment_iterator.py", line 791, in execute_model_fn
    self.execute_model_fn_single_split(experiment_state, curr_loop_block)
  File "/home/ubuntu/lilo/src/experiment_iterator.py", line 851, in execute_model_fn_single_split
    **curr_loop_block[PARAMS],
  File "/home/ubuntu/lilo/src/models/laps_dreamcoder_recognition.py", line 86, in infer_programs_for_tasks
    testing=task_split == TEST,
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 1738, in enumerateFrontiers
    grammars = {task: self.grammarOfTask(task) for task in tasks}
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 1738, in <dictcomp>
    grammars = {task: self.grammarOfTask(task) for task in tasks}
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 1006, in grammarOfTask
    features = self.encode_features(task)
  File "/home/ubuntu/lilo/dreamcoder/recognition.py", line 978, in encode_features
    example_features = self.featureExtractor.featuresOfTask(task)
  File "/home/ubuntu/lilo/dreamcoder/domains/logo/main.py", line 314, in featuresOfTask
    return self(t.highresolution)
  File "/opt/conda/envs/lilo/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/ubuntu/lilo/dreamcoder/domains/logo/main.py", line 310, in forward
    v = self.encoder(v)
  File "/opt/conda/envs/lilo/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/envs/lilo/lib/python3.7/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/opt/conda/envs/lilo/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/envs/lilo/lib/python3.7/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/opt/conda/envs/lilo/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/envs/lilo/lib/python3.7/site-packages/torch/nn/modules/activation.py", line 98, in forward
    return F.relu(input, inplace=self.inplace)
  File "/opt/conda/envs/lilo/lib/python3.7/site-packages/torch/nn/functional.py", line 1457, in relu
    result = torch.relu(input)
KeyboardInterrupt
