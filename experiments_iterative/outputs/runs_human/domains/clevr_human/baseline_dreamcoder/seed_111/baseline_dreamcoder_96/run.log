2023-06-11 13:49:20,255 INFO:============LOGGING METADATA============
2023-06-11 13:49:20,255 INFO:	iteration: 0
2023-06-11 13:49:20,255 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 13:49:20,255 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 13:49:20,256 INFO:	curr_iteration: 0
2023-06-11 13:49:20,256 INFO:	timestamp: 
2023-06-11 13:49:20,256 INFO:	export_with_timestamp: False
2023-06-11 13:49:20,256 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 13:49:20,256 INFO:	task_language_loader: clevr_human
2023-06-11 13:49:20,256 INFO:	ocaml_special_handler: clevr
2023-06-11 13:49:20,256 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 13:49:20,256 INFO:	resume_checkpoint_directory: None
2023-06-11 13:49:20,256 INFO:	random_seed: 111
2023-06-11 13:49:20,256 INFO:	global_batch_size: 96
2023-06-11 13:49:20,256 INFO:	random_generator: Generator(PCG64)
2023-06-11 13:49:20,256 INFO:	tasks_loader: clevr
2023-06-11 13:49:20,256 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 13:49:20,256 INFO:	enumeration_timeout: 1000
2023-06-11 13:49:20,256 INFO:	experiment_name: runs_human
2023-06-11 13:49:20,256 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 13:49:20,256 INFO:	encoder: clevr
2023-06-11 13:49:20,256 INFO:	init_frontiers_every_iteration: False
2023-06-11 13:49:20,256 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 13:49:20,256 INFO:	recognition_train_steps: None
2023-06-11 13:49:20,256 INFO:	init_grammar_from_checkpoint: False
2023-06-11 13:49:20,256 INFO:====================================
2023-06-11 13:49:20,256 INFO:============LOGGING FRONTIERS============
2023-06-11 13:49:20,256 INFO:	 total_solved_tasks_train @ iteration 0: 0 / 191
2023-06-11 13:49:20,256 INFO:	 total_solved_tasks_test @ iteration 0: 0 / 103
2023-06-11 13:49:20,256 INFO:====================================
2023-06-11 13:49:20,256 INFO:============LOGGING MODEL_FN============
2023-06-11 13:49:20,257 INFO:	iteration: 0
2023-06-11 13:49:20,257 INFO:	task_split: train
2023-06-11 13:49:20,257 INFO:	task_batch_size: global_batch_size
2023-06-11 13:49:20,257 INFO:	params: {'enumeration_timeout': 1000, 'compute_likelihoods': True}
2023-06-11 13:49:20,257 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 13:49:20,257 INFO:	run_every_n_iterations: 1000
2023-06-11 13:49:20,257 INFO:	model_type: grammar
2023-06-11 13:49:20,257 INFO:	experiment_block_type: model_fn
2023-06-11 13:49:20,257 INFO:task_ids: 96 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 17-1_single_or-How many metal objects are either green things or large things?
2023-06-11 13:49:20,257 INFO:====================================
2023-06-11 13:49:20,257 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 14:06:01,436 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/0/metrics.json
2023-06-11 14:06:01,436 INFO:====================================
2023-06-11 14:06:01,436 INFO:iteration: 0
2023-06-11 14:06:01,436 INFO:grammar : infer_programs_for_tasks
2023-06-11 14:06:01,436 INFO:Completed in 1001.178s
2023-06-11 14:06:01,436 INFO:====================================
2023-06-11 14:06:01,436 INFO:============LOGGING FRONTIERS============
2023-06-11 14:06:01,437 INFO:	 total_solved_tasks_train @ iteration 0: 26 / 191
2023-06-11 14:06:01,437 INFO:	 total_solved_tasks_test @ iteration 0: 0 / 103
2023-06-11 14:06:01,437 INFO:====================================
2023-06-11 14:06:01,437 INFO:============LOGGING MODEL_FN============
2023-06-11 14:06:01,437 INFO:	iteration: 0
2023-06-11 14:06:01,437 INFO:	task_split: train
2023-06-11 14:06:01,437 INFO:	task_batch_size: all
2023-06-11 14:06:01,437 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 14:06:01,437 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 14:06:01,437 INFO:	model_type: amortized_synthesis
2023-06-11 14:06:01,437 INFO:	experiment_block_type: model_fn
2023-06-11 14:06:01,437 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 14:06:01,437 INFO:====================================
2023-06-11 14:06:03,308 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 14:06:03,793 INFO:Attempted frontier likelihood normalization. Initial frontiers: 26. Now: 26
2023-06-11 14:06:03,793 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:06:04,754 INFO:We now have 88 Helmholtz entries.
2023-06-11 14:06:23,705 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:06:24,534 INFO:We now have 82 Helmholtz entries.
2023-06-11 14:06:31,781 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:06:32,813 INFO:We now have 97 Helmholtz entries.
2023-06-11 14:06:43,261 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:06:44,261 INFO:We now have 105 Helmholtz entries.
2023-06-11 14:06:56,437 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:06:57,394 INFO:We now have 100 Helmholtz entries.
2023-06-11 14:07:09,187 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:07:10,267 INFO:We now have 97 Helmholtz entries.
2023-06-11 14:07:20,103 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:07:21,136 INFO:We now have 84 Helmholtz entries.
2023-06-11 14:07:30,273 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:07:31,300 INFO:We now have 93 Helmholtz entries.
2023-06-11 14:07:41,494 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:07:42,369 INFO:We now have 86 Helmholtz entries.
2023-06-11 14:07:50,555 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:07:51,641 INFO:We now have 104 Helmholtz entries.
2023-06-11 14:08:03,891 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:08:04,820 INFO:We now have 89 Helmholtz entries.
2023-06-11 14:08:14,409 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:08:15,416 INFO:We now have 95 Helmholtz entries.
2023-06-11 14:08:26,473 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:08:27,312 INFO:We now have 92 Helmholtz entries.
2023-06-11 14:08:36,984 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:08:37,954 INFO:We now have 91 Helmholtz entries.
2023-06-11 14:08:47,496 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:08:48,442 INFO:We now have 81 Helmholtz entries.
2023-06-11 14:08:56,992 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:08:57,952 INFO:We now have 99 Helmholtz entries.
2023-06-11 14:09:07,059 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:09:08,074 INFO:We now have 78 Helmholtz entries.
2023-06-11 14:09:16,028 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:09:16,992 INFO:We now have 101 Helmholtz entries.
2023-06-11 14:09:26,310 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:09:27,300 INFO:We now have 93 Helmholtz entries.
2023-06-11 14:09:36,876 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:09:37,800 INFO:We now have 104 Helmholtz entries.
2023-06-11 14:09:50,157 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:09:51,149 INFO:We now have 78 Helmholtz entries.
2023-06-11 14:09:57,839 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:09:58,866 INFO:We now have 107 Helmholtz entries.
2023-06-11 14:10:08,647 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:10:09,686 INFO:We now have 91 Helmholtz entries.
2023-06-11 14:10:19,333 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:10:20,359 INFO:We now have 96 Helmholtz entries.
2023-06-11 14:10:29,094 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:10:30,047 INFO:We now have 89 Helmholtz entries.
2023-06-11 14:10:38,271 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:10:39,241 INFO:We now have 94 Helmholtz entries.
2023-06-11 14:10:49,265 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:10:50,266 INFO:We now have 96 Helmholtz entries.
2023-06-11 14:11:01,856 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:11:02,791 INFO:We now have 79 Helmholtz entries.
2023-06-11 14:11:09,835 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:11:10,890 INFO:We now have 80 Helmholtz entries.
2023-06-11 14:11:17,881 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:11:18,751 INFO:We now have 92 Helmholtz entries.
2023-06-11 14:11:26,422 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:11:27,369 INFO:We now have 92 Helmholtz entries.
2023-06-11 14:11:37,181 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:11:38,074 INFO:We now have 89 Helmholtz entries.
2023-06-11 14:11:49,021 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:11:50,097 INFO:We now have 114 Helmholtz entries.
2023-06-11 14:12:00,525 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:12:01,479 INFO:We now have 92 Helmholtz entries.
2023-06-11 14:12:11,566 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:12:12,585 INFO:We now have 114 Helmholtz entries.
2023-06-11 14:12:26,327 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:12:27,286 INFO:We now have 91 Helmholtz entries.
2023-06-11 14:12:38,295 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:12:39,251 INFO:We now have 95 Helmholtz entries.
2023-06-11 14:12:50,848 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:12:51,829 INFO:We now have 104 Helmholtz entries.
2023-06-11 14:13:02,013 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:13:02,896 INFO:We now have 82 Helmholtz entries.
2023-06-11 14:13:11,208 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:13:12,226 INFO:We now have 106 Helmholtz entries.
2023-06-11 14:13:23,115 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:13:24,200 INFO:We now have 98 Helmholtz entries.
2023-06-11 14:13:36,277 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:13:37,223 INFO:We now have 101 Helmholtz entries.
2023-06-11 14:13:48,657 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:13:49,636 INFO:We now have 77 Helmholtz entries.
2023-06-11 14:13:58,304 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:13:59,338 INFO:We now have 96 Helmholtz entries.
2023-06-11 14:14:08,224 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:14:09,217 INFO:We now have 95 Helmholtz entries.
2023-06-11 14:14:18,459 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:14:19,497 INFO:We now have 115 Helmholtz entries.
2023-06-11 14:14:31,602 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:14:32,696 INFO:We now have 87 Helmholtz entries.
2023-06-11 14:14:41,487 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:14:42,488 INFO:We now have 100 Helmholtz entries.
2023-06-11 14:14:53,588 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:14:54,555 INFO:We now have 87 Helmholtz entries.
2023-06-11 14:15:05,407 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:15:06,437 INFO:We now have 96 Helmholtz entries.
2023-06-11 14:15:16,291 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:15:17,257 INFO:We now have 100 Helmholtz entries.
2023-06-11 14:15:28,487 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:15:29,408 INFO:We now have 75 Helmholtz entries.
2023-06-11 14:15:36,892 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:15:37,851 INFO:We now have 89 Helmholtz entries.
2023-06-11 14:15:47,341 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/0/metrics.json
2023-06-11 14:15:47,341 INFO:====================================
2023-06-11 14:15:47,341 INFO:iteration: 0
2023-06-11 14:15:47,341 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 14:15:47,341 INFO:Completed in 585.903s
2023-06-11 14:15:47,341 INFO:====================================
2023-06-11 14:15:47,341 INFO:============LOGGING MODEL_FN============
2023-06-11 14:15:47,341 INFO:	iteration: 0
2023-06-11 14:15:47,341 INFO:	task_split: train
2023-06-11 14:15:47,341 INFO:	task_batch_size: global_batch_size
2023-06-11 14:15:47,341 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 14:15:47,341 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 14:15:47,341 INFO:	model_type: amortized_synthesis
2023-06-11 14:15:47,341 INFO:	experiment_block_type: model_fn
2023-06-11 14:15:47,341 INFO:task_ids: 96 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 17-1_single_or-How many metal objects are either green things or large things?
2023-06-11 14:15:47,341 INFO:====================================
2023-06-11 14:15:54,726 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 14:32:38,491 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/0/metrics.json
2023-06-11 14:32:38,491 INFO:====================================
2023-06-11 14:32:38,491 INFO:iteration: 0
2023-06-11 14:32:38,491 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 14:32:38,491 INFO:Completed in 1011.148s
2023-06-11 14:32:38,491 INFO:====================================
2023-06-11 14:32:38,491 INFO:============LOGGING FRONTIERS============
2023-06-11 14:32:38,491 INFO:	 total_solved_tasks_train @ iteration 0: 47 / 191
2023-06-11 14:32:38,491 INFO:	 total_solved_tasks_test @ iteration 0: 0 / 103
2023-06-11 14:32:38,491 INFO:====================================
2023-06-11 14:32:38,492 INFO:reset_task_frontiers for split: test
2023-06-11 14:32:38,492 INFO:============LOGGING MODEL_FN============
2023-06-11 14:32:38,492 INFO:	iteration: 0
2023-06-11 14:32:38,492 INFO:	task_split: test
2023-06-11 14:32:38,492 INFO:	task_batch_size: all
2023-06-11 14:32:38,492 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 14:32:38,492 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 14:32:38,492 INFO:	run_every_n_iterations: 3
2023-06-11 14:32:38,492 INFO:	model_type: amortized_synthesis
2023-06-11 14:32:38,492 INFO:	experiment_block_type: model_fn
2023-06-11 14:32:38,492 INFO:task_ids: 103 tasks: 0-1_compare_integer-Are there fewer small spheres than cyan cubes? -- 9-2_transform-If all of the large yellow cubes became small, how many large things would there be?
2023-06-11 14:32:38,492 INFO:====================================
2023-06-11 14:32:46,332 INFO:Beginning enumeration on a total of 103 tasks with a total of 96 CPUs.
2023-06-11 14:49:34,404 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/0/metrics.json
2023-06-11 14:49:34,405 INFO:====================================
2023-06-11 14:49:34,405 INFO:iteration: 0
2023-06-11 14:49:34,405 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 14:49:34,405 INFO:Completed in 1015.912s
2023-06-11 14:49:34,405 INFO:====================================
2023-06-11 14:49:34,405 INFO:============LOGGING FRONTIERS============
2023-06-11 14:49:34,406 INFO:	 total_solved_tasks_train @ iteration 0: 47 / 191
2023-06-11 14:49:34,406 INFO:	 total_solved_tasks_test @ iteration 0: 41 / 103
2023-06-11 14:49:34,406 INFO:====================================
2023-06-11 14:49:34,406 INFO:============LOGGING MODEL_FN============
2023-06-11 14:49:34,406 INFO:	iteration: 0
2023-06-11 14:49:34,406 INFO:	params: {'compute_likelihoods': True, 'compute_description_lengths': True, 'save_filename': 'test_likelihoods.json'}
2023-06-11 14:49:34,406 INFO:	model_fn: evaluate_frontiers
2023-06-11 14:49:34,406 INFO:	run_every_n_iterations: 3
2023-06-11 14:49:34,406 INFO:	model_type: grammar
2023-06-11 14:49:34,406 INFO:	experiment_block_type: model_fn
2023-06-11 14:49:34,406 INFO:	task_batch_sizes: ['all']
2023-06-11 14:49:34,406 INFO:	task_splits: ['test']
2023-06-11 14:49:34,406 INFO:task_ids test: 103 tasks: 0-1_compare_integer-Are there fewer small spheres than cyan cubes? -- 9-2_transform-If all of the large yellow cubes became small, how many large things would there be?
2023-06-11 14:49:34,406 INFO:====================================
2023-06-11 14:49:34,674 INFO:EVALUATION: evaluate_frontiers : mean log likelihood of 41 programs in splits: ['test'] is: -27.478107424726335
2023-06-11 14:49:34,674 INFO:EVALUATION: evaluate_frontiers : mean description length of 41 programs in splits: ['test'] is: 13.71219512195122
2023-06-11 14:49:34,708 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/0/frontiers.json===========
2023-06-11 14:49:34,709 INFO:============LOGGING MODEL_FN============
2023-06-11 14:49:34,709 INFO:	iteration: 0
2023-06-11 14:49:34,709 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 14:49:34,709 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 14:49:34,709 INFO:	model_type: library_learner
2023-06-11 14:49:34,709 INFO:	experiment_block_type: model_fn
2023-06-11 14:49:34,709 INFO:	task_batch_sizes: ['all']
2023-06-11 14:49:34,709 INFO:	task_splits: ['train']
2023-06-11 14:49:34,709 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 14:49:34,709 INFO:====================================
2023-06-11 14:49:38,543 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 14:49:38,850 INFO:reset_task_frontiers for split: train
2023-06-11 14:49:38,857 INFO:reset_samples for split: train
2023-06-11 14:49:38,857 INFO:============Syncing to AWS S3===========
2023-06-11 14:49:38,857 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 14:49:39,430 INFO:============LOGGING METADATA============
2023-06-11 14:49:39,430 INFO:	iteration: 1
2023-06-11 14:49:39,430 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 14:49:39,430 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 14:49:39,430 INFO:	curr_iteration: 0
2023-06-11 14:49:39,430 INFO:	timestamp: 
2023-06-11 14:49:39,430 INFO:	export_with_timestamp: False
2023-06-11 14:49:39,430 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 14:49:39,430 INFO:	task_language_loader: clevr_human
2023-06-11 14:49:39,430 INFO:	ocaml_special_handler: clevr
2023-06-11 14:49:39,430 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 14:49:39,430 INFO:	resume_checkpoint_directory: None
2023-06-11 14:49:39,430 INFO:	random_seed: 111
2023-06-11 14:49:39,430 INFO:	global_batch_size: 96
2023-06-11 14:49:39,430 INFO:	random_generator: Generator(PCG64)
2023-06-11 14:49:39,430 INFO:	tasks_loader: clevr
2023-06-11 14:49:39,430 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 14:49:39,430 INFO:	enumeration_timeout: 1000
2023-06-11 14:49:39,430 INFO:	experiment_name: runs_human
2023-06-11 14:49:39,430 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 14:49:39,430 INFO:	encoder: clevr
2023-06-11 14:49:39,430 INFO:	init_frontiers_every_iteration: False
2023-06-11 14:49:39,431 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 14:49:39,431 INFO:	recognition_train_steps: None
2023-06-11 14:49:39,431 INFO:	init_grammar_from_checkpoint: False
2023-06-11 14:49:39,431 INFO:====================================
2023-06-11 14:49:39,431 INFO:============LOGGING FRONTIERS============
2023-06-11 14:49:39,431 INFO:	 total_solved_tasks_train @ iteration 1: 47 / 191
2023-06-11 14:49:39,432 INFO:	 total_solved_tasks_test @ iteration 1: 41 / 103
2023-06-11 14:49:39,432 INFO:====================================
2023-06-11 14:49:39,432 INFO:============LOGGING MODEL_FN============
2023-06-11 14:49:39,432 INFO:	iteration: 1
2023-06-11 14:49:39,432 INFO:	task_split: train
2023-06-11 14:49:39,432 INFO:	task_batch_size: all
2023-06-11 14:49:39,432 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 14:49:39,432 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 14:49:39,432 INFO:	model_type: amortized_synthesis
2023-06-11 14:49:39,433 INFO:	experiment_block_type: model_fn
2023-06-11 14:49:39,433 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 14:49:39,433 INFO:====================================
2023-06-11 14:49:39,461 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 14:49:40,893 INFO:Attempted frontier likelihood normalization. Initial frontiers: 47. Now: 47
2023-06-11 14:49:40,893 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:49:41,631 INFO:We now have 199 Helmholtz entries.
2023-06-11 14:50:04,738 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:50:05,469 INFO:We now have 205 Helmholtz entries.
2023-06-11 14:50:32,819 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:50:33,549 INFO:We now have 194 Helmholtz entries.
2023-06-11 14:50:55,541 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:50:56,542 INFO:We now have 214 Helmholtz entries.
2023-06-11 14:51:23,358 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:51:24,459 INFO:We now have 221 Helmholtz entries.
2023-06-11 14:51:51,261 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:51:52,242 INFO:We now have 196 Helmholtz entries.
2023-06-11 14:52:17,479 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:52:18,389 INFO:We now have 208 Helmholtz entries.
2023-06-11 14:52:42,537 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:52:43,363 INFO:We now have 219 Helmholtz entries.
2023-06-11 14:53:11,722 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:53:12,542 INFO:We now have 223 Helmholtz entries.
2023-06-11 14:53:40,113 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:53:40,975 INFO:We now have 196 Helmholtz entries.
2023-06-11 14:54:04,285 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:54:05,111 INFO:We now have 218 Helmholtz entries.
2023-06-11 14:54:31,014 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:54:31,922 INFO:We now have 215 Helmholtz entries.
2023-06-11 14:55:00,700 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:55:01,500 INFO:We now have 198 Helmholtz entries.
2023-06-11 14:55:24,919 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:55:25,757 INFO:We now have 236 Helmholtz entries.
2023-06-11 14:55:54,818 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:55:55,622 INFO:We now have 214 Helmholtz entries.
2023-06-11 14:56:23,437 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:56:24,282 INFO:We now have 217 Helmholtz entries.
2023-06-11 14:56:49,287 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:56:50,109 INFO:We now have 199 Helmholtz entries.
2023-06-11 14:57:15,880 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:57:16,666 INFO:We now have 197 Helmholtz entries.
2023-06-11 14:57:41,658 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:57:42,518 INFO:We now have 224 Helmholtz entries.
2023-06-11 14:58:11,050 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:58:11,948 INFO:We now have 189 Helmholtz entries.
2023-06-11 14:58:35,645 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:58:36,490 INFO:We now have 217 Helmholtz entries.
2023-06-11 14:59:04,805 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:59:05,518 INFO:We now have 192 Helmholtz entries.
2023-06-11 14:59:28,362 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:59:29,235 INFO:We now have 203 Helmholtz entries.
2023-06-11 14:59:54,469 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 14:59:55,340 INFO:We now have 209 Helmholtz entries.
2023-06-11 15:00:20,152 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:00:20,942 INFO:We now have 196 Helmholtz entries.
2023-06-11 15:00:28,742 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/1/metrics.json
2023-06-11 15:00:28,742 INFO:====================================
2023-06-11 15:00:28,742 INFO:iteration: 1
2023-06-11 15:00:28,742 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 15:00:28,742 INFO:Completed in 649.309s
2023-06-11 15:00:28,742 INFO:====================================
2023-06-11 15:00:28,742 INFO:============LOGGING MODEL_FN============
2023-06-11 15:00:28,742 INFO:	iteration: 1
2023-06-11 15:00:28,742 INFO:	task_split: train
2023-06-11 15:00:28,742 INFO:	task_batch_size: global_batch_size
2023-06-11 15:00:28,742 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 15:00:28,742 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 15:00:28,742 INFO:	model_type: amortized_synthesis
2023-06-11 15:00:28,742 INFO:	experiment_block_type: model_fn
2023-06-11 15:00:28,742 INFO:task_ids: 96 tasks: 9-1_one_hop-There is a cube front the gray rubber thing; how big is it? -- 5-2_transform-What if all the blue metal things became rubber things?
2023-06-11 15:00:28,742 INFO:====================================
2023-06-11 15:00:50,938 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 15:17:36,635 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/1/metrics.json
2023-06-11 15:17:36,635 INFO:====================================
2023-06-11 15:17:36,635 INFO:iteration: 1
2023-06-11 15:17:36,635 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 15:17:36,635 INFO:Completed in 1027.892s
2023-06-11 15:17:36,635 INFO:====================================
2023-06-11 15:17:36,635 INFO:============LOGGING FRONTIERS============
2023-06-11 15:17:36,636 INFO:	 total_solved_tasks_train @ iteration 1: 111 / 191
2023-06-11 15:17:36,636 INFO:	 total_solved_tasks_test @ iteration 1: 41 / 103
2023-06-11 15:17:36,636 INFO:====================================
2023-06-11 15:17:36,678 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/1/frontiers.json===========
2023-06-11 15:17:36,679 INFO:============LOGGING MODEL_FN============
2023-06-11 15:17:36,679 INFO:	iteration: 1
2023-06-11 15:17:36,679 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 15:17:36,679 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 15:17:36,679 INFO:	model_type: library_learner
2023-06-11 15:17:36,679 INFO:	experiment_block_type: model_fn
2023-06-11 15:17:36,679 INFO:	task_batch_sizes: ['all']
2023-06-11 15:17:36,679 INFO:	task_splits: ['train']
2023-06-11 15:17:36,680 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 15:17:36,680 INFO:====================================
2023-06-11 15:17:54,223 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 15:17:54,907 INFO:reset_task_frontiers for split: train
2023-06-11 15:17:54,930 INFO:reset_samples for split: train
2023-06-11 15:17:54,930 INFO:============Syncing to AWS S3===========
2023-06-11 15:17:54,930 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 15:17:55,543 INFO:============LOGGING METADATA============
2023-06-11 15:17:55,544 INFO:	iteration: 2
2023-06-11 15:17:55,544 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 15:17:55,544 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 15:17:55,544 INFO:	curr_iteration: 0
2023-06-11 15:17:55,544 INFO:	timestamp: 
2023-06-11 15:17:55,544 INFO:	export_with_timestamp: False
2023-06-11 15:17:55,544 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 15:17:55,544 INFO:	task_language_loader: clevr_human
2023-06-11 15:17:55,544 INFO:	ocaml_special_handler: clevr
2023-06-11 15:17:55,544 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 15:17:55,544 INFO:	resume_checkpoint_directory: None
2023-06-11 15:17:55,544 INFO:	random_seed: 111
2023-06-11 15:17:55,544 INFO:	global_batch_size: 96
2023-06-11 15:17:55,544 INFO:	random_generator: Generator(PCG64)
2023-06-11 15:17:55,544 INFO:	tasks_loader: clevr
2023-06-11 15:17:55,544 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 15:17:55,544 INFO:	enumeration_timeout: 1000
2023-06-11 15:17:55,544 INFO:	experiment_name: runs_human
2023-06-11 15:17:55,544 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 15:17:55,544 INFO:	encoder: clevr
2023-06-11 15:17:55,544 INFO:	init_frontiers_every_iteration: False
2023-06-11 15:17:55,544 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 15:17:55,544 INFO:	recognition_train_steps: None
2023-06-11 15:17:55,544 INFO:	init_grammar_from_checkpoint: False
2023-06-11 15:17:55,544 INFO:====================================
2023-06-11 15:17:55,544 INFO:============LOGGING FRONTIERS============
2023-06-11 15:17:55,545 INFO:	 total_solved_tasks_train @ iteration 2: 111 / 191
2023-06-11 15:17:55,546 INFO:	 total_solved_tasks_test @ iteration 2: 41 / 103
2023-06-11 15:17:55,546 INFO:====================================
2023-06-11 15:17:55,546 INFO:============LOGGING MODEL_FN============
2023-06-11 15:17:55,546 INFO:	iteration: 2
2023-06-11 15:17:55,546 INFO:	task_split: train
2023-06-11 15:17:55,546 INFO:	task_batch_size: all
2023-06-11 15:17:55,546 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 15:17:55,546 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 15:17:55,546 INFO:	model_type: amortized_synthesis
2023-06-11 15:17:55,546 INFO:	experiment_block_type: model_fn
2023-06-11 15:17:55,546 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 15:17:55,546 INFO:====================================
2023-06-11 15:17:55,581 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 15:17:58,760 INFO:Attempted frontier likelihood normalization. Initial frontiers: 111. Now: 111
2023-06-11 15:17:58,760 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:17:59,452 INFO:We now have 253 Helmholtz entries.
2023-06-11 15:18:28,656 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:18:29,401 INFO:We now have 243 Helmholtz entries.
2023-06-11 15:19:01,101 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:19:01,738 INFO:We now have 223 Helmholtz entries.
2023-06-11 15:19:30,236 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:19:31,006 INFO:We now have 234 Helmholtz entries.
2023-06-11 15:20:03,659 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:20:04,440 INFO:We now have 250 Helmholtz entries.
2023-06-11 15:20:35,982 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:20:36,682 INFO:We now have 241 Helmholtz entries.
2023-06-11 15:21:08,291 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:21:08,936 INFO:We now have 233 Helmholtz entries.
2023-06-11 15:21:37,420 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:21:38,176 INFO:We now have 256 Helmholtz entries.
2023-06-11 15:22:08,117 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:22:08,951 INFO:We now have 250 Helmholtz entries.
2023-06-11 15:22:41,463 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:22:42,152 INFO:We now have 236 Helmholtz entries.
2023-06-11 15:23:10,681 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:23:11,517 INFO:We now have 264 Helmholtz entries.
2023-06-11 15:23:47,251 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:23:48,042 INFO:We now have 233 Helmholtz entries.
2023-06-11 15:24:19,419 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:24:20,143 INFO:We now have 233 Helmholtz entries.
2023-06-11 15:24:50,737 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:24:51,496 INFO:We now have 230 Helmholtz entries.
2023-06-11 15:25:21,922 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:25:22,657 INFO:We now have 237 Helmholtz entries.
2023-06-11 15:25:54,161 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:25:54,852 INFO:We now have 234 Helmholtz entries.
2023-06-11 15:26:24,435 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:26:25,184 INFO:We now have 244 Helmholtz entries.
2023-06-11 15:26:55,493 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:26:56,200 INFO:We now have 232 Helmholtz entries.
2023-06-11 15:27:25,461 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:27:26,089 INFO:We now have 224 Helmholtz entries.
2023-06-11 15:27:55,262 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:27:56,032 INFO:We now have 228 Helmholtz entries.
2023-06-11 15:28:27,275 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:28:28,089 INFO:We now have 243 Helmholtz entries.
2023-06-11 15:28:52,015 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/2/metrics.json
2023-06-11 15:28:52,015 INFO:====================================
2023-06-11 15:28:52,015 INFO:iteration: 2
2023-06-11 15:28:52,015 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 15:28:52,015 INFO:Completed in 656.469s
2023-06-11 15:28:52,015 INFO:====================================
2023-06-11 15:28:52,016 INFO:============LOGGING MODEL_FN============
2023-06-11 15:28:52,016 INFO:	iteration: 2
2023-06-11 15:28:52,016 INFO:	task_split: train
2023-06-11 15:28:52,016 INFO:	task_batch_size: global_batch_size
2023-06-11 15:28:52,016 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 15:28:52,016 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 15:28:52,016 INFO:	model_type: amortized_synthesis
2023-06-11 15:28:52,016 INFO:	experiment_block_type: model_fn
2023-06-11 15:28:52,016 INFO:task_ids: 96 tasks: 9-2_remove-If you removed the brown things, how many cylinders would be left? -- 9-1_one_hop-There is a cube front the gray rubber thing; how big is it?
2023-06-11 15:28:52,016 INFO:====================================
2023-06-11 15:29:14,489 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 15:45:59,712 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/2/metrics.json
2023-06-11 15:45:59,712 INFO:====================================
2023-06-11 15:45:59,712 INFO:iteration: 2
2023-06-11 15:45:59,712 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 15:45:59,712 INFO:Completed in 1027.695s
2023-06-11 15:45:59,712 INFO:====================================
2023-06-11 15:45:59,712 INFO:============LOGGING FRONTIERS============
2023-06-11 15:45:59,713 INFO:	 total_solved_tasks_train @ iteration 2: 139 / 191
2023-06-11 15:45:59,713 INFO:	 total_solved_tasks_test @ iteration 2: 41 / 103
2023-06-11 15:45:59,713 INFO:====================================
2023-06-11 15:45:59,762 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/2/frontiers.json===========
2023-06-11 15:45:59,763 INFO:============LOGGING MODEL_FN============
2023-06-11 15:45:59,763 INFO:	iteration: 2
2023-06-11 15:45:59,763 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 15:45:59,763 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 15:45:59,763 INFO:	model_type: library_learner
2023-06-11 15:45:59,763 INFO:	experiment_block_type: model_fn
2023-06-11 15:45:59,763 INFO:	task_batch_sizes: ['all']
2023-06-11 15:45:59,763 INFO:	task_splits: ['train']
2023-06-11 15:45:59,763 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 15:45:59,763 INFO:====================================
2023-06-11 15:46:26,927 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 15:46:27,818 INFO:reset_task_frontiers for split: train
2023-06-11 15:46:27,849 INFO:reset_samples for split: train
2023-06-11 15:46:27,850 INFO:============Syncing to AWS S3===========
2023-06-11 15:46:27,850 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 15:46:28,441 INFO:============LOGGING METADATA============
2023-06-11 15:46:28,441 INFO:	iteration: 3
2023-06-11 15:46:28,441 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 15:46:28,441 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 15:46:28,441 INFO:	curr_iteration: 0
2023-06-11 15:46:28,441 INFO:	timestamp: 
2023-06-11 15:46:28,441 INFO:	export_with_timestamp: False
2023-06-11 15:46:28,441 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 15:46:28,441 INFO:	task_language_loader: clevr_human
2023-06-11 15:46:28,441 INFO:	ocaml_special_handler: clevr
2023-06-11 15:46:28,442 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 15:46:28,442 INFO:	resume_checkpoint_directory: None
2023-06-11 15:46:28,442 INFO:	random_seed: 111
2023-06-11 15:46:28,442 INFO:	global_batch_size: 96
2023-06-11 15:46:28,442 INFO:	random_generator: Generator(PCG64)
2023-06-11 15:46:28,442 INFO:	tasks_loader: clevr
2023-06-11 15:46:28,442 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 15:46:28,442 INFO:	enumeration_timeout: 1000
2023-06-11 15:46:28,442 INFO:	experiment_name: runs_human
2023-06-11 15:46:28,442 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 15:46:28,442 INFO:	encoder: clevr
2023-06-11 15:46:28,442 INFO:	init_frontiers_every_iteration: False
2023-06-11 15:46:28,442 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 15:46:28,442 INFO:	recognition_train_steps: None
2023-06-11 15:46:28,442 INFO:	init_grammar_from_checkpoint: False
2023-06-11 15:46:28,442 INFO:====================================
2023-06-11 15:46:28,442 INFO:============LOGGING FRONTIERS============
2023-06-11 15:46:28,443 INFO:	 total_solved_tasks_train @ iteration 3: 139 / 191
2023-06-11 15:46:28,444 INFO:	 total_solved_tasks_test @ iteration 3: 41 / 103
2023-06-11 15:46:28,444 INFO:====================================
2023-06-11 15:46:28,444 INFO:============LOGGING MODEL_FN============
2023-06-11 15:46:28,444 INFO:	iteration: 3
2023-06-11 15:46:28,444 INFO:	task_split: train
2023-06-11 15:46:28,444 INFO:	task_batch_size: all
2023-06-11 15:46:28,444 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 15:46:28,444 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 15:46:28,444 INFO:	model_type: amortized_synthesis
2023-06-11 15:46:28,444 INFO:	experiment_block_type: model_fn
2023-06-11 15:46:28,444 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 15:46:28,444 INFO:====================================
2023-06-11 15:46:28,485 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 15:46:32,590 INFO:Attempted frontier likelihood normalization. Initial frontiers: 139. Now: 139
2023-06-11 15:46:32,768 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:46:33,587 INFO:We now have 266 Helmholtz entries.
2023-06-11 15:47:05,305 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:47:06,147 INFO:We now have 268 Helmholtz entries.
2023-06-11 15:47:39,021 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:47:39,773 INFO:We now have 256 Helmholtz entries.
2023-06-11 15:48:09,868 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:48:10,706 INFO:We now have 267 Helmholtz entries.
2023-06-11 15:48:42,272 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:48:43,016 INFO:We now have 249 Helmholtz entries.
2023-06-11 15:49:15,949 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:49:16,711 INFO:We now have 237 Helmholtz entries.
2023-06-11 15:49:45,332 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:49:46,165 INFO:We now have 269 Helmholtz entries.
2023-06-11 15:50:21,101 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:50:21,937 INFO:We now have 260 Helmholtz entries.
2023-06-11 15:50:51,549 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:50:52,323 INFO:We now have 268 Helmholtz entries.
2023-06-11 15:51:28,548 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:51:29,426 INFO:We now have 259 Helmholtz entries.
2023-06-11 15:52:02,450 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:52:03,205 INFO:We now have 247 Helmholtz entries.
2023-06-11 15:52:35,145 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:52:35,989 INFO:We now have 251 Helmholtz entries.
2023-06-11 15:53:06,861 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:53:07,706 INFO:We now have 263 Helmholtz entries.
2023-06-11 15:53:42,201 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:53:43,068 INFO:We now have 262 Helmholtz entries.
2023-06-11 15:54:16,182 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:54:17,028 INFO:We now have 243 Helmholtz entries.
2023-06-11 15:54:48,935 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:54:49,823 INFO:We now have 267 Helmholtz entries.
2023-06-11 15:55:22,661 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:55:23,406 INFO:We now have 255 Helmholtz entries.
2023-06-11 15:55:56,609 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:55:57,484 INFO:We now have 246 Helmholtz entries.
2023-06-11 15:56:25,644 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:56:26,493 INFO:We now have 251 Helmholtz entries.
2023-06-11 15:56:53,702 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 15:56:54,609 INFO:We now have 259 Helmholtz entries.
2023-06-11 15:57:16,520 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/3/metrics.json
2023-06-11 15:57:16,520 INFO:====================================
2023-06-11 15:57:16,520 INFO:iteration: 3
2023-06-11 15:57:16,520 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 15:57:16,520 INFO:Completed in 648.075s
2023-06-11 15:57:16,520 INFO:====================================
2023-06-11 15:57:16,520 INFO:============LOGGING MODEL_FN============
2023-06-11 15:57:16,520 INFO:	iteration: 3
2023-06-11 15:57:16,520 INFO:	task_split: train
2023-06-11 15:57:16,520 INFO:	task_batch_size: global_batch_size
2023-06-11 15:57:16,520 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 15:57:16,520 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 15:57:16,520 INFO:	model_type: amortized_synthesis
2023-06-11 15:57:16,520 INFO:	experiment_block_type: model_fn
2023-06-11 15:57:16,520 INFO:task_ids: 96 tasks: 13-1_zero_hop-What material is the gray thing? -- 9-2_remove-If you removed the brown things, how many cylinders would be left?
2023-06-11 15:57:16,521 INFO:====================================
2023-06-11 15:57:38,511 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 16:14:23,887 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/3/metrics.json
2023-06-11 16:14:23,888 INFO:====================================
2023-06-11 16:14:23,888 INFO:iteration: 3
2023-06-11 16:14:23,888 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 16:14:23,888 INFO:Completed in 1027.366s
2023-06-11 16:14:23,888 INFO:====================================
2023-06-11 16:14:23,888 INFO:============LOGGING FRONTIERS============
2023-06-11 16:14:23,888 INFO:	 total_solved_tasks_train @ iteration 3: 159 / 191
2023-06-11 16:14:23,889 INFO:	 total_solved_tasks_test @ iteration 3: 41 / 103
2023-06-11 16:14:23,889 INFO:====================================
2023-06-11 16:14:23,893 INFO:reset_task_frontiers for split: test
2023-06-11 16:14:23,893 INFO:============LOGGING MODEL_FN============
2023-06-11 16:14:23,893 INFO:	iteration: 3
2023-06-11 16:14:23,893 INFO:	task_split: test
2023-06-11 16:14:23,893 INFO:	task_batch_size: all
2023-06-11 16:14:23,893 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 16:14:23,893 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 16:14:23,893 INFO:	run_every_n_iterations: 3
2023-06-11 16:14:23,893 INFO:	model_type: amortized_synthesis
2023-06-11 16:14:23,893 INFO:	experiment_block_type: model_fn
2023-06-11 16:14:23,893 INFO:task_ids: 103 tasks: 0-1_compare_integer-Are there fewer small spheres than cyan cubes? -- 9-2_transform-If all of the large yellow cubes became small, how many large things would there be?
2023-06-11 16:14:23,893 INFO:====================================
2023-06-11 16:15:01,743 INFO:Beginning enumeration on a total of 103 tasks with a total of 96 CPUs.
2023-06-11 16:31:50,824 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/3/metrics.json
2023-06-11 16:31:50,824 INFO:====================================
2023-06-11 16:31:50,824 INFO:iteration: 3
2023-06-11 16:31:50,824 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 16:31:50,824 INFO:Completed in 1046.930s
2023-06-11 16:31:50,824 INFO:====================================
2023-06-11 16:31:50,824 INFO:============LOGGING FRONTIERS============
2023-06-11 16:31:50,825 INFO:	 total_solved_tasks_train @ iteration 3: 159 / 191
2023-06-11 16:31:50,825 INFO:	 total_solved_tasks_test @ iteration 3: 94 / 103
2023-06-11 16:31:50,825 INFO:====================================
2023-06-11 16:31:50,825 INFO:============LOGGING MODEL_FN============
2023-06-11 16:31:50,825 INFO:	iteration: 3
2023-06-11 16:31:50,825 INFO:	params: {'compute_likelihoods': True, 'compute_description_lengths': True, 'save_filename': 'test_likelihoods.json'}
2023-06-11 16:31:50,825 INFO:	model_fn: evaluate_frontiers
2023-06-11 16:31:50,825 INFO:	run_every_n_iterations: 3
2023-06-11 16:31:50,825 INFO:	model_type: grammar
2023-06-11 16:31:50,825 INFO:	experiment_block_type: model_fn
2023-06-11 16:31:50,825 INFO:	task_batch_sizes: ['all']
2023-06-11 16:31:50,825 INFO:	task_splits: ['test']
2023-06-11 16:31:50,825 INFO:task_ids test: 103 tasks: 0-1_compare_integer-Are there fewer small spheres than cyan cubes? -- 9-2_transform-If all of the large yellow cubes became small, how many large things would there be?
2023-06-11 16:31:50,825 INFO:====================================
2023-06-11 16:31:51,381 INFO:EVALUATION: evaluate_frontiers : mean log likelihood of 94 programs in splits: ['test'] is: -16.215920295806228
2023-06-11 16:31:51,381 INFO:EVALUATION: evaluate_frontiers : mean description length of 94 programs in splits: ['test'] is: 8.615425531914894
2023-06-11 16:31:51,446 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/3/frontiers.json===========
2023-06-11 16:31:51,449 INFO:============LOGGING MODEL_FN============
2023-06-11 16:31:51,449 INFO:	iteration: 3
2023-06-11 16:31:51,449 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 16:31:51,449 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 16:31:51,449 INFO:	model_type: library_learner
2023-06-11 16:31:51,449 INFO:	experiment_block_type: model_fn
2023-06-11 16:31:51,449 INFO:	task_batch_sizes: ['all']
2023-06-11 16:31:51,449 INFO:	task_splits: ['train']
2023-06-11 16:31:51,449 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 16:31:51,449 INFO:====================================
2023-06-11 16:32:27,057 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 16:32:28,014 INFO:reset_task_frontiers for split: train
2023-06-11 16:32:28,053 INFO:reset_samples for split: train
2023-06-11 16:32:28,053 INFO:============Syncing to AWS S3===========
2023-06-11 16:32:28,053 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 16:32:28,709 INFO:============LOGGING METADATA============
2023-06-11 16:32:28,709 INFO:	iteration: 4
2023-06-11 16:32:28,709 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 16:32:28,709 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 16:32:28,709 INFO:	curr_iteration: 0
2023-06-11 16:32:28,709 INFO:	timestamp: 
2023-06-11 16:32:28,709 INFO:	export_with_timestamp: False
2023-06-11 16:32:28,709 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 16:32:28,709 INFO:	task_language_loader: clevr_human
2023-06-11 16:32:28,709 INFO:	ocaml_special_handler: clevr
2023-06-11 16:32:28,709 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 16:32:28,709 INFO:	resume_checkpoint_directory: None
2023-06-11 16:32:28,709 INFO:	random_seed: 111
2023-06-11 16:32:28,709 INFO:	global_batch_size: 96
2023-06-11 16:32:28,709 INFO:	random_generator: Generator(PCG64)
2023-06-11 16:32:28,710 INFO:	tasks_loader: clevr
2023-06-11 16:32:28,710 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 16:32:28,710 INFO:	enumeration_timeout: 1000
2023-06-11 16:32:28,710 INFO:	experiment_name: runs_human
2023-06-11 16:32:28,710 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 16:32:28,710 INFO:	encoder: clevr
2023-06-11 16:32:28,710 INFO:	init_frontiers_every_iteration: False
2023-06-11 16:32:28,710 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 16:32:28,710 INFO:	recognition_train_steps: None
2023-06-11 16:32:28,710 INFO:	init_grammar_from_checkpoint: False
2023-06-11 16:32:28,710 INFO:====================================
2023-06-11 16:32:28,710 INFO:============LOGGING FRONTIERS============
2023-06-11 16:32:28,711 INFO:	 total_solved_tasks_train @ iteration 4: 159 / 191
2023-06-11 16:32:28,712 INFO:	 total_solved_tasks_test @ iteration 4: 94 / 103
2023-06-11 16:32:28,712 INFO:====================================
2023-06-11 16:32:28,712 INFO:============LOGGING MODEL_FN============
2023-06-11 16:32:28,712 INFO:	iteration: 4
2023-06-11 16:32:28,712 INFO:	task_split: train
2023-06-11 16:32:28,712 INFO:	task_batch_size: all
2023-06-11 16:32:28,712 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 16:32:28,712 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 16:32:28,712 INFO:	model_type: amortized_synthesis
2023-06-11 16:32:28,712 INFO:	experiment_block_type: model_fn
2023-06-11 16:32:28,712 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 16:32:28,712 INFO:====================================
2023-06-11 16:32:28,754 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 16:32:33,165 INFO:Attempted frontier likelihood normalization. Initial frontiers: 159. Now: 159
2023-06-11 16:32:33,165 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:32:34,005 INFO:We now have 251 Helmholtz entries.
2023-06-11 16:33:07,484 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:33:08,332 INFO:We now have 267 Helmholtz entries.
2023-06-11 16:33:45,269 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:33:46,217 INFO:We now have 262 Helmholtz entries.
2023-06-11 16:34:19,147 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:34:19,987 INFO:We now have 254 Helmholtz entries.
2023-06-11 16:34:54,472 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:34:55,294 INFO:We now have 247 Helmholtz entries.
2023-06-11 16:35:28,398 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:35:29,268 INFO:We now have 267 Helmholtz entries.
2023-06-11 16:36:03,322 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:36:04,167 INFO:We now have 261 Helmholtz entries.
2023-06-11 16:36:37,331 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:36:38,165 INFO:We now have 258 Helmholtz entries.
2023-06-11 16:37:10,900 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:37:11,673 INFO:We now have 252 Helmholtz entries.
2023-06-11 16:37:43,819 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:37:44,807 INFO:We now have 275 Helmholtz entries.
2023-06-11 16:38:20,170 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:38:21,085 INFO:We now have 265 Helmholtz entries.
2023-06-11 16:38:54,092 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:38:54,935 INFO:We now have 244 Helmholtz entries.
2023-06-11 16:39:26,780 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:39:27,788 INFO:We now have 252 Helmholtz entries.
2023-06-11 16:40:00,713 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:40:01,632 INFO:We now have 275 Helmholtz entries.
2023-06-11 16:40:35,880 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:40:36,727 INFO:We now have 243 Helmholtz entries.
2023-06-11 16:41:04,242 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:41:05,125 INFO:We now have 264 Helmholtz entries.
2023-06-11 16:41:40,621 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:41:41,502 INFO:We now have 274 Helmholtz entries.
2023-06-11 16:42:15,459 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:42:16,246 INFO:We now have 258 Helmholtz entries.
2023-06-11 16:42:49,194 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:42:50,128 INFO:We now have 267 Helmholtz entries.
2023-06-11 16:43:25,620 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 16:43:26,417 INFO:We now have 260 Helmholtz entries.
2023-06-11 16:43:27,421 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/4/metrics.json
2023-06-11 16:43:27,421 INFO:====================================
2023-06-11 16:43:27,421 INFO:iteration: 4
2023-06-11 16:43:27,421 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 16:43:27,421 INFO:Completed in 658.708s
2023-06-11 16:43:27,421 INFO:====================================
2023-06-11 16:43:27,421 INFO:============LOGGING MODEL_FN============
2023-06-11 16:43:27,421 INFO:	iteration: 4
2023-06-11 16:43:27,421 INFO:	task_split: train
2023-06-11 16:43:27,421 INFO:	task_batch_size: global_batch_size
2023-06-11 16:43:27,421 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 16:43:27,421 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 16:43:27,421 INFO:	model_type: amortized_synthesis
2023-06-11 16:43:27,421 INFO:	experiment_block_type: model_fn
2023-06-11 16:43:27,421 INFO:task_ids: 96 tasks: 6-1_single_or-What number of small objects are either blue metal things or rubber things? -- 13-1_zero_hop-What material is the gray thing?
2023-06-11 16:43:27,421 INFO:====================================
2023-06-11 16:43:50,176 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 17:00:35,999 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/4/metrics.json
2023-06-11 17:00:35,999 INFO:====================================
2023-06-11 17:00:35,999 INFO:iteration: 4
2023-06-11 17:00:35,999 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 17:00:35,999 INFO:Completed in 1028.576s
2023-06-11 17:00:35,999 INFO:====================================
2023-06-11 17:00:35,999 INFO:============LOGGING FRONTIERS============
2023-06-11 17:00:35,999 INFO:	 total_solved_tasks_train @ iteration 4: 173 / 191
2023-06-11 17:00:36,000 INFO:	 total_solved_tasks_test @ iteration 4: 94 / 103
2023-06-11 17:00:36,000 INFO:====================================
2023-06-11 17:00:36,076 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/4/frontiers.json===========
2023-06-11 17:00:36,077 INFO:============LOGGING MODEL_FN============
2023-06-11 17:00:36,077 INFO:	iteration: 4
2023-06-11 17:00:36,077 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 17:00:36,077 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 17:00:36,077 INFO:	model_type: library_learner
2023-06-11 17:00:36,077 INFO:	experiment_block_type: model_fn
2023-06-11 17:00:36,077 INFO:	task_batch_sizes: ['all']
2023-06-11 17:00:36,077 INFO:	task_splits: ['train']
2023-06-11 17:00:36,077 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 17:00:36,077 INFO:====================================
2023-06-11 17:01:34,278 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 17:01:35,283 INFO:reset_task_frontiers for split: train
2023-06-11 17:01:35,329 INFO:reset_samples for split: train
2023-06-11 17:01:35,329 INFO:============Syncing to AWS S3===========
2023-06-11 17:01:35,329 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 17:01:35,948 INFO:============LOGGING METADATA============
2023-06-11 17:01:35,948 INFO:	iteration: 5
2023-06-11 17:01:35,948 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 17:01:35,948 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 17:01:35,948 INFO:	curr_iteration: 0
2023-06-11 17:01:35,948 INFO:	timestamp: 
2023-06-11 17:01:35,948 INFO:	export_with_timestamp: False
2023-06-11 17:01:35,948 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 17:01:35,948 INFO:	task_language_loader: clevr_human
2023-06-11 17:01:35,948 INFO:	ocaml_special_handler: clevr
2023-06-11 17:01:35,948 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 17:01:35,948 INFO:	resume_checkpoint_directory: None
2023-06-11 17:01:35,948 INFO:	random_seed: 111
2023-06-11 17:01:35,948 INFO:	global_batch_size: 96
2023-06-11 17:01:35,948 INFO:	random_generator: Generator(PCG64)
2023-06-11 17:01:35,949 INFO:	tasks_loader: clevr
2023-06-11 17:01:35,949 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 17:01:35,949 INFO:	enumeration_timeout: 1000
2023-06-11 17:01:35,949 INFO:	experiment_name: runs_human
2023-06-11 17:01:35,949 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 17:01:35,949 INFO:	encoder: clevr
2023-06-11 17:01:35,949 INFO:	init_frontiers_every_iteration: False
2023-06-11 17:01:35,949 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 17:01:35,949 INFO:	recognition_train_steps: None
2023-06-11 17:01:35,949 INFO:	init_grammar_from_checkpoint: False
2023-06-11 17:01:35,949 INFO:====================================
2023-06-11 17:01:35,949 INFO:============LOGGING FRONTIERS============
2023-06-11 17:01:35,950 INFO:	 total_solved_tasks_train @ iteration 5: 173 / 191
2023-06-11 17:01:35,950 INFO:	 total_solved_tasks_test @ iteration 5: 94 / 103
2023-06-11 17:01:35,950 INFO:====================================
2023-06-11 17:01:35,951 INFO:============LOGGING MODEL_FN============
2023-06-11 17:01:35,951 INFO:	iteration: 5
2023-06-11 17:01:35,951 INFO:	task_split: train
2023-06-11 17:01:35,951 INFO:	task_batch_size: all
2023-06-11 17:01:35,951 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 17:01:35,951 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 17:01:35,951 INFO:	model_type: amortized_synthesis
2023-06-11 17:01:35,951 INFO:	experiment_block_type: model_fn
2023-06-11 17:01:35,951 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 17:01:35,951 INFO:====================================
2023-06-11 17:01:36,001 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 17:01:40,577 INFO:Attempted frontier likelihood normalization. Initial frontiers: 173. Now: 173
2023-06-11 17:01:40,578 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:01:41,308 INFO:We now have 258 Helmholtz entries.
2023-06-11 17:02:16,535 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:02:17,401 INFO:We now have 265 Helmholtz entries.
2023-06-11 17:02:52,240 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:02:53,077 INFO:We now have 251 Helmholtz entries.
2023-06-11 17:03:23,293 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:03:24,185 INFO:We now have 262 Helmholtz entries.
2023-06-11 17:03:53,870 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:03:54,790 INFO:We now have 272 Helmholtz entries.
2023-06-11 17:04:28,918 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:04:29,865 INFO:We now have 276 Helmholtz entries.
2023-06-11 17:05:01,051 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:05:01,883 INFO:We now have 262 Helmholtz entries.
2023-06-11 17:05:33,616 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:05:34,501 INFO:We now have 284 Helmholtz entries.
2023-06-11 17:06:09,676 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:06:10,696 INFO:We now have 273 Helmholtz entries.
2023-06-11 17:06:44,000 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:06:44,898 INFO:We now have 241 Helmholtz entries.
2023-06-11 17:07:13,851 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:07:14,641 INFO:We now have 259 Helmholtz entries.
2023-06-11 17:07:43,209 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:07:44,098 INFO:We now have 266 Helmholtz entries.
2023-06-11 17:08:13,978 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:08:14,805 INFO:We now have 265 Helmholtz entries.
2023-06-11 17:08:46,580 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:08:47,405 INFO:We now have 255 Helmholtz entries.
2023-06-11 17:09:18,183 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:09:19,320 INFO:We now have 271 Helmholtz entries.
2023-06-11 17:09:51,073 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:09:52,255 INFO:We now have 276 Helmholtz entries.
2023-06-11 17:10:27,137 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:10:27,933 INFO:We now have 252 Helmholtz entries.
2023-06-11 17:11:01,572 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:11:02,482 INFO:We now have 258 Helmholtz entries.
2023-06-11 17:11:34,025 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:11:34,966 INFO:We now have 259 Helmholtz entries.
2023-06-11 17:12:08,194 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:12:09,072 INFO:We now have 284 Helmholtz entries.
2023-06-11 17:12:23,158 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/5/metrics.json
2023-06-11 17:12:23,159 INFO:====================================
2023-06-11 17:12:23,159 INFO:iteration: 5
2023-06-11 17:12:23,159 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 17:12:23,159 INFO:Completed in 647.207s
2023-06-11 17:12:23,159 INFO:====================================
2023-06-11 17:12:23,159 INFO:============LOGGING MODEL_FN============
2023-06-11 17:12:23,159 INFO:	iteration: 5
2023-06-11 17:12:23,159 INFO:	task_split: train
2023-06-11 17:12:23,159 INFO:	task_batch_size: global_batch_size
2023-06-11 17:12:23,159 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 17:12:23,159 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 17:12:23,159 INFO:	model_type: amortized_synthesis
2023-06-11 17:12:23,159 INFO:	experiment_block_type: model_fn
2023-06-11 17:12:23,159 INFO:task_ids: 96 tasks: 3-1_one_hop-What number of large cylinders are left the green rubber thing? -- 6-1_single_or-What number of small objects are either blue metal things or rubber things?
2023-06-11 17:12:23,159 INFO:====================================
2023-06-11 17:12:45,852 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 17:29:30,855 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/5/metrics.json
2023-06-11 17:29:30,855 INFO:====================================
2023-06-11 17:29:30,855 INFO:iteration: 5
2023-06-11 17:29:30,855 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 17:29:30,855 INFO:Completed in 1027.695s
2023-06-11 17:29:30,855 INFO:====================================
2023-06-11 17:29:30,855 INFO:============LOGGING FRONTIERS============
2023-06-11 17:29:30,855 INFO:	 total_solved_tasks_train @ iteration 5: 178 / 191
2023-06-11 17:29:30,856 INFO:	 total_solved_tasks_test @ iteration 5: 94 / 103
2023-06-11 17:29:30,856 INFO:====================================
2023-06-11 17:29:30,935 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/5/frontiers.json===========
2023-06-11 17:29:30,936 INFO:============LOGGING MODEL_FN============
2023-06-11 17:29:30,936 INFO:	iteration: 5
2023-06-11 17:29:30,936 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 17:29:30,936 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 17:29:30,937 INFO:	model_type: library_learner
2023-06-11 17:29:30,937 INFO:	experiment_block_type: model_fn
2023-06-11 17:29:30,937 INFO:	task_batch_sizes: ['all']
2023-06-11 17:29:30,937 INFO:	task_splits: ['train']
2023-06-11 17:29:30,937 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 17:29:30,937 INFO:====================================
2023-06-11 17:30:46,546 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 17:30:47,569 INFO:reset_task_frontiers for split: train
2023-06-11 17:30:47,617 INFO:reset_samples for split: train
2023-06-11 17:30:47,618 INFO:============Syncing to AWS S3===========
2023-06-11 17:30:47,618 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 17:30:48,288 INFO:============LOGGING METADATA============
2023-06-11 17:30:48,288 INFO:	iteration: 6
2023-06-11 17:30:48,288 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 17:30:48,288 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 17:30:48,288 INFO:	curr_iteration: 0
2023-06-11 17:30:48,288 INFO:	timestamp: 
2023-06-11 17:30:48,288 INFO:	export_with_timestamp: False
2023-06-11 17:30:48,288 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 17:30:48,288 INFO:	task_language_loader: clevr_human
2023-06-11 17:30:48,288 INFO:	ocaml_special_handler: clevr
2023-06-11 17:30:48,288 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 17:30:48,288 INFO:	resume_checkpoint_directory: None
2023-06-11 17:30:48,288 INFO:	random_seed: 111
2023-06-11 17:30:48,288 INFO:	global_batch_size: 96
2023-06-11 17:30:48,288 INFO:	random_generator: Generator(PCG64)
2023-06-11 17:30:48,288 INFO:	tasks_loader: clevr
2023-06-11 17:30:48,288 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 17:30:48,289 INFO:	enumeration_timeout: 1000
2023-06-11 17:30:48,289 INFO:	experiment_name: runs_human
2023-06-11 17:30:48,289 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 17:30:48,289 INFO:	encoder: clevr
2023-06-11 17:30:48,289 INFO:	init_frontiers_every_iteration: False
2023-06-11 17:30:48,289 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 17:30:48,289 INFO:	recognition_train_steps: None
2023-06-11 17:30:48,289 INFO:	init_grammar_from_checkpoint: False
2023-06-11 17:30:48,289 INFO:====================================
2023-06-11 17:30:48,289 INFO:============LOGGING FRONTIERS============
2023-06-11 17:30:48,290 INFO:	 total_solved_tasks_train @ iteration 6: 178 / 191
2023-06-11 17:30:48,291 INFO:	 total_solved_tasks_test @ iteration 6: 94 / 103
2023-06-11 17:30:48,291 INFO:====================================
2023-06-11 17:30:48,291 INFO:============LOGGING MODEL_FN============
2023-06-11 17:30:48,291 INFO:	iteration: 6
2023-06-11 17:30:48,291 INFO:	task_split: train
2023-06-11 17:30:48,291 INFO:	task_batch_size: all
2023-06-11 17:30:48,291 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 17:30:48,291 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 17:30:48,291 INFO:	model_type: amortized_synthesis
2023-06-11 17:30:48,291 INFO:	experiment_block_type: model_fn
2023-06-11 17:30:48,291 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 17:30:48,291 INFO:====================================
2023-06-11 17:30:48,344 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 17:30:53,038 INFO:Attempted frontier likelihood normalization. Initial frontiers: 178. Now: 178
2023-06-11 17:30:53,039 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:30:53,943 INFO:We now have 268 Helmholtz entries.
2023-06-11 17:31:27,009 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:31:27,974 INFO:We now have 274 Helmholtz entries.
2023-06-11 17:32:02,636 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:32:03,666 INFO:We now have 265 Helmholtz entries.
2023-06-11 17:32:40,211 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:32:41,374 INFO:We now have 255 Helmholtz entries.
2023-06-11 17:33:09,648 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:33:10,636 INFO:We now have 292 Helmholtz entries.
2023-06-11 17:33:46,149 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:33:47,052 INFO:We now have 279 Helmholtz entries.
2023-06-11 17:34:25,429 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:34:26,284 INFO:We now have 261 Helmholtz entries.
2023-06-11 17:34:56,707 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:34:57,631 INFO:We now have 257 Helmholtz entries.
2023-06-11 17:35:30,659 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:35:31,556 INFO:We now have 250 Helmholtz entries.
2023-06-11 17:36:03,517 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:36:04,417 INFO:We now have 273 Helmholtz entries.
2023-06-11 17:36:36,242 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:36:37,089 INFO:We now have 247 Helmholtz entries.
2023-06-11 17:37:09,873 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:37:10,701 INFO:We now have 269 Helmholtz entries.
2023-06-11 17:37:45,049 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:37:46,010 INFO:We now have 279 Helmholtz entries.
2023-06-11 17:38:20,349 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:38:21,221 INFO:We now have 272 Helmholtz entries.
2023-06-11 17:38:55,963 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:38:56,928 INFO:We now have 252 Helmholtz entries.
2023-06-11 17:39:32,082 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:39:32,848 INFO:We now have 270 Helmholtz entries.
2023-06-11 17:40:09,061 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:40:10,020 INFO:We now have 268 Helmholtz entries.
2023-06-11 17:40:44,005 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:40:44,819 INFO:We now have 263 Helmholtz entries.
2023-06-11 17:41:19,509 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 17:41:20,511 INFO:We now have 280 Helmholtz entries.
2023-06-11 17:41:45,052 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/6/metrics.json
2023-06-11 17:41:45,052 INFO:====================================
2023-06-11 17:41:45,052 INFO:iteration: 6
2023-06-11 17:41:45,052 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 17:41:45,052 INFO:Completed in 656.760s
2023-06-11 17:41:45,052 INFO:====================================
2023-06-11 17:41:45,052 INFO:============LOGGING MODEL_FN============
2023-06-11 17:41:45,052 INFO:	iteration: 6
2023-06-11 17:41:45,052 INFO:	task_split: train
2023-06-11 17:41:45,052 INFO:	task_batch_size: global_batch_size
2023-06-11 17:41:45,052 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 17:41:45,052 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 17:41:45,052 INFO:	model_type: amortized_synthesis
2023-06-11 17:41:45,052 INFO:	experiment_block_type: model_fn
2023-06-11 17:41:45,052 INFO:task_ids: 96 tasks: 45-2_localization-Find the large sphere. -- 3-1_one_hop-What number of large cylinders are left the green rubber thing?
2023-06-11 17:41:45,052 INFO:====================================
2023-06-11 17:42:07,969 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 17:58:53,037 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/6/metrics.json
2023-06-11 17:58:53,038 INFO:====================================
2023-06-11 17:58:53,038 INFO:iteration: 6
2023-06-11 17:58:53,038 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 17:58:53,038 INFO:Completed in 1027.985s
2023-06-11 17:58:53,038 INFO:====================================
2023-06-11 17:58:53,038 INFO:============LOGGING FRONTIERS============
2023-06-11 17:58:53,038 INFO:	 total_solved_tasks_train @ iteration 6: 181 / 191
2023-06-11 17:58:53,039 INFO:	 total_solved_tasks_test @ iteration 6: 94 / 103
2023-06-11 17:58:53,039 INFO:====================================
2023-06-11 17:58:53,053 INFO:reset_task_frontiers for split: test
2023-06-11 17:58:53,053 INFO:============LOGGING MODEL_FN============
2023-06-11 17:58:53,053 INFO:	iteration: 6
2023-06-11 17:58:53,053 INFO:	task_split: test
2023-06-11 17:58:53,053 INFO:	task_batch_size: all
2023-06-11 17:58:53,053 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 17:58:53,053 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 17:58:53,053 INFO:	run_every_n_iterations: 3
2023-06-11 17:58:53,053 INFO:	model_type: amortized_synthesis
2023-06-11 17:58:53,053 INFO:	experiment_block_type: model_fn
2023-06-11 17:58:53,053 INFO:task_ids: 103 tasks: 0-1_compare_integer-Are there fewer small spheres than cyan cubes? -- 9-2_transform-If all of the large yellow cubes became small, how many large things would there be?
2023-06-11 17:58:53,053 INFO:====================================
2023-06-11 17:59:16,991 INFO:Beginning enumeration on a total of 103 tasks with a total of 96 CPUs.
2023-06-11 18:16:03,799 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/6/metrics.json
2023-06-11 18:16:03,799 INFO:====================================
2023-06-11 18:16:03,799 INFO:iteration: 6
2023-06-11 18:16:03,799 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 18:16:03,799 INFO:Completed in 1030.744s
2023-06-11 18:16:03,799 INFO:====================================
2023-06-11 18:16:03,799 INFO:============LOGGING FRONTIERS============
2023-06-11 18:16:03,800 INFO:	 total_solved_tasks_train @ iteration 6: 181 / 191
2023-06-11 18:16:03,800 INFO:	 total_solved_tasks_test @ iteration 6: 97 / 103
2023-06-11 18:16:03,800 INFO:====================================
2023-06-11 18:16:03,800 INFO:============LOGGING MODEL_FN============
2023-06-11 18:16:03,800 INFO:	iteration: 6
2023-06-11 18:16:03,800 INFO:	params: {'compute_likelihoods': True, 'compute_description_lengths': True, 'save_filename': 'test_likelihoods.json'}
2023-06-11 18:16:03,800 INFO:	model_fn: evaluate_frontiers
2023-06-11 18:16:03,800 INFO:	run_every_n_iterations: 3
2023-06-11 18:16:03,800 INFO:	model_type: grammar
2023-06-11 18:16:03,800 INFO:	experiment_block_type: model_fn
2023-06-11 18:16:03,800 INFO:	task_batch_sizes: ['all']
2023-06-11 18:16:03,800 INFO:	task_splits: ['test']
2023-06-11 18:16:03,800 INFO:task_ids test: 103 tasks: 0-1_compare_integer-Are there fewer small spheres than cyan cubes? -- 9-2_transform-If all of the large yellow cubes became small, how many large things would there be?
2023-06-11 18:16:03,800 INFO:====================================
2023-06-11 18:16:04,355 INFO:EVALUATION: evaluate_frontiers : mean log likelihood of 97 programs in splits: ['test'] is: -15.081389541822874
2023-06-11 18:16:04,356 INFO:EVALUATION: evaluate_frontiers : mean description length of 97 programs in splits: ['test'] is: 8.006185567010307
2023-06-11 18:16:04,430 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/6/frontiers.json===========
2023-06-11 18:16:04,431 INFO:============LOGGING MODEL_FN============
2023-06-11 18:16:04,431 INFO:	iteration: 6
2023-06-11 18:16:04,431 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 18:16:04,431 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 18:16:04,431 INFO:	model_type: library_learner
2023-06-11 18:16:04,431 INFO:	experiment_block_type: model_fn
2023-06-11 18:16:04,431 INFO:	task_batch_sizes: ['all']
2023-06-11 18:16:04,431 INFO:	task_splits: ['train']
2023-06-11 18:16:04,431 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 18:16:04,431 INFO:====================================
2023-06-11 18:17:27,538 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 18:17:28,540 INFO:reset_task_frontiers for split: train
2023-06-11 18:17:28,590 INFO:reset_samples for split: train
2023-06-11 18:17:28,590 INFO:============Syncing to AWS S3===========
2023-06-11 18:17:28,590 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 18:17:29,273 INFO:============LOGGING METADATA============
2023-06-11 18:17:29,273 INFO:	iteration: 7
2023-06-11 18:17:29,273 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 18:17:29,273 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 18:17:29,273 INFO:	curr_iteration: 0
2023-06-11 18:17:29,273 INFO:	timestamp: 
2023-06-11 18:17:29,273 INFO:	export_with_timestamp: False
2023-06-11 18:17:29,273 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 18:17:29,273 INFO:	task_language_loader: clevr_human
2023-06-11 18:17:29,273 INFO:	ocaml_special_handler: clevr
2023-06-11 18:17:29,273 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 18:17:29,273 INFO:	resume_checkpoint_directory: None
2023-06-11 18:17:29,273 INFO:	random_seed: 111
2023-06-11 18:17:29,273 INFO:	global_batch_size: 96
2023-06-11 18:17:29,273 INFO:	random_generator: Generator(PCG64)
2023-06-11 18:17:29,273 INFO:	tasks_loader: clevr
2023-06-11 18:17:29,273 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 18:17:29,273 INFO:	enumeration_timeout: 1000
2023-06-11 18:17:29,273 INFO:	experiment_name: runs_human
2023-06-11 18:17:29,273 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 18:17:29,273 INFO:	encoder: clevr
2023-06-11 18:17:29,273 INFO:	init_frontiers_every_iteration: False
2023-06-11 18:17:29,273 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 18:17:29,273 INFO:	recognition_train_steps: None
2023-06-11 18:17:29,273 INFO:	init_grammar_from_checkpoint: False
2023-06-11 18:17:29,273 INFO:====================================
2023-06-11 18:17:29,273 INFO:============LOGGING FRONTIERS============
2023-06-11 18:17:29,275 INFO:	 total_solved_tasks_train @ iteration 7: 181 / 191
2023-06-11 18:17:29,275 INFO:	 total_solved_tasks_test @ iteration 7: 97 / 103
2023-06-11 18:17:29,275 INFO:====================================
2023-06-11 18:17:29,275 INFO:============LOGGING MODEL_FN============
2023-06-11 18:17:29,275 INFO:	iteration: 7
2023-06-11 18:17:29,275 INFO:	task_split: train
2023-06-11 18:17:29,275 INFO:	task_batch_size: all
2023-06-11 18:17:29,275 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 18:17:29,276 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 18:17:29,276 INFO:	model_type: amortized_synthesis
2023-06-11 18:17:29,276 INFO:	experiment_block_type: model_fn
2023-06-11 18:17:29,276 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 18:17:29,276 INFO:====================================
2023-06-11 18:17:29,326 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 18:17:33,717 INFO:Attempted frontier likelihood normalization. Initial frontiers: 181. Now: 181
2023-06-11 18:17:33,717 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:17:34,682 INFO:We now have 254 Helmholtz entries.
2023-06-11 18:18:07,516 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:18:08,512 INFO:We now have 297 Helmholtz entries.
2023-06-11 18:18:43,484 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:18:44,396 INFO:We now have 281 Helmholtz entries.
2023-06-11 18:19:19,673 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:19:20,513 INFO:We now have 272 Helmholtz entries.
2023-06-11 18:19:55,891 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:19:56,749 INFO:We now have 280 Helmholtz entries.
2023-06-11 18:20:30,383 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:20:31,145 INFO:We now have 263 Helmholtz entries.
2023-06-11 18:21:04,406 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:21:05,295 INFO:We now have 266 Helmholtz entries.
2023-06-11 18:21:39,688 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:21:40,634 INFO:We now have 283 Helmholtz entries.
2023-06-11 18:22:17,275 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:22:18,236 INFO:We now have 269 Helmholtz entries.
2023-06-11 18:22:50,771 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:22:51,674 INFO:We now have 284 Helmholtz entries.
2023-06-11 18:23:26,491 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:23:27,341 INFO:We now have 274 Helmholtz entries.
2023-06-11 18:24:02,978 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:24:04,010 INFO:We now have 279 Helmholtz entries.
2023-06-11 18:24:41,106 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:24:41,915 INFO:We now have 269 Helmholtz entries.
2023-06-11 18:25:14,769 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:25:15,631 INFO:We now have 269 Helmholtz entries.
2023-06-11 18:25:49,707 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:25:51,107 INFO:We now have 258 Helmholtz entries.
2023-06-11 18:26:21,209 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:26:22,218 INFO:We now have 295 Helmholtz entries.
2023-06-11 18:27:00,682 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:27:01,581 INFO:We now have 282 Helmholtz entries.
2023-06-11 18:27:36,808 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:27:37,755 INFO:We now have 270 Helmholtz entries.
2023-06-11 18:28:10,067 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:28:10,909 INFO:We now have 278 Helmholtz entries.
2023-06-11 18:28:22,736 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/7/metrics.json
2023-06-11 18:28:22,736 INFO:====================================
2023-06-11 18:28:22,736 INFO:iteration: 7
2023-06-11 18:28:22,736 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 18:28:22,737 INFO:Completed in 653.460s
2023-06-11 18:28:22,737 INFO:====================================
2023-06-11 18:28:22,737 INFO:============LOGGING MODEL_FN============
2023-06-11 18:28:22,737 INFO:	iteration: 7
2023-06-11 18:28:22,737 INFO:	task_split: train
2023-06-11 18:28:22,737 INFO:	task_batch_size: global_batch_size
2023-06-11 18:28:22,737 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 18:28:22,737 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 18:28:22,737 INFO:	model_type: amortized_synthesis
2023-06-11 18:28:22,737 INFO:	experiment_block_type: model_fn
2023-06-11 18:28:22,737 INFO:task_ids: 96 tasks: 20-1_zero_hop-What is the color of the rubber cube? -- 45-2_localization-Find the large sphere.
2023-06-11 18:28:22,737 INFO:====================================
2023-06-11 18:28:45,724 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 18:45:30,825 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/7/metrics.json
2023-06-11 18:45:30,826 INFO:====================================
2023-06-11 18:45:30,826 INFO:iteration: 7
2023-06-11 18:45:30,826 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 18:45:30,826 INFO:Completed in 1028.088s
2023-06-11 18:45:30,826 INFO:====================================
2023-06-11 18:45:30,826 INFO:============LOGGING FRONTIERS============
2023-06-11 18:45:30,826 INFO:	 total_solved_tasks_train @ iteration 7: 184 / 191
2023-06-11 18:45:30,826 INFO:	 total_solved_tasks_test @ iteration 7: 97 / 103
2023-06-11 18:45:30,826 INFO:====================================
2023-06-11 18:45:30,898 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/7/frontiers.json===========
2023-06-11 18:45:30,900 INFO:============LOGGING MODEL_FN============
2023-06-11 18:45:30,900 INFO:	iteration: 7
2023-06-11 18:45:30,900 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 18:45:30,900 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 18:45:30,900 INFO:	model_type: library_learner
2023-06-11 18:45:30,900 INFO:	experiment_block_type: model_fn
2023-06-11 18:45:30,900 INFO:	task_batch_sizes: ['all']
2023-06-11 18:45:30,900 INFO:	task_splits: ['train']
2023-06-11 18:45:30,900 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 18:45:30,900 INFO:====================================
2023-06-11 18:47:17,429 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 18:47:18,435 INFO:reset_task_frontiers for split: train
2023-06-11 18:47:18,486 INFO:reset_samples for split: train
2023-06-11 18:47:18,487 INFO:============Syncing to AWS S3===========
2023-06-11 18:47:18,487 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 18:47:19,170 INFO:============LOGGING METADATA============
2023-06-11 18:47:19,171 INFO:	iteration: 8
2023-06-11 18:47:19,171 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 18:47:19,171 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 18:47:19,171 INFO:	curr_iteration: 0
2023-06-11 18:47:19,171 INFO:	timestamp: 
2023-06-11 18:47:19,171 INFO:	export_with_timestamp: False
2023-06-11 18:47:19,171 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 18:47:19,171 INFO:	task_language_loader: clevr_human
2023-06-11 18:47:19,171 INFO:	ocaml_special_handler: clevr
2023-06-11 18:47:19,171 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 18:47:19,171 INFO:	resume_checkpoint_directory: None
2023-06-11 18:47:19,171 INFO:	random_seed: 111
2023-06-11 18:47:19,171 INFO:	global_batch_size: 96
2023-06-11 18:47:19,171 INFO:	random_generator: Generator(PCG64)
2023-06-11 18:47:19,171 INFO:	tasks_loader: clevr
2023-06-11 18:47:19,171 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 18:47:19,171 INFO:	enumeration_timeout: 1000
2023-06-11 18:47:19,171 INFO:	experiment_name: runs_human
2023-06-11 18:47:19,171 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 18:47:19,171 INFO:	encoder: clevr
2023-06-11 18:47:19,171 INFO:	init_frontiers_every_iteration: False
2023-06-11 18:47:19,171 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 18:47:19,171 INFO:	recognition_train_steps: None
2023-06-11 18:47:19,171 INFO:	init_grammar_from_checkpoint: False
2023-06-11 18:47:19,171 INFO:====================================
2023-06-11 18:47:19,171 INFO:============LOGGING FRONTIERS============
2023-06-11 18:47:19,173 INFO:	 total_solved_tasks_train @ iteration 8: 184 / 191
2023-06-11 18:47:19,173 INFO:	 total_solved_tasks_test @ iteration 8: 97 / 103
2023-06-11 18:47:19,173 INFO:====================================
2023-06-11 18:47:19,173 INFO:============LOGGING MODEL_FN============
2023-06-11 18:47:19,173 INFO:	iteration: 8
2023-06-11 18:47:19,173 INFO:	task_split: train
2023-06-11 18:47:19,173 INFO:	task_batch_size: all
2023-06-11 18:47:19,174 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 18:47:19,174 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 18:47:19,174 INFO:	model_type: amortized_synthesis
2023-06-11 18:47:19,174 INFO:	experiment_block_type: model_fn
2023-06-11 18:47:19,174 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 18:47:19,174 INFO:====================================
2023-06-11 18:47:19,227 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 18:47:23,867 INFO:Attempted frontier likelihood normalization. Initial frontiers: 184. Now: 184
2023-06-11 18:47:23,867 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:47:24,772 INFO:We now have 271 Helmholtz entries.
2023-06-11 18:47:57,334 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:47:58,198 INFO:We now have 272 Helmholtz entries.
2023-06-11 18:48:31,999 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:48:32,960 INFO:We now have 275 Helmholtz entries.
2023-06-11 18:49:05,699 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:49:06,545 INFO:We now have 271 Helmholtz entries.
2023-06-11 18:49:41,080 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:49:41,965 INFO:We now have 276 Helmholtz entries.
2023-06-11 18:50:15,680 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:50:16,692 INFO:We now have 286 Helmholtz entries.
2023-06-11 18:50:54,184 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:50:55,203 INFO:We now have 289 Helmholtz entries.
2023-06-11 18:51:35,725 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:51:36,751 INFO:We now have 264 Helmholtz entries.
2023-06-11 18:52:08,814 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:52:09,724 INFO:We now have 288 Helmholtz entries.
2023-06-11 18:52:48,034 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:52:49,051 INFO:We now have 273 Helmholtz entries.
2023-06-11 18:53:21,663 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:53:22,612 INFO:We now have 281 Helmholtz entries.
2023-06-11 18:53:58,054 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:53:58,994 INFO:We now have 268 Helmholtz entries.
2023-06-11 18:54:30,508 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:54:31,423 INFO:We now have 272 Helmholtz entries.
2023-06-11 18:55:03,499 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:55:04,978 INFO:We now have 291 Helmholtz entries.
2023-06-11 18:55:42,480 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:55:43,458 INFO:We now have 277 Helmholtz entries.
2023-06-11 18:56:20,351 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:56:21,312 INFO:We now have 285 Helmholtz entries.
2023-06-11 18:56:59,191 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:57:00,123 INFO:We now have 283 Helmholtz entries.
2023-06-11 18:57:36,338 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 18:57:37,235 INFO:We now have 281 Helmholtz entries.
2023-06-11 18:58:09,978 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/8/metrics.json
2023-06-11 18:58:09,978 INFO:====================================
2023-06-11 18:58:09,978 INFO:iteration: 8
2023-06-11 18:58:09,978 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 18:58:09,978 INFO:Completed in 650.803s
2023-06-11 18:58:09,978 INFO:====================================
2023-06-11 18:58:09,978 INFO:============LOGGING MODEL_FN============
2023-06-11 18:58:09,978 INFO:	iteration: 8
2023-06-11 18:58:09,978 INFO:	task_split: train
2023-06-11 18:58:09,978 INFO:	task_batch_size: global_batch_size
2023-06-11 18:58:09,978 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 18:58:09,978 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 18:58:09,978 INFO:	model_type: amortized_synthesis
2023-06-11 18:58:09,978 INFO:	experiment_block_type: model_fn
2023-06-11 18:58:09,978 INFO:task_ids: 96 tasks: 12-1_single_or-How many purple things are rubber things or large things? -- 20-1_zero_hop-What is the color of the rubber cube?
2023-06-11 18:58:09,978 INFO:====================================
2023-06-11 18:58:29,650 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 19:15:15,842 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/8/metrics.json
2023-06-11 19:15:15,843 INFO:====================================
2023-06-11 19:15:15,843 INFO:iteration: 8
2023-06-11 19:15:15,843 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 19:15:15,843 INFO:Completed in 1025.863s
2023-06-11 19:15:15,843 INFO:====================================
2023-06-11 19:15:15,843 INFO:============LOGGING FRONTIERS============
2023-06-11 19:15:15,843 INFO:	 total_solved_tasks_train @ iteration 8: 185 / 191
2023-06-11 19:15:15,844 INFO:	 total_solved_tasks_test @ iteration 8: 97 / 103
2023-06-11 19:15:15,844 INFO:====================================
2023-06-11 19:15:15,930 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/8/frontiers.json===========
2023-06-11 19:15:15,931 INFO:============LOGGING MODEL_FN============
2023-06-11 19:15:15,931 INFO:	iteration: 8
2023-06-11 19:15:15,931 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 19:15:15,931 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 19:15:15,931 INFO:	model_type: library_learner
2023-06-11 19:15:15,931 INFO:	experiment_block_type: model_fn
2023-06-11 19:15:15,931 INFO:	task_batch_sizes: ['all']
2023-06-11 19:15:15,931 INFO:	task_splits: ['train']
2023-06-11 19:15:15,931 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 19:15:15,931 INFO:====================================
2023-06-11 19:16:58,317 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 19:16:59,336 INFO:reset_task_frontiers for split: train
2023-06-11 19:16:59,390 INFO:reset_samples for split: train
2023-06-11 19:16:59,390 INFO:============Syncing to AWS S3===========
2023-06-11 19:16:59,390 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 19:17:00,012 INFO:============LOGGING METADATA============
2023-06-11 19:17:00,012 INFO:	iteration: 9
2023-06-11 19:17:00,012 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 19:17:00,012 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 19:17:00,012 INFO:	curr_iteration: 0
2023-06-11 19:17:00,012 INFO:	timestamp: 
2023-06-11 19:17:00,012 INFO:	export_with_timestamp: False
2023-06-11 19:17:00,012 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 19:17:00,012 INFO:	task_language_loader: clevr_human
2023-06-11 19:17:00,012 INFO:	ocaml_special_handler: clevr
2023-06-11 19:17:00,012 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 19:17:00,012 INFO:	resume_checkpoint_directory: None
2023-06-11 19:17:00,012 INFO:	random_seed: 111
2023-06-11 19:17:00,012 INFO:	global_batch_size: 96
2023-06-11 19:17:00,013 INFO:	random_generator: Generator(PCG64)
2023-06-11 19:17:00,013 INFO:	tasks_loader: clevr
2023-06-11 19:17:00,013 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 19:17:00,013 INFO:	enumeration_timeout: 1000
2023-06-11 19:17:00,013 INFO:	experiment_name: runs_human
2023-06-11 19:17:00,013 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 19:17:00,013 INFO:	encoder: clevr
2023-06-11 19:17:00,013 INFO:	init_frontiers_every_iteration: False
2023-06-11 19:17:00,013 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 19:17:00,013 INFO:	recognition_train_steps: None
2023-06-11 19:17:00,013 INFO:	init_grammar_from_checkpoint: False
2023-06-11 19:17:00,013 INFO:====================================
2023-06-11 19:17:00,013 INFO:============LOGGING FRONTIERS============
2023-06-11 19:17:00,014 INFO:	 total_solved_tasks_train @ iteration 9: 185 / 191
2023-06-11 19:17:00,015 INFO:	 total_solved_tasks_test @ iteration 9: 97 / 103
2023-06-11 19:17:00,015 INFO:====================================
2023-06-11 19:17:00,015 INFO:============LOGGING MODEL_FN============
2023-06-11 19:17:00,015 INFO:	iteration: 9
2023-06-11 19:17:00,015 INFO:	task_split: train
2023-06-11 19:17:00,015 INFO:	task_batch_size: all
2023-06-11 19:17:00,015 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 19:17:00,015 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 19:17:00,015 INFO:	model_type: amortized_synthesis
2023-06-11 19:17:00,015 INFO:	experiment_block_type: model_fn
2023-06-11 19:17:00,015 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 19:17:00,015 INFO:====================================
2023-06-11 19:17:00,069 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 19:17:04,763 INFO:Attempted frontier likelihood normalization. Initial frontiers: 185. Now: 185
2023-06-11 19:17:04,862 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:17:05,836 INFO:We now have 265 Helmholtz entries.
2023-06-11 19:17:41,672 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:17:42,637 INFO:We now have 264 Helmholtz entries.
2023-06-11 19:18:15,965 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:18:16,965 INFO:We now have 280 Helmholtz entries.
2023-06-11 19:18:53,424 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:18:54,332 INFO:We now have 268 Helmholtz entries.
2023-06-11 19:19:25,075 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:19:26,002 INFO:We now have 275 Helmholtz entries.
2023-06-11 19:19:56,995 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:19:58,046 INFO:We now have 291 Helmholtz entries.
2023-06-11 19:20:38,105 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:20:39,014 INFO:We now have 267 Helmholtz entries.
2023-06-11 19:21:13,736 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:21:14,576 INFO:We now have 277 Helmholtz entries.
2023-06-11 19:21:51,956 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:21:52,916 INFO:We now have 256 Helmholtz entries.
2023-06-11 19:22:22,919 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:22:23,864 INFO:We now have 287 Helmholtz entries.
2023-06-11 19:23:01,666 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:23:02,676 INFO:We now have 257 Helmholtz entries.
2023-06-11 19:23:35,283 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:23:36,241 INFO:We now have 277 Helmholtz entries.
2023-06-11 19:24:07,415 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:24:08,399 INFO:We now have 261 Helmholtz entries.
2023-06-11 19:24:38,289 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:24:39,237 INFO:We now have 264 Helmholtz entries.
2023-06-11 19:25:11,103 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:25:12,021 INFO:We now have 269 Helmholtz entries.
2023-06-11 19:25:44,464 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:25:45,538 INFO:We now have 286 Helmholtz entries.
2023-06-11 19:26:19,821 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:26:20,798 INFO:We now have 288 Helmholtz entries.
2023-06-11 19:26:59,428 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:27:00,354 INFO:We now have 276 Helmholtz entries.
2023-06-11 19:27:33,791 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 19:27:34,752 INFO:We now have 273 Helmholtz entries.
2023-06-11 19:28:00,308 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/9/metrics.json
2023-06-11 19:28:00,308 INFO:====================================
2023-06-11 19:28:00,308 INFO:iteration: 9
2023-06-11 19:28:00,308 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 19:28:00,308 INFO:Completed in 660.292s
2023-06-11 19:28:00,308 INFO:====================================
2023-06-11 19:28:00,308 INFO:============LOGGING MODEL_FN============
2023-06-11 19:28:00,308 INFO:	iteration: 9
2023-06-11 19:28:00,308 INFO:	task_split: train
2023-06-11 19:28:00,308 INFO:	task_batch_size: global_batch_size
2023-06-11 19:28:00,308 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 19:28:00,308 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 19:28:00,308 INFO:	model_type: amortized_synthesis
2023-06-11 19:28:00,308 INFO:	experiment_block_type: model_fn
2023-06-11 19:28:00,308 INFO:task_ids: 96 tasks: 21-2_remove-If you removed the red cubes, how many cubes would be left? -- 12-1_single_or-How many purple things are rubber things or large things?
2023-06-11 19:28:00,308 INFO:====================================
2023-06-11 19:28:20,393 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 19:45:05,826 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/9/metrics.json
2023-06-11 19:45:05,826 INFO:====================================
2023-06-11 19:45:05,826 INFO:iteration: 9
2023-06-11 19:45:05,826 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 19:45:05,827 INFO:Completed in 1025.517s
2023-06-11 19:45:05,827 INFO:====================================
2023-06-11 19:45:05,827 INFO:============LOGGING FRONTIERS============
2023-06-11 19:45:05,827 INFO:	 total_solved_tasks_train @ iteration 9: 185 / 191
2023-06-11 19:45:05,827 INFO:	 total_solved_tasks_test @ iteration 9: 97 / 103
2023-06-11 19:45:05,827 INFO:====================================
2023-06-11 19:45:05,843 INFO:reset_task_frontiers for split: test
2023-06-11 19:45:05,843 INFO:============LOGGING MODEL_FN============
2023-06-11 19:45:05,843 INFO:	iteration: 9
2023-06-11 19:45:05,843 INFO:	task_split: test
2023-06-11 19:45:05,843 INFO:	task_batch_size: all
2023-06-11 19:45:05,843 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 19:45:05,843 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 19:45:05,843 INFO:	run_every_n_iterations: 3
2023-06-11 19:45:05,843 INFO:	model_type: amortized_synthesis
2023-06-11 19:45:05,843 INFO:	experiment_block_type: model_fn
2023-06-11 19:45:05,843 INFO:task_ids: 103 tasks: 0-1_compare_integer-Are there fewer small spheres than cyan cubes? -- 9-2_transform-If all of the large yellow cubes became small, how many large things would there be?
2023-06-11 19:45:05,843 INFO:====================================
2023-06-11 19:45:27,254 INFO:Beginning enumeration on a total of 103 tasks with a total of 96 CPUs.
2023-06-11 20:02:13,853 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/9/metrics.json
2023-06-11 20:02:13,853 INFO:====================================
2023-06-11 20:02:13,853 INFO:iteration: 9
2023-06-11 20:02:13,853 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 20:02:13,853 INFO:Completed in 1028.009s
2023-06-11 20:02:13,853 INFO:====================================
2023-06-11 20:02:13,853 INFO:============LOGGING FRONTIERS============
2023-06-11 20:02:13,854 INFO:	 total_solved_tasks_train @ iteration 9: 185 / 191
2023-06-11 20:02:13,854 INFO:	 total_solved_tasks_test @ iteration 9: 100 / 103
2023-06-11 20:02:13,854 INFO:====================================
2023-06-11 20:02:13,854 INFO:============LOGGING MODEL_FN============
2023-06-11 20:02:13,854 INFO:	iteration: 9
2023-06-11 20:02:13,854 INFO:	params: {'compute_likelihoods': True, 'compute_description_lengths': True, 'save_filename': 'test_likelihoods.json'}
2023-06-11 20:02:13,854 INFO:	model_fn: evaluate_frontiers
2023-06-11 20:02:13,854 INFO:	run_every_n_iterations: 3
2023-06-11 20:02:13,854 INFO:	model_type: grammar
2023-06-11 20:02:13,854 INFO:	experiment_block_type: model_fn
2023-06-11 20:02:13,854 INFO:	task_batch_sizes: ['all']
2023-06-11 20:02:13,854 INFO:	task_splits: ['test']
2023-06-11 20:02:13,854 INFO:task_ids test: 103 tasks: 0-1_compare_integer-Are there fewer small spheres than cyan cubes? -- 9-2_transform-If all of the large yellow cubes became small, how many large things would there be?
2023-06-11 20:02:13,854 INFO:====================================
2023-06-11 20:02:14,432 INFO:EVALUATION: evaluate_frontiers : mean log likelihood of 100 programs in splits: ['test'] is: -15.019451160339356
2023-06-11 20:02:14,432 INFO:EVALUATION: evaluate_frontiers : mean description length of 100 programs in splits: ['test'] is: 8.077
2023-06-11 20:02:14,511 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/9/frontiers.json===========
2023-06-11 20:02:14,512 INFO:============LOGGING MODEL_FN============
2023-06-11 20:02:14,512 INFO:	iteration: 9
2023-06-11 20:02:14,512 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 20:02:14,512 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 20:02:14,512 INFO:	model_type: library_learner
2023-06-11 20:02:14,512 INFO:	experiment_block_type: model_fn
2023-06-11 20:02:14,512 INFO:	task_batch_sizes: ['all']
2023-06-11 20:02:14,512 INFO:	task_splits: ['train']
2023-06-11 20:02:14,512 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 20:02:14,512 INFO:====================================
2023-06-11 20:03:57,615 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 20:03:58,650 INFO:reset_task_frontiers for split: train
2023-06-11 20:03:58,702 INFO:reset_samples for split: train
2023-06-11 20:03:58,702 INFO:============Syncing to AWS S3===========
2023-06-11 20:03:58,702 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 20:03:59,359 INFO:============LOGGING METADATA============
2023-06-11 20:03:59,359 INFO:	iteration: 10
2023-06-11 20:03:59,359 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 20:03:59,360 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 20:03:59,360 INFO:	curr_iteration: 0
2023-06-11 20:03:59,360 INFO:	timestamp: 
2023-06-11 20:03:59,360 INFO:	export_with_timestamp: False
2023-06-11 20:03:59,360 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 20:03:59,360 INFO:	task_language_loader: clevr_human
2023-06-11 20:03:59,360 INFO:	ocaml_special_handler: clevr
2023-06-11 20:03:59,360 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 20:03:59,360 INFO:	resume_checkpoint_directory: None
2023-06-11 20:03:59,360 INFO:	random_seed: 111
2023-06-11 20:03:59,360 INFO:	global_batch_size: 96
2023-06-11 20:03:59,360 INFO:	random_generator: Generator(PCG64)
2023-06-11 20:03:59,360 INFO:	tasks_loader: clevr
2023-06-11 20:03:59,360 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 20:03:59,360 INFO:	enumeration_timeout: 1000
2023-06-11 20:03:59,360 INFO:	experiment_name: runs_human
2023-06-11 20:03:59,360 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 20:03:59,360 INFO:	encoder: clevr
2023-06-11 20:03:59,360 INFO:	init_frontiers_every_iteration: False
2023-06-11 20:03:59,360 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 20:03:59,360 INFO:	recognition_train_steps: None
2023-06-11 20:03:59,360 INFO:	init_grammar_from_checkpoint: False
2023-06-11 20:03:59,360 INFO:====================================
2023-06-11 20:03:59,360 INFO:============LOGGING FRONTIERS============
2023-06-11 20:03:59,361 INFO:	 total_solved_tasks_train @ iteration 10: 185 / 191
2023-06-11 20:03:59,362 INFO:	 total_solved_tasks_test @ iteration 10: 100 / 103
2023-06-11 20:03:59,362 INFO:====================================
2023-06-11 20:03:59,362 INFO:============LOGGING MODEL_FN============
2023-06-11 20:03:59,362 INFO:	iteration: 10
2023-06-11 20:03:59,362 INFO:	task_split: train
2023-06-11 20:03:59,362 INFO:	task_batch_size: all
2023-06-11 20:03:59,362 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 20:03:59,362 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 20:03:59,362 INFO:	model_type: amortized_synthesis
2023-06-11 20:03:59,362 INFO:	experiment_block_type: model_fn
2023-06-11 20:03:59,362 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 20:03:59,362 INFO:====================================
2023-06-11 20:03:59,414 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 20:04:04,223 INFO:Attempted frontier likelihood normalization. Initial frontiers: 185. Now: 185
2023-06-11 20:04:04,223 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:04:05,167 INFO:We now have 268 Helmholtz entries.
2023-06-11 20:04:39,011 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:04:40,046 INFO:We now have 291 Helmholtz entries.
2023-06-11 20:05:17,461 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:05:18,366 INFO:We now have 269 Helmholtz entries.
2023-06-11 20:05:52,945 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:05:53,900 INFO:We now have 279 Helmholtz entries.
2023-06-11 20:06:29,047 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:06:29,984 INFO:We now have 275 Helmholtz entries.
2023-06-11 20:07:05,912 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:07:06,866 INFO:We now have 290 Helmholtz entries.
2023-06-11 20:07:43,853 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:07:44,854 INFO:We now have 293 Helmholtz entries.
2023-06-11 20:08:23,915 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:08:24,879 INFO:We now have 267 Helmholtz entries.
2023-06-11 20:09:00,039 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:09:01,034 INFO:We now have 287 Helmholtz entries.
2023-06-11 20:09:38,970 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:09:39,889 INFO:We now have 287 Helmholtz entries.
2023-06-11 20:10:16,875 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:10:17,852 INFO:We now have 291 Helmholtz entries.
2023-06-11 20:10:51,953 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:10:52,881 INFO:We now have 284 Helmholtz entries.
2023-06-11 20:11:28,886 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:11:29,821 INFO:We now have 270 Helmholtz entries.
2023-06-11 20:12:04,929 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:12:05,870 INFO:We now have 278 Helmholtz entries.
2023-06-11 20:12:41,889 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:12:42,821 INFO:We now have 285 Helmholtz entries.
2023-06-11 20:13:19,442 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:13:20,349 INFO:We now have 286 Helmholtz entries.
2023-06-11 20:13:57,946 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:13:58,841 INFO:We now have 282 Helmholtz entries.
2023-06-11 20:14:30,853 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:14:31,760 INFO:We now have 267 Helmholtz entries.
2023-06-11 20:14:58,434 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/10/metrics.json
2023-06-11 20:14:58,434 INFO:====================================
2023-06-11 20:14:58,434 INFO:iteration: 10
2023-06-11 20:14:58,434 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 20:14:58,434 INFO:Completed in 659.070s
2023-06-11 20:14:58,434 INFO:====================================
2023-06-11 20:14:58,434 INFO:============LOGGING MODEL_FN============
2023-06-11 20:14:58,434 INFO:	iteration: 10
2023-06-11 20:14:58,434 INFO:	task_split: train
2023-06-11 20:14:58,434 INFO:	task_batch_size: global_batch_size
2023-06-11 20:14:58,434 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 20:14:58,434 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 20:14:58,434 INFO:	model_type: amortized_synthesis
2023-06-11 20:14:58,434 INFO:	experiment_block_type: model_fn
2023-06-11 20:14:58,434 INFO:task_ids: 96 tasks: 6-1_zero_hop-There is a yellow thing; what shape is it? -- 21-2_remove-If you removed the red cubes, how many cubes would be left?
2023-06-11 20:14:58,434 INFO:====================================
2023-06-11 20:15:18,193 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 20:32:03,809 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/10/metrics.json
2023-06-11 20:32:03,809 INFO:====================================
2023-06-11 20:32:03,809 INFO:iteration: 10
2023-06-11 20:32:03,809 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 20:32:03,809 INFO:Completed in 1025.374s
2023-06-11 20:32:03,809 INFO:====================================
2023-06-11 20:32:03,809 INFO:============LOGGING FRONTIERS============
2023-06-11 20:32:03,809 INFO:	 total_solved_tasks_train @ iteration 10: 185 / 191
2023-06-11 20:32:03,810 INFO:	 total_solved_tasks_test @ iteration 10: 100 / 103
2023-06-11 20:32:03,810 INFO:====================================
2023-06-11 20:32:03,884 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/10/frontiers.json===========
2023-06-11 20:32:03,886 INFO:============LOGGING MODEL_FN============
2023-06-11 20:32:03,886 INFO:	iteration: 10
2023-06-11 20:32:03,886 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 20:32:03,886 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 20:32:03,886 INFO:	model_type: library_learner
2023-06-11 20:32:03,886 INFO:	experiment_block_type: model_fn
2023-06-11 20:32:03,886 INFO:	task_batch_sizes: ['all']
2023-06-11 20:32:03,886 INFO:	task_splits: ['train']
2023-06-11 20:32:03,886 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 20:32:03,886 INFO:====================================
2023-06-11 20:33:43,648 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 20:33:44,672 INFO:reset_task_frontiers for split: train
2023-06-11 20:33:44,727 INFO:reset_samples for split: train
2023-06-11 20:33:44,728 INFO:============Syncing to AWS S3===========
2023-06-11 20:33:44,728 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 20:33:45,405 INFO:============LOGGING METADATA============
2023-06-11 20:33:45,405 INFO:	iteration: 11
2023-06-11 20:33:45,405 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 20:33:45,405 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 20:33:45,405 INFO:	curr_iteration: 0
2023-06-11 20:33:45,405 INFO:	timestamp: 
2023-06-11 20:33:45,405 INFO:	export_with_timestamp: False
2023-06-11 20:33:45,405 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 20:33:45,405 INFO:	task_language_loader: clevr_human
2023-06-11 20:33:45,406 INFO:	ocaml_special_handler: clevr
2023-06-11 20:33:45,406 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 20:33:45,406 INFO:	resume_checkpoint_directory: None
2023-06-11 20:33:45,406 INFO:	random_seed: 111
2023-06-11 20:33:45,406 INFO:	global_batch_size: 96
2023-06-11 20:33:45,406 INFO:	random_generator: Generator(PCG64)
2023-06-11 20:33:45,406 INFO:	tasks_loader: clevr
2023-06-11 20:33:45,406 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 20:33:45,406 INFO:	enumeration_timeout: 1000
2023-06-11 20:33:45,406 INFO:	experiment_name: runs_human
2023-06-11 20:33:45,406 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 20:33:45,406 INFO:	encoder: clevr
2023-06-11 20:33:45,406 INFO:	init_frontiers_every_iteration: False
2023-06-11 20:33:45,406 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 20:33:45,406 INFO:	recognition_train_steps: None
2023-06-11 20:33:45,406 INFO:	init_grammar_from_checkpoint: False
2023-06-11 20:33:45,406 INFO:====================================
2023-06-11 20:33:45,406 INFO:============LOGGING FRONTIERS============
2023-06-11 20:33:45,407 INFO:	 total_solved_tasks_train @ iteration 11: 185 / 191
2023-06-11 20:33:45,408 INFO:	 total_solved_tasks_test @ iteration 11: 100 / 103
2023-06-11 20:33:45,408 INFO:====================================
2023-06-11 20:33:45,408 INFO:============LOGGING MODEL_FN============
2023-06-11 20:33:45,408 INFO:	iteration: 11
2023-06-11 20:33:45,408 INFO:	task_split: train
2023-06-11 20:33:45,408 INFO:	task_batch_size: all
2023-06-11 20:33:45,408 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 20:33:45,408 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 20:33:45,408 INFO:	model_type: amortized_synthesis
2023-06-11 20:33:45,408 INFO:	experiment_block_type: model_fn
2023-06-11 20:33:45,408 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 20:33:45,408 INFO:====================================
2023-06-11 20:33:45,466 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 20:33:50,156 INFO:Attempted frontier likelihood normalization. Initial frontiers: 185. Now: 185
2023-06-11 20:33:50,157 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:33:51,098 INFO:We now have 265 Helmholtz entries.
2023-06-11 20:34:25,051 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:34:25,937 INFO:We now have 270 Helmholtz entries.
2023-06-11 20:35:03,090 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:35:04,171 INFO:We now have 271 Helmholtz entries.
2023-06-11 20:35:38,443 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:35:39,408 INFO:We now have 279 Helmholtz entries.
2023-06-11 20:36:12,863 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:36:13,794 INFO:We now have 271 Helmholtz entries.
2023-06-11 20:36:50,793 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:36:51,753 INFO:We now have 268 Helmholtz entries.
2023-06-11 20:37:25,450 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:37:26,406 INFO:We now have 280 Helmholtz entries.
2023-06-11 20:38:06,748 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:38:07,684 INFO:We now have 279 Helmholtz entries.
2023-06-11 20:38:42,956 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:38:43,890 INFO:We now have 291 Helmholtz entries.
2023-06-11 20:39:17,869 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:39:18,864 INFO:We now have 292 Helmholtz entries.
2023-06-11 20:39:53,981 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:39:55,042 INFO:We now have 295 Helmholtz entries.
2023-06-11 20:40:34,691 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:40:35,805 INFO:We now have 283 Helmholtz entries.
2023-06-11 20:41:12,038 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:41:13,033 INFO:We now have 297 Helmholtz entries.
2023-06-11 20:41:52,064 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:41:52,904 INFO:We now have 271 Helmholtz entries.
2023-06-11 20:42:27,451 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:42:28,305 INFO:We now have 255 Helmholtz entries.
2023-06-11 20:42:59,908 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:43:00,993 INFO:We now have 282 Helmholtz entries.
2023-06-11 20:43:36,250 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:43:37,311 INFO:We now have 279 Helmholtz entries.
2023-06-11 20:44:15,720 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 20:44:16,660 INFO:We now have 287 Helmholtz entries.
2023-06-11 20:44:46,331 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/11/metrics.json
2023-06-11 20:44:46,331 INFO:====================================
2023-06-11 20:44:46,331 INFO:iteration: 11
2023-06-11 20:44:46,331 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 20:44:46,331 INFO:Completed in 660.922s
2023-06-11 20:44:46,331 INFO:====================================
2023-06-11 20:44:46,331 INFO:============LOGGING MODEL_FN============
2023-06-11 20:44:46,331 INFO:	iteration: 11
2023-06-11 20:44:46,331 INFO:	task_split: train
2023-06-11 20:44:46,331 INFO:	task_batch_size: global_batch_size
2023-06-11 20:44:46,331 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 20:44:46,331 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 20:44:46,331 INFO:	model_type: amortized_synthesis
2023-06-11 20:44:46,331 INFO:	experiment_block_type: model_fn
2023-06-11 20:44:46,331 INFO:task_ids: 96 tasks: 4-2_transform-What if all the yellow cubes became large blue cubes? -- 6-1_zero_hop-There is a yellow thing; what shape is it?
2023-06-11 20:44:46,331 INFO:====================================
2023-06-11 20:45:06,162 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 21:01:51,852 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/11/metrics.json
2023-06-11 21:01:51,853 INFO:====================================
2023-06-11 21:01:51,853 INFO:iteration: 11
2023-06-11 21:01:51,853 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 21:01:51,853 INFO:Completed in 1025.520s
2023-06-11 21:01:51,853 INFO:====================================
2023-06-11 21:01:51,853 INFO:============LOGGING FRONTIERS============
2023-06-11 21:01:51,853 INFO:	 total_solved_tasks_train @ iteration 11: 185 / 191
2023-06-11 21:01:51,854 INFO:	 total_solved_tasks_test @ iteration 11: 100 / 103
2023-06-11 21:01:51,854 INFO:====================================
2023-06-11 21:01:51,930 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/11/frontiers.json===========
2023-06-11 21:01:51,931 INFO:============LOGGING MODEL_FN============
2023-06-11 21:01:51,931 INFO:	iteration: 11
2023-06-11 21:01:51,931 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 21:01:51,931 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 21:01:51,931 INFO:	model_type: library_learner
2023-06-11 21:01:51,931 INFO:	experiment_block_type: model_fn
2023-06-11 21:01:51,931 INFO:	task_batch_sizes: ['all']
2023-06-11 21:01:51,931 INFO:	task_splits: ['train']
2023-06-11 21:01:51,931 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 21:01:51,931 INFO:====================================
2023-06-11 21:03:23,753 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 21:03:25,073 INFO:reset_task_frontiers for split: train
2023-06-11 21:03:25,130 INFO:reset_samples for split: train
2023-06-11 21:03:25,131 INFO:============Syncing to AWS S3===========
2023-06-11 21:03:25,131 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 21:03:25,793 INFO:============LOGGING METADATA============
2023-06-11 21:03:25,793 INFO:	iteration: 12
2023-06-11 21:03:25,793 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 21:03:25,793 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 21:03:25,793 INFO:	curr_iteration: 0
2023-06-11 21:03:25,793 INFO:	timestamp: 
2023-06-11 21:03:25,793 INFO:	export_with_timestamp: False
2023-06-11 21:03:25,793 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 21:03:25,793 INFO:	task_language_loader: clevr_human
2023-06-11 21:03:25,793 INFO:	ocaml_special_handler: clevr
2023-06-11 21:03:25,793 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 21:03:25,793 INFO:	resume_checkpoint_directory: None
2023-06-11 21:03:25,793 INFO:	random_seed: 111
2023-06-11 21:03:25,793 INFO:	global_batch_size: 96
2023-06-11 21:03:25,793 INFO:	random_generator: Generator(PCG64)
2023-06-11 21:03:25,793 INFO:	tasks_loader: clevr
2023-06-11 21:03:25,793 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 21:03:25,793 INFO:	enumeration_timeout: 1000
2023-06-11 21:03:25,793 INFO:	experiment_name: runs_human
2023-06-11 21:03:25,793 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 21:03:25,793 INFO:	encoder: clevr
2023-06-11 21:03:25,794 INFO:	init_frontiers_every_iteration: False
2023-06-11 21:03:25,794 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 21:03:25,794 INFO:	recognition_train_steps: None
2023-06-11 21:03:25,794 INFO:	init_grammar_from_checkpoint: False
2023-06-11 21:03:25,794 INFO:====================================
2023-06-11 21:03:25,794 INFO:============LOGGING FRONTIERS============
2023-06-11 21:03:25,795 INFO:	 total_solved_tasks_train @ iteration 12: 185 / 191
2023-06-11 21:03:25,795 INFO:	 total_solved_tasks_test @ iteration 12: 100 / 103
2023-06-11 21:03:25,795 INFO:====================================
2023-06-11 21:03:25,796 INFO:============LOGGING MODEL_FN============
2023-06-11 21:03:25,796 INFO:	iteration: 12
2023-06-11 21:03:25,796 INFO:	task_split: train
2023-06-11 21:03:25,796 INFO:	task_batch_size: all
2023-06-11 21:03:25,796 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 21:03:25,796 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 21:03:25,796 INFO:	model_type: amortized_synthesis
2023-06-11 21:03:25,796 INFO:	experiment_block_type: model_fn
2023-06-11 21:03:25,796 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 21:03:25,796 INFO:====================================
2023-06-11 21:03:25,851 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 21:03:30,258 INFO:Attempted frontier likelihood normalization. Initial frontiers: 185. Now: 185
2023-06-11 21:03:30,449 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:03:31,421 INFO:We now have 285 Helmholtz entries.
2023-06-11 21:04:09,123 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:04:10,095 INFO:We now have 270 Helmholtz entries.
2023-06-11 21:04:43,841 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:04:44,803 INFO:We now have 272 Helmholtz entries.
2023-06-11 21:05:17,233 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:05:18,359 INFO:We now have 300 Helmholtz entries.
2023-06-11 21:05:53,083 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:05:54,110 INFO:We now have 284 Helmholtz entries.
2023-06-11 21:06:31,044 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:06:31,975 INFO:We now have 276 Helmholtz entries.
2023-06-11 21:07:04,831 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:07:05,857 INFO:We now have 291 Helmholtz entries.
2023-06-11 21:07:40,722 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:07:41,735 INFO:We now have 294 Helmholtz entries.
2023-06-11 21:08:18,009 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:08:18,946 INFO:We now have 262 Helmholtz entries.
2023-06-11 21:08:54,268 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:08:55,253 INFO:We now have 271 Helmholtz entries.
2023-06-11 21:09:31,232 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:09:32,224 INFO:We now have 286 Helmholtz entries.
2023-06-11 21:10:08,355 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:10:09,331 INFO:We now have 294 Helmholtz entries.
2023-06-11 21:10:45,580 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:10:46,667 INFO:We now have 281 Helmholtz entries.
2023-06-11 21:11:25,107 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:11:26,107 INFO:We now have 284 Helmholtz entries.
2023-06-11 21:12:04,291 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:12:05,320 INFO:We now have 289 Helmholtz entries.
2023-06-11 21:12:40,767 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:12:41,729 INFO:We now have 288 Helmholtz entries.
2023-06-11 21:13:20,161 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:13:21,159 INFO:We now have 298 Helmholtz entries.
2023-06-11 21:13:51,597 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:13:52,550 INFO:We now have 282 Helmholtz entries.
2023-06-11 21:14:24,095 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/12/metrics.json
2023-06-11 21:14:24,095 INFO:====================================
2023-06-11 21:14:24,095 INFO:iteration: 12
2023-06-11 21:14:24,095 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 21:14:24,095 INFO:Completed in 658.299s
2023-06-11 21:14:24,095 INFO:====================================
2023-06-11 21:14:24,095 INFO:============LOGGING MODEL_FN============
2023-06-11 21:14:24,095 INFO:	iteration: 12
2023-06-11 21:14:24,095 INFO:	task_split: train
2023-06-11 21:14:24,095 INFO:	task_batch_size: global_batch_size
2023-06-11 21:14:24,095 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 21:14:24,095 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 21:14:24,095 INFO:	model_type: amortized_synthesis
2023-06-11 21:14:24,096 INFO:	experiment_block_type: model_fn
2023-06-11 21:14:24,096 INFO:task_ids: 96 tasks: 9-1_single_or-What number of small objects are either metal cubes or red rubber things? -- 4-2_transform-What if all the yellow cubes became large blue cubes?
2023-06-11 21:14:24,096 INFO:====================================
2023-06-11 21:14:46,336 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 21:31:32,846 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/12/metrics.json
2023-06-11 21:31:32,847 INFO:====================================
2023-06-11 21:31:32,847 INFO:iteration: 12
2023-06-11 21:31:32,847 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 21:31:32,847 INFO:Completed in 1028.750s
2023-06-11 21:31:32,847 INFO:====================================
2023-06-11 21:31:32,847 INFO:============LOGGING FRONTIERS============
2023-06-11 21:31:32,847 INFO:	 total_solved_tasks_train @ iteration 12: 185 / 191
2023-06-11 21:31:32,848 INFO:	 total_solved_tasks_test @ iteration 12: 100 / 103
2023-06-11 21:31:32,848 INFO:====================================
2023-06-11 21:31:32,864 INFO:reset_task_frontiers for split: test
2023-06-11 21:31:32,864 INFO:============LOGGING MODEL_FN============
2023-06-11 21:31:32,864 INFO:	iteration: 12
2023-06-11 21:31:32,864 INFO:	task_split: test
2023-06-11 21:31:32,864 INFO:	task_batch_size: all
2023-06-11 21:31:32,864 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 21:31:32,864 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 21:31:32,864 INFO:	run_every_n_iterations: 3
2023-06-11 21:31:32,864 INFO:	model_type: amortized_synthesis
2023-06-11 21:31:32,864 INFO:	experiment_block_type: model_fn
2023-06-11 21:31:32,864 INFO:task_ids: 103 tasks: 0-1_compare_integer-Are there fewer small spheres than cyan cubes? -- 9-2_transform-If all of the large yellow cubes became small, how many large things would there be?
2023-06-11 21:31:32,864 INFO:====================================
2023-06-11 21:31:58,124 INFO:Beginning enumeration on a total of 103 tasks with a total of 96 CPUs.
2023-06-11 21:48:45,820 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/12/metrics.json
2023-06-11 21:48:45,821 INFO:====================================
2023-06-11 21:48:45,821 INFO:iteration: 12
2023-06-11 21:48:45,821 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 21:48:45,821 INFO:Completed in 1032.955s
2023-06-11 21:48:45,821 INFO:====================================
2023-06-11 21:48:45,821 INFO:============LOGGING FRONTIERS============
2023-06-11 21:48:45,822 INFO:	 total_solved_tasks_train @ iteration 12: 185 / 191
2023-06-11 21:48:45,822 INFO:	 total_solved_tasks_test @ iteration 12: 100 / 103
2023-06-11 21:48:45,822 INFO:====================================
2023-06-11 21:48:45,822 INFO:============LOGGING MODEL_FN============
2023-06-11 21:48:45,822 INFO:	iteration: 12
2023-06-11 21:48:45,822 INFO:	params: {'compute_likelihoods': True, 'compute_description_lengths': True, 'save_filename': 'test_likelihoods.json'}
2023-06-11 21:48:45,822 INFO:	model_fn: evaluate_frontiers
2023-06-11 21:48:45,822 INFO:	run_every_n_iterations: 3
2023-06-11 21:48:45,822 INFO:	model_type: grammar
2023-06-11 21:48:45,822 INFO:	experiment_block_type: model_fn
2023-06-11 21:48:45,822 INFO:	task_batch_sizes: ['all']
2023-06-11 21:48:45,822 INFO:	task_splits: ['test']
2023-06-11 21:48:45,822 INFO:task_ids test: 103 tasks: 0-1_compare_integer-Are there fewer small spheres than cyan cubes? -- 9-2_transform-If all of the large yellow cubes became small, how many large things would there be?
2023-06-11 21:48:45,822 INFO:====================================
2023-06-11 21:48:46,382 INFO:EVALUATION: evaluate_frontiers : mean log likelihood of 100 programs in splits: ['test'] is: -14.570931521061967
2023-06-11 21:48:46,382 INFO:EVALUATION: evaluate_frontiers : mean description length of 100 programs in splits: ['test'] is: 7.918000000000001
2023-06-11 21:48:46,468 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/12/frontiers.json===========
2023-06-11 21:48:46,470 INFO:============LOGGING MODEL_FN============
2023-06-11 21:48:46,470 INFO:	iteration: 12
2023-06-11 21:48:46,470 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 21:48:46,470 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 21:48:46,470 INFO:	model_type: library_learner
2023-06-11 21:48:46,470 INFO:	experiment_block_type: model_fn
2023-06-11 21:48:46,470 INFO:	task_batch_sizes: ['all']
2023-06-11 21:48:46,470 INFO:	task_splits: ['train']
2023-06-11 21:48:46,470 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 21:48:46,470 INFO:====================================
2023-06-11 21:50:22,963 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 21:50:23,957 INFO:reset_task_frontiers for split: train
2023-06-11 21:50:24,012 INFO:reset_samples for split: train
2023-06-11 21:50:24,013 INFO:============Syncing to AWS S3===========
2023-06-11 21:50:24,013 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 21:50:24,675 INFO:============LOGGING METADATA============
2023-06-11 21:50:24,675 INFO:	iteration: 13
2023-06-11 21:50:24,675 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 21:50:24,675 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 21:50:24,676 INFO:	curr_iteration: 0
2023-06-11 21:50:24,676 INFO:	timestamp: 
2023-06-11 21:50:24,676 INFO:	export_with_timestamp: False
2023-06-11 21:50:24,676 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 21:50:24,676 INFO:	task_language_loader: clevr_human
2023-06-11 21:50:24,676 INFO:	ocaml_special_handler: clevr
2023-06-11 21:50:24,676 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 21:50:24,676 INFO:	resume_checkpoint_directory: None
2023-06-11 21:50:24,676 INFO:	random_seed: 111
2023-06-11 21:50:24,676 INFO:	global_batch_size: 96
2023-06-11 21:50:24,676 INFO:	random_generator: Generator(PCG64)
2023-06-11 21:50:24,676 INFO:	tasks_loader: clevr
2023-06-11 21:50:24,676 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 21:50:24,676 INFO:	enumeration_timeout: 1000
2023-06-11 21:50:24,676 INFO:	experiment_name: runs_human
2023-06-11 21:50:24,676 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 21:50:24,676 INFO:	encoder: clevr
2023-06-11 21:50:24,676 INFO:	init_frontiers_every_iteration: False
2023-06-11 21:50:24,676 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 21:50:24,676 INFO:	recognition_train_steps: None
2023-06-11 21:50:24,676 INFO:	init_grammar_from_checkpoint: False
2023-06-11 21:50:24,676 INFO:====================================
2023-06-11 21:50:24,676 INFO:============LOGGING FRONTIERS============
2023-06-11 21:50:24,677 INFO:	 total_solved_tasks_train @ iteration 13: 185 / 191
2023-06-11 21:50:24,678 INFO:	 total_solved_tasks_test @ iteration 13: 100 / 103
2023-06-11 21:50:24,678 INFO:====================================
2023-06-11 21:50:24,678 INFO:============LOGGING MODEL_FN============
2023-06-11 21:50:24,678 INFO:	iteration: 13
2023-06-11 21:50:24,678 INFO:	task_split: train
2023-06-11 21:50:24,678 INFO:	task_batch_size: all
2023-06-11 21:50:24,678 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 21:50:24,678 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 21:50:24,678 INFO:	model_type: amortized_synthesis
2023-06-11 21:50:24,678 INFO:	experiment_block_type: model_fn
2023-06-11 21:50:24,678 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 21:50:24,678 INFO:====================================
2023-06-11 21:50:24,733 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 21:50:29,331 INFO:Attempted frontier likelihood normalization. Initial frontiers: 185. Now: 185
2023-06-11 21:50:29,498 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:50:30,537 INFO:We now have 280 Helmholtz entries.
2023-06-11 21:51:07,233 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:51:08,300 INFO:We now have 279 Helmholtz entries.
2023-06-11 21:51:45,628 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:51:46,614 INFO:We now have 276 Helmholtz entries.
2023-06-11 21:52:21,916 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:52:22,926 INFO:We now have 278 Helmholtz entries.
2023-06-11 21:53:01,106 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:53:02,066 INFO:We now have 272 Helmholtz entries.
2023-06-11 21:53:39,902 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:53:40,967 INFO:We now have 278 Helmholtz entries.
2023-06-11 21:54:15,723 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:54:16,648 INFO:We now have 268 Helmholtz entries.
2023-06-11 21:54:50,525 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:54:51,553 INFO:We now have 301 Helmholtz entries.
2023-06-11 21:55:31,759 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:55:32,647 INFO:We now have 282 Helmholtz entries.
2023-06-11 21:56:07,455 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:56:08,375 INFO:We now have 283 Helmholtz entries.
2023-06-11 21:56:45,809 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:56:46,609 INFO:We now have 277 Helmholtz entries.
2023-06-11 21:57:22,052 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:57:22,994 INFO:We now have 266 Helmholtz entries.
2023-06-11 21:57:59,124 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:58:00,267 INFO:We now have 308 Helmholtz entries.
2023-06-11 21:58:40,502 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:58:41,462 INFO:We now have 286 Helmholtz entries.
2023-06-11 21:59:14,080 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:59:15,042 INFO:We now have 270 Helmholtz entries.
2023-06-11 21:59:52,676 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 21:59:53,736 INFO:We now have 275 Helmholtz entries.
2023-06-11 22:00:28,117 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:00:29,097 INFO:We now have 289 Helmholtz entries.
2023-06-11 22:01:05,521 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:01:06,474 INFO:We now have 283 Helmholtz entries.
2023-06-11 22:01:29,736 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/13/metrics.json
2023-06-11 22:01:29,737 INFO:====================================
2023-06-11 22:01:29,737 INFO:iteration: 13
2023-06-11 22:01:29,737 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 22:01:29,737 INFO:Completed in 665.058s
2023-06-11 22:01:29,737 INFO:====================================
2023-06-11 22:01:29,737 INFO:============LOGGING MODEL_FN============
2023-06-11 22:01:29,737 INFO:	iteration: 13
2023-06-11 22:01:29,737 INFO:	task_split: train
2023-06-11 22:01:29,737 INFO:	task_batch_size: global_batch_size
2023-06-11 22:01:29,737 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 22:01:29,737 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 22:01:29,737 INFO:	model_type: amortized_synthesis
2023-06-11 22:01:29,737 INFO:	experiment_block_type: model_fn
2023-06-11 22:01:29,737 INFO:task_ids: 96 tasks: 1-1_one_hop-What number of things are right the small gray thing? -- 9-1_single_or-What number of small objects are either metal cubes or red rubber things?
2023-06-11 22:01:29,737 INFO:====================================
2023-06-11 22:01:52,444 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 22:18:37,872 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/13/metrics.json
2023-06-11 22:18:37,872 INFO:====================================
2023-06-11 22:18:37,872 INFO:iteration: 13
2023-06-11 22:18:37,872 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 22:18:37,872 INFO:Completed in 1028.134s
2023-06-11 22:18:37,872 INFO:====================================
2023-06-11 22:18:37,872 INFO:============LOGGING FRONTIERS============
2023-06-11 22:18:37,873 INFO:	 total_solved_tasks_train @ iteration 13: 186 / 191
2023-06-11 22:18:37,873 INFO:	 total_solved_tasks_test @ iteration 13: 100 / 103
2023-06-11 22:18:37,873 INFO:====================================
2023-06-11 22:18:37,951 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/13/frontiers.json===========
2023-06-11 22:18:37,952 INFO:============LOGGING MODEL_FN============
2023-06-11 22:18:37,952 INFO:	iteration: 13
2023-06-11 22:18:37,952 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 22:18:37,952 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 22:18:37,952 INFO:	model_type: library_learner
2023-06-11 22:18:37,952 INFO:	experiment_block_type: model_fn
2023-06-11 22:18:37,952 INFO:	task_batch_sizes: ['all']
2023-06-11 22:18:37,952 INFO:	task_splits: ['train']
2023-06-11 22:18:37,952 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 22:18:37,952 INFO:====================================
2023-06-11 22:20:05,871 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 22:20:06,861 INFO:reset_task_frontiers for split: train
2023-06-11 22:20:06,918 INFO:reset_samples for split: train
2023-06-11 22:20:06,918 INFO:============Syncing to AWS S3===========
2023-06-11 22:20:06,918 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 22:20:07,550 INFO:============LOGGING METADATA============
2023-06-11 22:20:07,550 INFO:	iteration: 14
2023-06-11 22:20:07,550 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 22:20:07,550 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 22:20:07,550 INFO:	curr_iteration: 0
2023-06-11 22:20:07,550 INFO:	timestamp: 
2023-06-11 22:20:07,550 INFO:	export_with_timestamp: False
2023-06-11 22:20:07,550 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 22:20:07,550 INFO:	task_language_loader: clevr_human
2023-06-11 22:20:07,550 INFO:	ocaml_special_handler: clevr
2023-06-11 22:20:07,550 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 22:20:07,550 INFO:	resume_checkpoint_directory: None
2023-06-11 22:20:07,550 INFO:	random_seed: 111
2023-06-11 22:20:07,551 INFO:	global_batch_size: 96
2023-06-11 22:20:07,551 INFO:	random_generator: Generator(PCG64)
2023-06-11 22:20:07,551 INFO:	tasks_loader: clevr
2023-06-11 22:20:07,551 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 22:20:07,551 INFO:	enumeration_timeout: 1000
2023-06-11 22:20:07,551 INFO:	experiment_name: runs_human
2023-06-11 22:20:07,551 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 22:20:07,551 INFO:	encoder: clevr
2023-06-11 22:20:07,551 INFO:	init_frontiers_every_iteration: False
2023-06-11 22:20:07,551 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 22:20:07,551 INFO:	recognition_train_steps: None
2023-06-11 22:20:07,551 INFO:	init_grammar_from_checkpoint: False
2023-06-11 22:20:07,551 INFO:====================================
2023-06-11 22:20:07,551 INFO:============LOGGING FRONTIERS============
2023-06-11 22:20:07,552 INFO:	 total_solved_tasks_train @ iteration 14: 186 / 191
2023-06-11 22:20:07,553 INFO:	 total_solved_tasks_test @ iteration 14: 100 / 103
2023-06-11 22:20:07,553 INFO:====================================
2023-06-11 22:20:07,553 INFO:============LOGGING MODEL_FN============
2023-06-11 22:20:07,553 INFO:	iteration: 14
2023-06-11 22:20:07,553 INFO:	task_split: train
2023-06-11 22:20:07,553 INFO:	task_batch_size: all
2023-06-11 22:20:07,553 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 22:20:07,553 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 22:20:07,553 INFO:	model_type: amortized_synthesis
2023-06-11 22:20:07,553 INFO:	experiment_block_type: model_fn
2023-06-11 22:20:07,553 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 22:20:07,553 INFO:====================================
2023-06-11 22:20:07,612 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 22:20:12,258 INFO:Attempted frontier likelihood normalization. Initial frontiers: 186. Now: 186
2023-06-11 22:20:12,259 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:20:13,186 INFO:We now have 267 Helmholtz entries.
2023-06-11 22:20:52,659 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:20:53,629 INFO:We now have 283 Helmholtz entries.
2023-06-11 22:21:28,525 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:21:29,496 INFO:We now have 275 Helmholtz entries.
2023-06-11 22:22:05,111 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:22:06,130 INFO:We now have 282 Helmholtz entries.
2023-06-11 22:22:43,133 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:22:44,101 INFO:We now have 280 Helmholtz entries.
2023-06-11 22:23:23,495 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:23:24,484 INFO:We now have 274 Helmholtz entries.
2023-06-11 22:24:00,222 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:24:01,194 INFO:We now have 283 Helmholtz entries.
2023-06-11 22:24:39,909 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:24:40,986 INFO:We now have 288 Helmholtz entries.
2023-06-11 22:25:16,109 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:25:17,396 INFO:We now have 283 Helmholtz entries.
2023-06-11 22:25:56,247 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:25:57,275 INFO:We now have 288 Helmholtz entries.
2023-06-11 22:26:35,038 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:26:35,975 INFO:We now have 296 Helmholtz entries.
2023-06-11 22:27:12,593 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:27:13,575 INFO:We now have 277 Helmholtz entries.
2023-06-11 22:27:48,020 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:27:48,961 INFO:We now have 258 Helmholtz entries.
2023-06-11 22:28:19,871 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:28:20,942 INFO:We now have 297 Helmholtz entries.
2023-06-11 22:29:02,356 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:29:03,259 INFO:We now have 278 Helmholtz entries.
2023-06-11 22:29:38,960 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:29:39,861 INFO:We now have 281 Helmholtz entries.
2023-06-11 22:30:16,967 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:30:17,995 INFO:We now have 273 Helmholtz entries.
2023-06-11 22:30:53,592 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:30:54,740 INFO:We now have 289 Helmholtz entries.
2023-06-11 22:31:11,487 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/14/metrics.json
2023-06-11 22:31:11,487 INFO:====================================
2023-06-11 22:31:11,487 INFO:iteration: 14
2023-06-11 22:31:11,487 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 22:31:11,487 INFO:Completed in 663.933s
2023-06-11 22:31:11,487 INFO:====================================
2023-06-11 22:31:11,487 INFO:============LOGGING MODEL_FN============
2023-06-11 22:31:11,487 INFO:	iteration: 14
2023-06-11 22:31:11,487 INFO:	task_split: train
2023-06-11 22:31:11,487 INFO:	task_batch_size: global_batch_size
2023-06-11 22:31:11,487 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 22:31:11,487 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 22:31:11,487 INFO:	model_type: amortized_synthesis
2023-06-11 22:31:11,487 INFO:	experiment_block_type: model_fn
2023-06-11 22:31:11,487 INFO:task_ids: 96 tasks: 8-1_one_hop-There is a metal thing that is behind the metal sphere; what size is it? -- 1-1_one_hop-What number of things are right the small gray thing?
2023-06-11 22:31:11,487 INFO:====================================
2023-06-11 22:31:34,045 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 22:48:19,851 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/14/metrics.json
2023-06-11 22:48:19,851 INFO:====================================
2023-06-11 22:48:19,851 INFO:iteration: 14
2023-06-11 22:48:19,851 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 22:48:19,851 INFO:Completed in 1028.363s
2023-06-11 22:48:19,851 INFO:====================================
2023-06-11 22:48:19,851 INFO:============LOGGING FRONTIERS============
2023-06-11 22:48:19,852 INFO:	 total_solved_tasks_train @ iteration 14: 186 / 191
2023-06-11 22:48:19,852 INFO:	 total_solved_tasks_test @ iteration 14: 100 / 103
2023-06-11 22:48:19,852 INFO:====================================
2023-06-11 22:48:19,930 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/14/frontiers.json===========
2023-06-11 22:48:19,931 INFO:============LOGGING MODEL_FN============
2023-06-11 22:48:19,931 INFO:	iteration: 14
2023-06-11 22:48:19,931 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 22:48:19,931 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 22:48:19,931 INFO:	model_type: library_learner
2023-06-11 22:48:19,931 INFO:	experiment_block_type: model_fn
2023-06-11 22:48:19,932 INFO:	task_batch_sizes: ['all']
2023-06-11 22:48:19,932 INFO:	task_splits: ['train']
2023-06-11 22:48:19,932 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 22:48:19,932 INFO:====================================
2023-06-11 22:49:48,246 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 22:49:49,240 INFO:reset_task_frontiers for split: train
2023-06-11 22:49:49,296 INFO:reset_samples for split: train
2023-06-11 22:49:49,296 INFO:============Syncing to AWS S3===========
2023-06-11 22:49:49,296 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
2023-06-11 22:49:49,961 INFO:============LOGGING METADATA============
2023-06-11 22:49:49,961 INFO:	iteration: 15
2023-06-11 22:49:49,961 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-11 22:49:49,961 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-11 22:49:49,961 INFO:	curr_iteration: 0
2023-06-11 22:49:49,961 INFO:	timestamp: 
2023-06-11 22:49:49,961 INFO:	export_with_timestamp: False
2023-06-11 22:49:49,961 INFO:	init_frontiers_from_checkpoint: False
2023-06-11 22:49:49,961 INFO:	task_language_loader: clevr_human
2023-06-11 22:49:49,962 INFO:	ocaml_special_handler: clevr
2023-06-11 22:49:49,962 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-11 22:49:49,962 INFO:	resume_checkpoint_directory: None
2023-06-11 22:49:49,962 INFO:	random_seed: 111
2023-06-11 22:49:49,962 INFO:	global_batch_size: 96
2023-06-11 22:49:49,962 INFO:	random_generator: Generator(PCG64)
2023-06-11 22:49:49,962 INFO:	tasks_loader: clevr
2023-06-11 22:49:49,962 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 22:49:49,962 INFO:	enumeration_timeout: 1000
2023-06-11 22:49:49,962 INFO:	experiment_name: runs_human
2023-06-11 22:49:49,962 INFO:	dsl_description_prefix: This is a domain-specific language for CLEVR: A Diagnostic Dataset for Compositional Language and Elementary Visual Reasoning.
2023-06-11 22:49:49,962 INFO:	encoder: clevr
2023-06-11 22:49:49,962 INFO:	init_frontiers_every_iteration: False
2023-06-11 22:49:49,962 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96
2023-06-11 22:49:49,962 INFO:	recognition_train_steps: None
2023-06-11 22:49:49,962 INFO:	init_grammar_from_checkpoint: False
2023-06-11 22:49:49,962 INFO:====================================
2023-06-11 22:49:49,962 INFO:============LOGGING FRONTIERS============
2023-06-11 22:49:49,963 INFO:	 total_solved_tasks_train @ iteration 15: 186 / 191
2023-06-11 22:49:49,964 INFO:	 total_solved_tasks_test @ iteration 15: 100 / 103
2023-06-11 22:49:49,964 INFO:====================================
2023-06-11 22:49:49,964 INFO:============LOGGING MODEL_FN============
2023-06-11 22:49:49,964 INFO:	iteration: 15
2023-06-11 22:49:49,964 INFO:	task_split: train
2023-06-11 22:49:49,964 INFO:	task_batch_size: all
2023-06-11 22:49:49,964 INFO:	params: {'recognition_train_steps': 10000}
2023-06-11 22:49:49,964 INFO:	model_fn: optimize_model_for_frontiers
2023-06-11 22:49:49,964 INFO:	model_type: amortized_synthesis
2023-06-11 22:49:49,964 INFO:	experiment_block_type: model_fn
2023-06-11 22:49:49,964 INFO:task_ids: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 22:49:49,964 INFO:====================================
2023-06-11 22:49:50,021 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-11 22:49:54,647 INFO:Attempted frontier likelihood normalization. Initial frontiers: 186. Now: 186
2023-06-11 22:49:54,647 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:49:55,607 INFO:We now have 286 Helmholtz entries.
2023-06-11 22:50:34,670 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:50:35,740 INFO:We now have 281 Helmholtz entries.
2023-06-11 22:51:15,455 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:51:16,422 INFO:We now have 285 Helmholtz entries.
2023-06-11 22:51:52,166 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:51:53,508 INFO:We now have 281 Helmholtz entries.
2023-06-11 22:52:30,028 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:52:30,961 INFO:We now have 282 Helmholtz entries.
2023-06-11 22:53:06,509 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:53:07,418 INFO:We now have 282 Helmholtz entries.
2023-06-11 22:53:41,547 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:53:42,613 INFO:We now have 279 Helmholtz entries.
2023-06-11 22:54:17,736 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:54:18,741 INFO:We now have 294 Helmholtz entries.
2023-06-11 22:54:56,192 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:54:57,373 INFO:We now have 288 Helmholtz entries.
2023-06-11 22:55:35,748 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:55:36,698 INFO:We now have 282 Helmholtz entries.
2023-06-11 22:56:12,080 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:56:12,881 INFO:We now have 276 Helmholtz entries.
2023-06-11 22:56:44,751 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:56:45,594 INFO:We now have 269 Helmholtz entries.
2023-06-11 22:57:21,197 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:57:22,069 INFO:We now have 289 Helmholtz entries.
2023-06-11 22:58:02,534 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:58:03,391 INFO:We now have 284 Helmholtz entries.
2023-06-11 22:58:41,469 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:58:42,378 INFO:We now have 295 Helmholtz entries.
2023-06-11 22:59:17,664 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:59:18,639 INFO:We now have 279 Helmholtz entries.
2023-06-11 22:59:54,117 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 22:59:55,001 INFO:We now have 296 Helmholtz entries.
2023-06-11 23:00:32,687 INFO:Sampling new helmholtz frontiers during training.
2023-06-11 23:00:33,699 INFO:We now have 292 Helmholtz entries.
2023-06-11 23:00:53,307 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/15/metrics.json
2023-06-11 23:00:53,307 INFO:====================================
2023-06-11 23:00:53,307 INFO:iteration: 15
2023-06-11 23:00:53,307 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-11 23:00:53,307 INFO:Completed in 663.342s
2023-06-11 23:00:53,307 INFO:====================================
2023-06-11 23:00:53,307 INFO:============LOGGING MODEL_FN============
2023-06-11 23:00:53,307 INFO:	iteration: 15
2023-06-11 23:00:53,307 INFO:	task_split: train
2023-06-11 23:00:53,307 INFO:	task_batch_size: global_batch_size
2023-06-11 23:00:53,307 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 23:00:53,307 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 23:00:53,307 INFO:	model_type: amortized_synthesis
2023-06-11 23:00:53,307 INFO:	experiment_block_type: model_fn
2023-06-11 23:00:53,307 INFO:task_ids: 96 tasks: 21-1_single_or-What number of spheres are small gray things or small metal things? -- 8-1_one_hop-There is a metal thing that is behind the metal sphere; what size is it?
2023-06-11 23:00:53,307 INFO:====================================
2023-06-11 23:01:15,979 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-11 23:18:01,275 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/15/metrics.json
2023-06-11 23:18:01,275 INFO:====================================
2023-06-11 23:18:01,275 INFO:iteration: 15
2023-06-11 23:18:01,275 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 23:18:01,275 INFO:Completed in 1027.967s
2023-06-11 23:18:01,275 INFO:====================================
2023-06-11 23:18:01,275 INFO:============LOGGING FRONTIERS============
2023-06-11 23:18:01,276 INFO:	 total_solved_tasks_train @ iteration 15: 186 / 191
2023-06-11 23:18:01,276 INFO:	 total_solved_tasks_test @ iteration 15: 100 / 103
2023-06-11 23:18:01,276 INFO:====================================
2023-06-11 23:18:01,294 INFO:reset_task_frontiers for split: test
2023-06-11 23:18:01,294 INFO:============LOGGING MODEL_FN============
2023-06-11 23:18:01,294 INFO:	iteration: 15
2023-06-11 23:18:01,294 INFO:	task_split: test
2023-06-11 23:18:01,294 INFO:	task_batch_size: all
2023-06-11 23:18:01,294 INFO:	params: {'enumeration_timeout': 1000}
2023-06-11 23:18:01,294 INFO:	model_fn: infer_programs_for_tasks
2023-06-11 23:18:01,294 INFO:	run_every_n_iterations: 3
2023-06-11 23:18:01,294 INFO:	model_type: amortized_synthesis
2023-06-11 23:18:01,294 INFO:	experiment_block_type: model_fn
2023-06-11 23:18:01,294 INFO:task_ids: 103 tasks: 0-1_compare_integer-Are there fewer small spheres than cyan cubes? -- 9-2_transform-If all of the large yellow cubes became small, how many large things would there be?
2023-06-11 23:18:01,294 INFO:====================================
2023-06-11 23:18:25,639 INFO:Beginning enumeration on a total of 103 tasks with a total of 96 CPUs.
2023-06-11 23:35:12,819 INFO:Wrote experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/15/metrics.json
2023-06-11 23:35:12,819 INFO:====================================
2023-06-11 23:35:12,819 INFO:iteration: 15
2023-06-11 23:35:12,819 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-11 23:35:12,819 INFO:Completed in 1031.524s
2023-06-11 23:35:12,820 INFO:====================================
2023-06-11 23:35:12,820 INFO:============LOGGING FRONTIERS============
2023-06-11 23:35:12,820 INFO:	 total_solved_tasks_train @ iteration 15: 186 / 191
2023-06-11 23:35:12,820 INFO:	 total_solved_tasks_test @ iteration 15: 101 / 103
2023-06-11 23:35:12,821 INFO:====================================
2023-06-11 23:35:12,821 INFO:============LOGGING MODEL_FN============
2023-06-11 23:35:12,821 INFO:	iteration: 15
2023-06-11 23:35:12,821 INFO:	params: {'compute_likelihoods': True, 'compute_description_lengths': True, 'save_filename': 'test_likelihoods.json'}
2023-06-11 23:35:12,821 INFO:	model_fn: evaluate_frontiers
2023-06-11 23:35:12,821 INFO:	run_every_n_iterations: 3
2023-06-11 23:35:12,821 INFO:	model_type: grammar
2023-06-11 23:35:12,821 INFO:	experiment_block_type: model_fn
2023-06-11 23:35:12,821 INFO:	task_batch_sizes: ['all']
2023-06-11 23:35:12,821 INFO:	task_splits: ['test']
2023-06-11 23:35:12,821 INFO:task_ids test: 103 tasks: 0-1_compare_integer-Are there fewer small spheres than cyan cubes? -- 9-2_transform-If all of the large yellow cubes became small, how many large things would there be?
2023-06-11 23:35:12,821 INFO:====================================
2023-06-11 23:35:13,393 INFO:EVALUATION: evaluate_frontiers : mean log likelihood of 101 programs in splits: ['test'] is: -15.111586116481108
2023-06-11 23:35:13,393 INFO:EVALUATION: evaluate_frontiers : mean description length of 101 programs in splits: ['test'] is: 8.162376237623763
2023-06-11 23:35:13,471 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111/baseline_dreamcoder_96/15/frontiers.json===========
2023-06-11 23:35:13,473 INFO:============LOGGING MODEL_FN============
2023-06-11 23:35:13,473 INFO:	iteration: 15
2023-06-11 23:35:13,473 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-11 23:35:13,473 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-11 23:35:13,473 INFO:	model_type: library_learner
2023-06-11 23:35:13,473 INFO:	experiment_block_type: model_fn
2023-06-11 23:35:13,473 INFO:	task_batch_sizes: ['all']
2023-06-11 23:35:13,473 INFO:	task_splits: ['train']
2023-06-11 23:35:13,473 INFO:task_ids train: 191 tasks: 5-2_transform-What if all the blue metal things became rubber things? -- 18-1_single_or-What number of rubber objects are purple things or cylinders?
2023-06-11 23:35:13,473 INFO:====================================
2023-06-11 23:36:41,991 INFO:Updated grammar (productions=54) with 10 new abstractions.
2023-06-11 23:36:43,068 INFO:reset_task_frontiers for split: train
2023-06-11 23:36:43,125 INFO:reset_samples for split: train
2023-06-11 23:36:43,125 INFO:============Syncing to AWS S3===========
2023-06-11 23:36:43,126 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/clevr_human/baseline_dreamcoder/seed_111
