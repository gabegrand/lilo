2023-06-12 15:33:18,803 INFO:============LOGGING METADATA============
2023-06-12 15:33:18,803 INFO:	iteration: 0
2023-06-12 15:33:18,803 INFO:	tasks_loader: re2
2023-06-12 15:33:18,803 INFO:	enumeration_timeout: 1000
2023-06-12 15:33:18,803 INFO:	curr_iteration: 0
2023-06-12 15:33:18,803 INFO:	init_frontiers_every_iteration: False
2023-06-12 15:33:18,804 INFO:	random_generator: Generator(PCG64)
2023-06-12 15:33:18,804 INFO:	dsl_description_prefix: This is a domain-specific language for regular expressions that specify string transformations.
2023-06-12 15:33:18,804 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-12 15:33:18,804 INFO:	resume_checkpoint_directory: None
2023-06-12 15:33:18,804 INFO:	recognition_train_steps: None
2023-06-12 15:33:18,804 INFO:	init_grammar_from_checkpoint: False
2023-06-12 15:33:18,804 INFO:	experiment_name: runs_human
2023-06-12 15:33:18,804 INFO:	timestamp: 
2023-06-12 15:33:18,804 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96
2023-06-12 15:33:18,804 INFO:	ocaml_special_handler: re2
2023-06-12 15:33:18,804 INFO:	encoder: re2
2023-06-12 15:33:18,804 INFO:	init_frontiers_from_checkpoint: False
2023-06-12 15:33:18,804 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96
2023-06-12 15:33:18,804 INFO:	random_seed: 333
2023-06-12 15:33:18,804 INFO:	export_with_timestamp: False
2023-06-12 15:33:18,804 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-12 15:33:18,804 INFO:	task_language_loader: re2_human
2023-06-12 15:33:18,804 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-12 15:33:18,804 INFO:	global_batch_size: 96
2023-06-12 15:33:18,804 INFO:====================================
2023-06-12 15:33:18,804 INFO:============LOGGING FRONTIERS============
2023-06-12 15:33:18,804 INFO:	 total_solved_tasks_train @ iteration 0: 0 / 491
2023-06-12 15:33:18,805 INFO:	 total_solved_tasks_test @ iteration 0: 0 / 500
2023-06-12 15:33:18,805 INFO:====================================
2023-06-12 15:33:18,805 INFO:============LOGGING MODEL_FN============
2023-06-12 15:33:18,805 INFO:	iteration: 0
2023-06-12 15:33:18,805 INFO:	experiment_block_type: model_fn
2023-06-12 15:33:18,805 INFO:	params: {'enumeration_timeout': 1000, 'compute_likelihoods': True}
2023-06-12 15:33:18,805 INFO:	task_split: train
2023-06-12 15:33:18,805 INFO:	task_batch_size: global_batch_size
2023-06-12 15:33:18,805 INFO:	model_fn: infer_programs_for_tasks
2023-06-12 15:33:18,805 INFO:	run_every_n_iterations: 1000
2023-06-12 15:33:18,805 INFO:	model_type: grammar
2023-06-12 15:33:18,805 INFO:task_ids: 96 tasks: re2_train_400_if_there_is_any_letter_vowel_add_p_before_that -- re2_train_442_if_there_is_any_letter_replace_that_with_h_r
2023-06-12 15:33:18,805 INFO:====================================
2023-06-12 15:33:18,806 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-12 15:49:59,198 INFO:Wrote experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/0/metrics.json
2023-06-12 15:49:59,198 INFO:====================================
2023-06-12 15:49:59,198 INFO:iteration: 0
2023-06-12 15:49:59,198 INFO:grammar : infer_programs_for_tasks
2023-06-12 15:49:59,198 INFO:Completed in 1000.392s
2023-06-12 15:49:59,198 INFO:====================================
2023-06-12 15:49:59,199 INFO:============LOGGING FRONTIERS============
2023-06-12 15:49:59,200 INFO:	 total_solved_tasks_train @ iteration 0: 21 / 491
2023-06-12 15:49:59,201 INFO:	 total_solved_tasks_test @ iteration 0: 0 / 500
2023-06-12 15:49:59,201 INFO:====================================
2023-06-12 15:49:59,201 INFO:============LOGGING MODEL_FN============
2023-06-12 15:49:59,201 INFO:	iteration: 0
2023-06-12 15:49:59,201 INFO:	experiment_block_type: model_fn
2023-06-12 15:49:59,201 INFO:	params: {'recognition_train_steps': 10000}
2023-06-12 15:49:59,201 INFO:	task_split: train
2023-06-12 15:49:59,201 INFO:	task_batch_size: all
2023-06-12 15:49:59,201 INFO:	model_fn: optimize_model_for_frontiers
2023-06-12 15:49:59,201 INFO:	model_type: amortized_synthesis
2023-06-12 15:49:59,201 INFO:task_ids: 491 tasks: re2_train_400_if_there_is_any_letter_vowel_add_p_before_that -- re2_train_290_if_the_word_ends_with_consonant_any_letter_replace_that_with_e_x
2023-06-12 15:49:59,201 INFO:====================================
2023-06-12 15:49:59,238 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-12 15:49:59,517 INFO:Attempted frontier likelihood normalization. Initial frontiers: 21. Now: 21
2023-06-12 15:49:59,546 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 15:50:01,686 INFO:We now have 495 Helmholtz entries.
2023-06-12 15:50:21,482 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 15:50:23,523 INFO:We now have 493 Helmholtz entries.
2023-06-12 15:50:42,174 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 15:50:44,214 INFO:We now have 498 Helmholtz entries.
2023-06-12 15:51:04,440 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 15:51:06,808 INFO:We now have 497 Helmholtz entries.
2023-06-12 15:51:27,933 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 15:51:30,162 INFO:We now have 497 Helmholtz entries.
2023-06-12 15:51:49,006 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 15:51:51,240 INFO:We now have 497 Helmholtz entries.
2023-06-12 15:52:12,315 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 15:52:14,385 INFO:We now have 497 Helmholtz entries.
2023-06-12 15:52:35,028 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 15:52:36,967 INFO:We now have 496 Helmholtz entries.
2023-06-12 15:52:57,670 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 15:52:59,667 INFO:We now have 499 Helmholtz entries.
2023-06-12 15:53:20,116 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 15:53:22,221 INFO:We now have 500 Helmholtz entries.
2023-06-12 15:53:43,216 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 15:53:45,255 INFO:We now have 500 Helmholtz entries.
2023-06-12 15:53:48,351 INFO:Wrote experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/0/metrics.json
2023-06-12 15:53:48,351 INFO:====================================
2023-06-12 15:53:48,351 INFO:iteration: 0
2023-06-12 15:53:48,351 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-12 15:53:48,351 INFO:Completed in 229.148s
2023-06-12 15:53:48,351 INFO:====================================
2023-06-12 15:53:48,351 INFO:============LOGGING MODEL_FN============
2023-06-12 15:53:48,351 INFO:	iteration: 0
2023-06-12 15:53:48,351 INFO:	experiment_block_type: model_fn
2023-06-12 15:53:48,351 INFO:	params: {'enumeration_timeout': 1000}
2023-06-12 15:53:48,351 INFO:	task_split: train
2023-06-12 15:53:48,351 INFO:	task_batch_size: global_batch_size
2023-06-12 15:53:48,351 INFO:	model_fn: infer_programs_for_tasks
2023-06-12 15:53:48,351 INFO:	model_type: amortized_synthesis
2023-06-12 15:53:48,351 INFO:task_ids: 96 tasks: re2_train_400_if_there_is_any_letter_vowel_add_p_before_that -- re2_train_442_if_there_is_any_letter_replace_that_with_h_r
2023-06-12 15:53:48,351 INFO:====================================
2023-06-12 15:53:51,840 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-12 16:10:40,242 INFO:Wrote experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/0/metrics.json
2023-06-12 16:10:40,242 INFO:====================================
2023-06-12 16:10:40,242 INFO:iteration: 0
2023-06-12 16:10:40,242 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-12 16:10:40,242 INFO:Completed in 1011.890s
2023-06-12 16:10:40,242 INFO:====================================
2023-06-12 16:10:40,242 INFO:============LOGGING FRONTIERS============
2023-06-12 16:10:40,244 INFO:	 total_solved_tasks_train @ iteration 0: 22 / 491
2023-06-12 16:10:40,245 INFO:	 total_solved_tasks_test @ iteration 0: 0 / 500
2023-06-12 16:10:40,245 INFO:====================================
2023-06-12 16:10:40,246 INFO:reset_task_frontiers for split: test
2023-06-12 16:10:40,246 INFO:============LOGGING MODEL_FN============
2023-06-12 16:10:40,246 INFO:	iteration: 0
2023-06-12 16:10:40,246 INFO:	experiment_block_type: model_fn
2023-06-12 16:10:40,246 INFO:	params: {'enumeration_timeout': 1000}
2023-06-12 16:10:40,246 INFO:	task_split: test
2023-06-12 16:10:40,246 INFO:	task_batch_size: all
2023-06-12 16:10:40,246 INFO:	model_fn: infer_programs_for_tasks
2023-06-12 16:10:40,246 INFO:	run_every_n_iterations: 3
2023-06-12 16:10:40,246 INFO:	model_type: amortized_synthesis
2023-06-12 16:10:40,246 INFO:task_ids: 500 tasks: re2_test_0_if_the_word_ends_with_s_replace_that_with_m -- re2_test_499_if_there_is_consonant_replace_that_with_q_f
2023-06-12 16:10:40,246 INFO:====================================
2023-06-12 16:10:58,111 INFO:Beginning enumeration on a total of 500 tasks with a total of 96 CPUs.
2023-06-12 17:36:14,849 INFO:Wrote experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/0/metrics.json
2023-06-12 17:36:14,849 INFO:====================================
2023-06-12 17:36:14,849 INFO:iteration: 0
2023-06-12 17:36:14,849 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-12 17:36:14,849 INFO:Completed in 5134.601s
2023-06-12 17:36:14,849 INFO:====================================
2023-06-12 17:36:14,849 INFO:============LOGGING FRONTIERS============
2023-06-12 17:36:14,851 INFO:	 total_solved_tasks_train @ iteration 0: 22 / 491
2023-06-12 17:36:14,851 INFO:	 total_solved_tasks_test @ iteration 0: 93 / 500
2023-06-12 17:36:14,851 INFO:====================================
2023-06-12 17:36:14,851 INFO:============LOGGING MODEL_FN============
2023-06-12 17:36:14,851 INFO:	iteration: 0
2023-06-12 17:36:14,851 INFO:	task_splits: ['test']
2023-06-12 17:36:14,852 INFO:	experiment_block_type: model_fn
2023-06-12 17:36:14,852 INFO:	params: {'compute_likelihoods': True, 'compute_description_lengths': True, 'save_filename': 'test_likelihoods.json'}
2023-06-12 17:36:14,852 INFO:	model_fn: evaluate_frontiers
2023-06-12 17:36:14,852 INFO:	task_batch_sizes: ['all']
2023-06-12 17:36:14,852 INFO:	run_every_n_iterations: 3
2023-06-12 17:36:14,852 INFO:	model_type: grammar
2023-06-12 17:36:14,852 INFO:task_ids test: 500 tasks: re2_test_0_if_the_word_ends_with_s_replace_that_with_m -- re2_test_499_if_there_is_consonant_replace_that_with_q_f
2023-06-12 17:36:14,852 INFO:====================================
2023-06-12 17:36:15,467 INFO:EVALUATION: evaluate_frontiers : mean log likelihood of 93 programs in splits: ['test'] is: -24.621439232997766
2023-06-12 17:36:15,468 INFO:EVALUATION: evaluate_frontiers : mean description length of 93 programs in splits: ['test'] is: 10.033154121863799
2023-06-12 17:36:15,547 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/0/frontiers.json===========
2023-06-12 17:36:15,548 INFO:============LOGGING MODEL_FN============
2023-06-12 17:36:15,548 INFO:	iteration: 0
2023-06-12 17:36:15,548 INFO:	task_splits: ['train']
2023-06-12 17:36:15,548 INFO:	experiment_block_type: model_fn
2023-06-12 17:36:15,548 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-12 17:36:15,548 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-12 17:36:15,548 INFO:	task_batch_sizes: ['all']
2023-06-12 17:36:15,548 INFO:	model_type: library_learner
2023-06-12 17:36:15,548 INFO:task_ids train: 491 tasks: re2_train_400_if_there_is_any_letter_vowel_add_p_before_that -- re2_train_290_if_the_word_ends_with_consonant_any_letter_replace_that_with_e_x
2023-06-12 17:36:15,548 INFO:====================================
2023-06-12 17:36:16,312 INFO:Updated grammar (productions=42) with 10 new abstractions.
2023-06-12 17:36:16,428 INFO:reset_task_frontiers for split: train
2023-06-12 17:36:16,431 INFO:reset_samples for split: train
2023-06-12 17:36:16,431 INFO:============Syncing to AWS S3===========
2023-06-12 17:36:16,431 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333
2023-06-12 17:36:17,204 INFO:============LOGGING METADATA============
2023-06-12 17:36:17,205 INFO:	iteration: 1
2023-06-12 17:36:17,205 INFO:	tasks_loader: re2
2023-06-12 17:36:17,205 INFO:	enumeration_timeout: 1000
2023-06-12 17:36:17,205 INFO:	curr_iteration: 0
2023-06-12 17:36:17,205 INFO:	init_frontiers_every_iteration: False
2023-06-12 17:36:17,205 INFO:	random_generator: Generator(PCG64)
2023-06-12 17:36:17,205 INFO:	dsl_description_prefix: This is a domain-specific language for regular expressions that specify string transformations.
2023-06-12 17:36:17,205 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-12 17:36:17,205 INFO:	resume_checkpoint_directory: None
2023-06-12 17:36:17,205 INFO:	recognition_train_steps: None
2023-06-12 17:36:17,205 INFO:	init_grammar_from_checkpoint: False
2023-06-12 17:36:17,205 INFO:	experiment_name: runs_human
2023-06-12 17:36:17,205 INFO:	timestamp: 
2023-06-12 17:36:17,205 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96
2023-06-12 17:36:17,205 INFO:	ocaml_special_handler: re2
2023-06-12 17:36:17,205 INFO:	encoder: re2
2023-06-12 17:36:17,205 INFO:	init_frontiers_from_checkpoint: False
2023-06-12 17:36:17,205 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96
2023-06-12 17:36:17,205 INFO:	random_seed: 333
2023-06-12 17:36:17,205 INFO:	export_with_timestamp: False
2023-06-12 17:36:17,205 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-12 17:36:17,205 INFO:	task_language_loader: re2_human
2023-06-12 17:36:17,205 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-12 17:36:17,205 INFO:	global_batch_size: 96
2023-06-12 17:36:17,205 INFO:====================================
2023-06-12 17:36:17,205 INFO:============LOGGING FRONTIERS============
2023-06-12 17:36:17,208 INFO:	 total_solved_tasks_train @ iteration 1: 22 / 491
2023-06-12 17:36:17,209 INFO:	 total_solved_tasks_test @ iteration 1: 93 / 500
2023-06-12 17:36:17,209 INFO:====================================
2023-06-12 17:36:17,209 INFO:============LOGGING MODEL_FN============
2023-06-12 17:36:17,209 INFO:	iteration: 1
2023-06-12 17:36:17,209 INFO:	experiment_block_type: model_fn
2023-06-12 17:36:17,209 INFO:	params: {'recognition_train_steps': 10000}
2023-06-12 17:36:17,209 INFO:	task_split: train
2023-06-12 17:36:17,209 INFO:	task_batch_size: all
2023-06-12 17:36:17,209 INFO:	model_fn: optimize_model_for_frontiers
2023-06-12 17:36:17,210 INFO:	model_type: amortized_synthesis
2023-06-12 17:36:17,210 INFO:task_ids: 491 tasks: re2_train_400_if_there_is_any_letter_vowel_add_p_before_that -- re2_train_290_if_the_word_ends_with_consonant_any_letter_replace_that_with_e_x
2023-06-12 17:36:17,210 INFO:====================================
2023-06-12 17:36:17,249 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-12 17:36:17,607 INFO:Attempted frontier likelihood normalization. Initial frontiers: 22. Now: 22
2023-06-12 17:36:17,608 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:36:19,366 INFO:We now have 489 Helmholtz entries.
2023-06-12 17:36:46,022 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:36:47,848 INFO:We now have 490 Helmholtz entries.
2023-06-12 17:37:11,082 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:37:12,824 INFO:We now have 486 Helmholtz entries.
2023-06-12 17:37:34,650 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:37:36,480 INFO:We now have 484 Helmholtz entries.
2023-06-12 17:37:59,187 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:38:01,019 INFO:We now have 483 Helmholtz entries.
2023-06-12 17:38:24,998 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:38:26,831 INFO:We now have 491 Helmholtz entries.
2023-06-12 17:38:50,399 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:38:52,293 INFO:We now have 492 Helmholtz entries.
2023-06-12 17:39:15,725 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:39:17,531 INFO:We now have 492 Helmholtz entries.
2023-06-12 17:39:40,991 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:39:42,850 INFO:We now have 485 Helmholtz entries.
2023-06-12 17:40:06,205 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:40:07,932 INFO:We now have 491 Helmholtz entries.
2023-06-12 17:40:30,964 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:40:32,782 INFO:We now have 493 Helmholtz entries.
2023-06-12 17:40:41,464 INFO:Wrote experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/1/metrics.json
2023-06-12 17:40:41,464 INFO:====================================
2023-06-12 17:40:41,464 INFO:iteration: 1
2023-06-12 17:40:41,464 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-12 17:40:41,464 INFO:Completed in 264.254s
2023-06-12 17:40:41,464 INFO:====================================
2023-06-12 17:40:41,464 INFO:============LOGGING MODEL_FN============
2023-06-12 17:40:41,464 INFO:	iteration: 1
2023-06-12 17:40:41,464 INFO:	experiment_block_type: model_fn
2023-06-12 17:40:41,465 INFO:	params: {'enumeration_timeout': 1000}
2023-06-12 17:40:41,465 INFO:	task_split: train
2023-06-12 17:40:41,465 INFO:	task_batch_size: global_batch_size
2023-06-12 17:40:41,465 INFO:	model_fn: infer_programs_for_tasks
2023-06-12 17:40:41,465 INFO:	model_type: amortized_synthesis
2023-06-12 17:40:41,465 INFO:task_ids: 96 tasks: re2_train_105_if_there_is_vowel_any_letter_replace_that_with_j_r -- re2_train_30_if_the_word_ends_with_n_any_letter_replace_that_with_v
2023-06-12 17:40:41,465 INFO:====================================
2023-06-12 17:40:50,812 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-12 17:57:39,206 INFO:Wrote experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/1/metrics.json
2023-06-12 17:57:39,206 INFO:====================================
2023-06-12 17:57:39,206 INFO:iteration: 1
2023-06-12 17:57:39,206 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-12 17:57:39,207 INFO:Completed in 1017.741s
2023-06-12 17:57:39,207 INFO:====================================
2023-06-12 17:57:39,207 INFO:============LOGGING FRONTIERS============
2023-06-12 17:57:39,208 INFO:	 total_solved_tasks_train @ iteration 1: 37 / 491
2023-06-12 17:57:39,210 INFO:	 total_solved_tasks_test @ iteration 1: 93 / 500
2023-06-12 17:57:39,210 INFO:====================================
2023-06-12 17:57:39,294 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/1/frontiers.json===========
2023-06-12 17:57:39,295 INFO:============LOGGING MODEL_FN============
2023-06-12 17:57:39,295 INFO:	iteration: 1
2023-06-12 17:57:39,295 INFO:	task_splits: ['train']
2023-06-12 17:57:39,295 INFO:	experiment_block_type: model_fn
2023-06-12 17:57:39,296 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-12 17:57:39,296 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-12 17:57:39,296 INFO:	task_batch_sizes: ['all']
2023-06-12 17:57:39,296 INFO:	model_type: library_learner
2023-06-12 17:57:39,296 INFO:task_ids train: 491 tasks: re2_train_400_if_there_is_any_letter_vowel_add_p_before_that -- re2_train_290_if_the_word_ends_with_consonant_any_letter_replace_that_with_e_x
2023-06-12 17:57:39,296 INFO:====================================
2023-06-12 17:57:40,688 INFO:Updated grammar (productions=42) with 10 new abstractions.
2023-06-12 17:57:40,873 INFO:reset_task_frontiers for split: train
2023-06-12 17:57:40,878 INFO:reset_samples for split: train
2023-06-12 17:57:40,878 INFO:============Syncing to AWS S3===========
2023-06-12 17:57:40,878 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333
2023-06-12 17:57:41,732 INFO:============LOGGING METADATA============
2023-06-12 17:57:41,732 INFO:	iteration: 2
2023-06-12 17:57:41,732 INFO:	tasks_loader: re2
2023-06-12 17:57:41,732 INFO:	enumeration_timeout: 1000
2023-06-12 17:57:41,732 INFO:	curr_iteration: 0
2023-06-12 17:57:41,732 INFO:	init_frontiers_every_iteration: False
2023-06-12 17:57:41,732 INFO:	random_generator: Generator(PCG64)
2023-06-12 17:57:41,732 INFO:	dsl_description_prefix: This is a domain-specific language for regular expressions that specify string transformations.
2023-06-12 17:57:41,732 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-12 17:57:41,732 INFO:	resume_checkpoint_directory: None
2023-06-12 17:57:41,732 INFO:	recognition_train_steps: None
2023-06-12 17:57:41,732 INFO:	init_grammar_from_checkpoint: False
2023-06-12 17:57:41,732 INFO:	experiment_name: runs_human
2023-06-12 17:57:41,732 INFO:	timestamp: 
2023-06-12 17:57:41,732 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96
2023-06-12 17:57:41,732 INFO:	ocaml_special_handler: re2
2023-06-12 17:57:41,733 INFO:	encoder: re2
2023-06-12 17:57:41,733 INFO:	init_frontiers_from_checkpoint: False
2023-06-12 17:57:41,733 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96
2023-06-12 17:57:41,733 INFO:	random_seed: 333
2023-06-12 17:57:41,733 INFO:	export_with_timestamp: False
2023-06-12 17:57:41,733 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-12 17:57:41,733 INFO:	task_language_loader: re2_human
2023-06-12 17:57:41,733 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-12 17:57:41,733 INFO:	global_batch_size: 96
2023-06-12 17:57:41,733 INFO:====================================
2023-06-12 17:57:41,733 INFO:============LOGGING FRONTIERS============
2023-06-12 17:57:41,735 INFO:	 total_solved_tasks_train @ iteration 2: 37 / 491
2023-06-12 17:57:41,738 INFO:	 total_solved_tasks_test @ iteration 2: 93 / 500
2023-06-12 17:57:41,738 INFO:====================================
2023-06-12 17:57:41,738 INFO:============LOGGING MODEL_FN============
2023-06-12 17:57:41,738 INFO:	iteration: 2
2023-06-12 17:57:41,738 INFO:	experiment_block_type: model_fn
2023-06-12 17:57:41,738 INFO:	params: {'recognition_train_steps': 10000}
2023-06-12 17:57:41,738 INFO:	task_split: train
2023-06-12 17:57:41,738 INFO:	task_batch_size: all
2023-06-12 17:57:41,738 INFO:	model_fn: optimize_model_for_frontiers
2023-06-12 17:57:41,738 INFO:	model_type: amortized_synthesis
2023-06-12 17:57:41,738 INFO:task_ids: 491 tasks: re2_train_400_if_there_is_any_letter_vowel_add_p_before_that -- re2_train_290_if_the_word_ends_with_consonant_any_letter_replace_that_with_e_x
2023-06-12 17:57:41,738 INFO:====================================
2023-06-12 17:57:41,780 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-12 17:57:42,358 INFO:Attempted frontier likelihood normalization. Initial frontiers: 37. Now: 37
2023-06-12 17:57:42,434 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:57:44,068 INFO:We now have 480 Helmholtz entries.
2023-06-12 17:58:06,983 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:58:08,631 INFO:We now have 485 Helmholtz entries.
2023-06-12 17:58:31,586 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:58:33,125 INFO:We now have 489 Helmholtz entries.
2023-06-12 17:58:54,715 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:58:56,385 INFO:We now have 484 Helmholtz entries.
2023-06-12 17:59:19,507 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:59:21,086 INFO:We now have 487 Helmholtz entries.
2023-06-12 17:59:44,312 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 17:59:45,928 INFO:We now have 483 Helmholtz entries.
2023-06-12 18:00:07,828 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:00:09,448 INFO:We now have 491 Helmholtz entries.
2023-06-12 18:00:31,360 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:00:32,894 INFO:We now have 491 Helmholtz entries.
2023-06-12 18:00:54,670 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:00:56,261 INFO:We now have 486 Helmholtz entries.
2023-06-12 18:01:18,051 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:01:19,551 INFO:We now have 487 Helmholtz entries.
2023-06-12 18:01:41,866 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:01:43,526 INFO:We now have 492 Helmholtz entries.
2023-06-12 18:01:50,904 INFO:Wrote experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/2/metrics.json
2023-06-12 18:01:50,904 INFO:====================================
2023-06-12 18:01:50,904 INFO:iteration: 2
2023-06-12 18:01:50,904 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-12 18:01:50,904 INFO:Completed in 249.165s
2023-06-12 18:01:50,904 INFO:====================================
2023-06-12 18:01:50,904 INFO:============LOGGING MODEL_FN============
2023-06-12 18:01:50,904 INFO:	iteration: 2
2023-06-12 18:01:50,904 INFO:	experiment_block_type: model_fn
2023-06-12 18:01:50,904 INFO:	params: {'enumeration_timeout': 1000}
2023-06-12 18:01:50,904 INFO:	task_split: train
2023-06-12 18:01:50,904 INFO:	task_batch_size: global_batch_size
2023-06-12 18:01:50,905 INFO:	model_fn: infer_programs_for_tasks
2023-06-12 18:01:50,905 INFO:	model_type: amortized_synthesis
2023-06-12 18:01:50,905 INFO:task_ids: 96 tasks: re2_train_93_if_the_word_starts_with_vowel_replace_that_with_u_c -- re2_train_388_if_the_word_starts_with_consonant_replace_that_with_q_i
2023-06-12 18:01:50,905 INFO:====================================
2023-06-12 18:02:01,449 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-12 18:18:50,268 INFO:Wrote experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/2/metrics.json
2023-06-12 18:18:50,268 INFO:====================================
2023-06-12 18:18:50,268 INFO:iteration: 2
2023-06-12 18:18:50,268 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-12 18:18:50,268 INFO:Completed in 1019.363s
2023-06-12 18:18:50,268 INFO:====================================
2023-06-12 18:18:50,268 INFO:============LOGGING FRONTIERS============
2023-06-12 18:18:50,270 INFO:	 total_solved_tasks_train @ iteration 2: 62 / 491
2023-06-12 18:18:50,271 INFO:	 total_solved_tasks_test @ iteration 2: 93 / 500
2023-06-12 18:18:50,271 INFO:====================================
2023-06-12 18:18:50,349 INFO:============Checkpointing frontiers to experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/2/frontiers.json===========
2023-06-12 18:18:50,350 INFO:============LOGGING MODEL_FN============
2023-06-12 18:18:50,350 INFO:	iteration: 2
2023-06-12 18:18:50,350 INFO:	task_splits: ['train']
2023-06-12 18:18:50,350 INFO:	experiment_block_type: model_fn
2023-06-12 18:18:50,350 INFO:	params: {'max_arity': 3, 'iterations': 10, 'candidates_per_iteration': 1, 'include_samples': False, 'use_mdl_program': False, 'beta_reduce_programs': True, 'update_grammar': True, 'replace_existing_abstractions': True}
2023-06-12 18:18:50,350 INFO:	model_fn: get_compressed_grammar_mdl_prior_rank
2023-06-12 18:18:50,350 INFO:	task_batch_sizes: ['all']
2023-06-12 18:18:50,350 INFO:	model_type: library_learner
2023-06-12 18:18:50,350 INFO:task_ids train: 491 tasks: re2_train_400_if_there_is_any_letter_vowel_add_p_before_that -- re2_train_290_if_the_word_ends_with_consonant_any_letter_replace_that_with_e_x
2023-06-12 18:18:50,350 INFO:====================================
2023-06-12 18:18:53,793 INFO:Updated grammar (productions=42) with 10 new abstractions.
2023-06-12 18:18:54,103 INFO:reset_task_frontiers for split: train
2023-06-12 18:18:54,111 INFO:reset_samples for split: train
2023-06-12 18:18:54,112 INFO:============Syncing to AWS S3===========
2023-06-12 18:18:54,112 INFO:aws s3 sync experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333 s3://grandg-lilo-experiments/experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333
2023-06-12 18:18:54,800 INFO:============LOGGING METADATA============
2023-06-12 18:18:54,800 INFO:	iteration: 3
2023-06-12 18:18:54,800 INFO:	tasks_loader: re2
2023-06-12 18:18:54,800 INFO:	enumeration_timeout: 1000
2023-06-12 18:18:54,800 INFO:	curr_iteration: 0
2023-06-12 18:18:54,800 INFO:	init_frontiers_every_iteration: False
2023-06-12 18:18:54,800 INFO:	random_generator: Generator(PCG64)
2023-06-12 18:18:54,800 INFO:	dsl_description_prefix: This is a domain-specific language for regular expressions that specify string transformations.
2023-06-12 18:18:54,800 INFO:	human_readable: Autogenerated iterative experiment.
2023-06-12 18:18:54,800 INFO:	resume_checkpoint_directory: None
2023-06-12 18:18:54,800 INFO:	recognition_train_steps: None
2023-06-12 18:18:54,800 INFO:	init_grammar_from_checkpoint: False
2023-06-12 18:18:54,800 INFO:	experiment_name: runs_human
2023-06-12 18:18:54,800 INFO:	timestamp: 
2023-06-12 18:18:54,800 INFO:	export_directory: experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96
2023-06-12 18:18:54,800 INFO:	ocaml_special_handler: re2
2023-06-12 18:18:54,800 INFO:	encoder: re2
2023-06-12 18:18:54,800 INFO:	init_frontiers_from_checkpoint: False
2023-06-12 18:18:54,801 INFO:	log_directory: experiments_iterative/logs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96
2023-06-12 18:18:54,801 INFO:	random_seed: 333
2023-06-12 18:18:54,801 INFO:	export_with_timestamp: False
2023-06-12 18:18:54,801 INFO:	timestamped_experiment_id: baseline_dreamcoder_96
2023-06-12 18:18:54,801 INFO:	task_language_loader: re2_human
2023-06-12 18:18:54,801 INFO:	experiment_id: baseline_dreamcoder_96
2023-06-12 18:18:54,801 INFO:	global_batch_size: 96
2023-06-12 18:18:54,801 INFO:====================================
2023-06-12 18:18:54,801 INFO:============LOGGING FRONTIERS============
2023-06-12 18:18:54,803 INFO:	 total_solved_tasks_train @ iteration 3: 62 / 491
2023-06-12 18:18:54,805 INFO:	 total_solved_tasks_test @ iteration 3: 93 / 500
2023-06-12 18:18:54,805 INFO:====================================
2023-06-12 18:18:54,805 INFO:============LOGGING MODEL_FN============
2023-06-12 18:18:54,805 INFO:	iteration: 3
2023-06-12 18:18:54,805 INFO:	experiment_block_type: model_fn
2023-06-12 18:18:54,805 INFO:	params: {'recognition_train_steps': 10000}
2023-06-12 18:18:54,805 INFO:	task_split: train
2023-06-12 18:18:54,805 INFO:	task_batch_size: all
2023-06-12 18:18:54,805 INFO:	model_fn: optimize_model_for_frontiers
2023-06-12 18:18:54,805 INFO:	model_type: amortized_synthesis
2023-06-12 18:18:54,805 INFO:task_ids: 491 tasks: re2_train_400_if_there_is_any_letter_vowel_add_p_before_that -- re2_train_290_if_the_word_ends_with_consonant_any_letter_replace_that_with_e_x
2023-06-12 18:18:54,805 INFO:====================================
2023-06-12 18:18:54,848 INFO:No pre-enumerated helmholtzFrontiers: we will sample randomly during the training loop.
2023-06-12 18:18:55,803 INFO:Attempted frontier likelihood normalization. Initial frontiers: 62. Now: 62
2023-06-12 18:18:55,804 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:18:57,515 INFO:We now have 494 Helmholtz entries.
2023-06-12 18:19:19,879 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:19:21,477 INFO:We now have 494 Helmholtz entries.
2023-06-12 18:19:42,618 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:19:44,085 INFO:We now have 492 Helmholtz entries.
2023-06-12 18:20:06,594 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:20:08,113 INFO:We now have 493 Helmholtz entries.
2023-06-12 18:20:30,545 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:20:32,107 INFO:We now have 499 Helmholtz entries.
2023-06-12 18:20:55,980 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:20:57,561 INFO:We now have 497 Helmholtz entries.
2023-06-12 18:21:20,288 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:21:21,771 INFO:We now have 493 Helmholtz entries.
2023-06-12 18:21:44,907 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:21:46,394 INFO:We now have 495 Helmholtz entries.
2023-06-12 18:22:09,901 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:22:11,461 INFO:We now have 497 Helmholtz entries.
2023-06-12 18:22:34,040 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:22:35,498 INFO:We now have 493 Helmholtz entries.
2023-06-12 18:22:59,521 INFO:Sampling new helmholtz frontiers during training.
2023-06-12 18:23:01,028 INFO:We now have 488 Helmholtz entries.
2023-06-12 18:23:04,094 INFO:Wrote experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/3/metrics.json
2023-06-12 18:23:04,094 INFO:====================================
2023-06-12 18:23:04,095 INFO:iteration: 3
2023-06-12 18:23:04,095 INFO:amortized_synthesis : optimize_model_for_frontiers
2023-06-12 18:23:04,095 INFO:Completed in 249.289s
2023-06-12 18:23:04,095 INFO:====================================
2023-06-12 18:23:04,095 INFO:============LOGGING MODEL_FN============
2023-06-12 18:23:04,095 INFO:	iteration: 3
2023-06-12 18:23:04,095 INFO:	experiment_block_type: model_fn
2023-06-12 18:23:04,095 INFO:	params: {'enumeration_timeout': 1000}
2023-06-12 18:23:04,095 INFO:	task_split: train
2023-06-12 18:23:04,095 INFO:	task_batch_size: global_batch_size
2023-06-12 18:23:04,095 INFO:	model_fn: infer_programs_for_tasks
2023-06-12 18:23:04,095 INFO:	model_type: amortized_synthesis
2023-06-12 18:23:04,095 INFO:task_ids: 96 tasks: re2_train_489_if_there_is_any_letter_consonant_replace_that_with_b -- re2_train_107_if_there_is_any_letter_consonant_add_n_after_that
2023-06-12 18:23:04,095 INFO:====================================
2023-06-12 18:23:16,533 INFO:Beginning enumeration on a total of 96 tasks with a total of 96 CPUs.
2023-06-12 18:40:05,245 INFO:Wrote experiments_iterative/outputs/runs_human/domains/re2_human/baseline_dreamcoder/seed_333/baseline_dreamcoder_96/3/metrics.json
2023-06-12 18:40:05,245 INFO:====================================
2023-06-12 18:40:05,245 INFO:iteration: 3
2023-06-12 18:40:05,245 INFO:amortized_synthesis : infer_programs_for_tasks
2023-06-12 18:40:05,245 INFO:Completed in 1021.149s
2023-06-12 18:40:05,245 INFO:====================================
2023-06-12 18:40:05,245 INFO:============LOGGING FRONTIERS============
2023-06-12 18:40:05,247 INFO:	 total_solved_tasks_train @ iteration 3: 80 / 491
2023-06-12 18:40:05,249 INFO:	 total_solved_tasks_test @ iteration 3: 93 / 500
2023-06-12 18:40:05,249 INFO:====================================
2023-06-12 18:40:05,258 INFO:reset_task_frontiers for split: test
2023-06-12 18:40:05,258 INFO:============LOGGING MODEL_FN============
2023-06-12 18:40:05,258 INFO:	iteration: 3
2023-06-12 18:40:05,258 INFO:	experiment_block_type: model_fn
2023-06-12 18:40:05,258 INFO:	params: {'enumeration_timeout': 1000}
2023-06-12 18:40:05,258 INFO:	task_split: test
2023-06-12 18:40:05,258 INFO:	task_batch_size: all
2023-06-12 18:40:05,258 INFO:	model_fn: infer_programs_for_tasks
2023-06-12 18:40:05,258 INFO:	run_every_n_iterations: 3
2023-06-12 18:40:05,258 INFO:	model_type: amortized_synthesis
2023-06-12 18:40:05,258 INFO:task_ids: 500 tasks: re2_test_0_if_the_word_ends_with_s_replace_that_with_m -- re2_test_499_if_there_is_consonant_replace_that_with_q_f
2023-06-12 18:40:05,258 INFO:====================================
2023-06-12 18:41:10,002 INFO:Beginning enumeration on a total of 500 tasks with a total of 96 CPUs.
